Time.Tracking = {
	// keep track of simple reach
	last_article_id: 0,

	// destroy any props we would have set in a page view
	reset: function() {

		var props = [3, 5, 8, 7, 16, 26, 28, 30, 26, 14, 27, 10, 15, 65, 33, 34, 67];

		// remove any props that may have been set
		for( var i in props ) {
			delete s_time['prop'+props[i]];
		}

		delete s_time['setFreeTeaserPV'];
		delete s_time['setPaidFullPV'];

	},

	article_view: function( data ) {

		// cant do anything without data
		if( !this.isset( data ) )
			return;

		// use the omniture prop8 (article id) to see if we already fired a view for this
		if( this.isset( s_time.prop8 ) && s_time.prop8 == data.id ) {
			//this.log( 'Fail, we already called a pv for this article' );
			return;
		}

		this.omniture( data );
		this.simple_reach( data );
		this.comscore();
	},

	gallery_view: function( data ) {

		if( !this.isset( data ) )
			return;

		// reference the article were in
		article = Time.application.active_rail.active_article.attributes

		// prop7, "gallery" or "embedded gallery"
		s_time.prop7 = ( data.primary ) ? 'gallery' : 'embedded gallery';

		// basic pageName
		s_time.pageName = s_time.prop7 + '|' + data.gallery_title;

		// prepend section if available
		if( this.isset( article.section ) )
			s_time.pageName = this.map_section( article.section.name ) + '|' + s_time.pageName;

		// lowercase pageName
		s_time.pageName = s_time.pageName.toLowerCase();

		// prop15, "normal" or "fullscreen"
		s_time.prop15 = ( data.fullscreen ) ? 'fullscreen' : 'normal';

		s_time.t();

		this.comscore();
	},

	simple_reach: function( article ) {

		// dont call the same article 2x
		if(this.last_article_id == article.id) {
			return;
		}
			
		var authors = [];

		if( this.isset( article.authors ) ) {
			for( var i = 0, ln = article.authors.length; i < ln; i++ ) {
				authors[i] = article.authors[i].name;
			}
		}

        __ajax_reach_config = {
          pid: '4e87f81ca782f3404200000a',
          title: article.title,
          url: article.url,
          date: article.time.published.substring(0, 10),
          authors: authors,
          channels: this.isset( article.section ) ? [article.section.name] : [],
          tags: this.isset( article.tags ) ? article.tags : [],
          iframe: true,
          ignore_errors: Time.developer_mode,
    	};

        try {
          SPR.Reach.collect( __ajax_reach_config );
        } catch(e) {}

        // keep track of the article that we fired a call
        this.last_article_id = article.id

	},

	comscore: function() {

		try {
			COMSCORE.beacon({ c1: "2", c2:"6035728"});
		} catch(e) {}

		// do comscore pv candidate
		jQuery.get(
			Time.home_url + "/wp-content/themes/vip/time2014/pageview_candidate.xml",
			{
				comscorekw: "pageview_candidate",
				rand: Math.floor(Math.random()*1000000),
			}
		);
	},

	// send off a page view based on the current template
	omniture: function( article ) {

		var authors = [], $edit_divider, $edit_divider_link, divider_event = '';

		// reset our props
		this.reset();

		// channel
		s_time.channel = 'time';

		// version 2
		s_time.prop64 = 'v2';

		// prop8, ID
		s_time.prop8 = article.id;

		// pageName
		s_time.pageName = article.title;

		// prop7, Content Type
		if( article.post_type == 'post' ) {
			s_time.prop7 = article.format;
		} else if( article.post_type == 'page' ) {
			s_time.prop7 = 'page';
		}

		if( this.isset( article.format ) ) {
			s_time.pageName = article.format + '|' + s_time.pageName;
		}

		// prop14, URL
		s_time.prop14 = article.url;

		// prop26, Date yyyy-mm-dd
		if( this.isset( article.time ) ) {
			s_time.prop26 = article.time.published.substring(0, 10); // chop off the h:m:s
		}

		// prop30, Title
		s_time.prop30 = article.title;

		// prop16, Section
		if( this.isset( article.section ) ) {
			s_time.prop16 = this.map_section( article.section.name );
			s_time.pageName = article.section.name + '|' + s_time.pageName;
		}

		// prop5, Tag
		if( this.isset( article.tag ) ) {
			s_time.prop5 = article.tag.name;
		}

		// prop28, Byline
		if( this.isset( article.authors ) ) {

			for( var i = 0, ln = article.authors.length; i < ln; i++ ) {
				authors[i] = article.authors[i].name;
			}

			s_time.prop28 = authors.join('|');
		}

		// prop10, Sponsor Name
		if( article.post_type == 'time_sponsored_post' && this.isset( article.sponsor ) ) {
			s_time.prop10 = article.sponsor.name;
			s_time.prop7 = 'native ad';
			s_time.prop16 = 'sponsored';
			s_time.pageName = 'sponsored|native ad|' + article.title;
		}

		// prop27, Paywall
		if( article.paid ) {
			s_time.prop27 = Time.authenticated ? 'paid full' : 'teaser';
		}

		// prop65, Article Divider and RR List vars
		if( this.isset( article.omniture ) ) {
			s_time.prop65 = article.omniture.modules;
		}

		// get the data-event from the next edit divider (if there is one)
		$edit_divider_link = jQuery('#article-' + article.id).next('.divider-articles').find('a[data-event]:first');

		if( $edit_divider_link.length ) {

			divider_event = $edit_divider_link.data('event');

			if( divider_event != "" ) {

				if( this.isset( s_time.prop65 ) ) {	
					s_time.prop65 += '|' + divider_event
				} else {
					s_time.prop65 = divider_event
				}
			}
		}

		// prop67, tags
		if( this.isset( article.tags ) )
			s_time.prop67 = article.tags;

		// Magazine values
		if( article.magazine_article ) {

			s_time.prop3 = 'magazine';

			if( article.paid ) {

				s_time.prop34 = 'walled magazine';

				if( Time.authenticated ) {
					s_time.setPaidFullPV = "true";

				} else {
					s_time.setFreeTeaserPV = "true";
					s_time.prop33 = s_time.prop26 + '|' + s_time.prop30;
				}
			}
		}

		// make pageName lowercase
		if( this.isset( s_time.pageName ) ){
			s_time.pageName = s_time.pageName.toLowerCase();
		}

		// fire pv
		s_time.t();

		//this.log( 'Omniture Pageview for Article: ' + s_time.pageName );
	},

	isset: function( thing ) {
		return ( typeof thing != "undefined" && thing != "" );
	},

	log: function( msg ) {
		if( Time.developer_mode )
			console.log( '%c' + msg, 'color:#248bd2;background:#042029;font-size:16px;' );
	},

	map_section: function( section ) {

		section = section.toLowerCase();

		switch( section ) {
			case 'u.s.' :
				return 'us';
			case 'trending' :
				return 'newsfeed';
			case 'business' :
				return 'biztech';
			case 'tech' :
				return 'techland';
			case 'health' :
				return 'healthland';
			case 'science' :
				return 'scihealth';
			case 'culture' :
				return 'arts';
			case 'opinion' :
				return 'opinions';
			default :
				return section;
		}
	}
};

// event tracking
jQuery(document).ready(function($){

	// Bind to all omniture tracked elements
	$('body').on('click', '[data-event]', function(e) {

		var srcEl = $(e.srcElement);

		if( typeof omniTrackEv != "undefined" && !srcEl.is("[data-event-info]")) {

			omniTrackEv($(this).attr('data-event'));
		}
	});
});;
function render_taboola_modules(){if(!taboola_loaded)return taboola_render_on_load=!0,void 0;var a,b,c,d,e,f,g=jQuery,h=g(".full-article.active"),i=h.attr("id");h.length&&i!==last_taboola_article_id&&(e=h.find(".taboola"),c=h.next(".divider-taboola").find(".taboola"),b=h.prev(".divider-taboola").find(".taboola"),a=c.length?c:b,last_taboola_article_id&&(d=g("#"+last_taboola_article_id),d.find(".taboola").each(function(){g(this).html("").attr("class","taboola")}),a.length&&$last_taboola_divider&&$last_taboola_divider.html("").attr("class","taboola"),f=e.length?!0:!1,_taboola.push({notify:"newPageLoad"}),_taboola.push({article:i,url:Time.application.active_rail.active_article.attributes.url,visible:f})),e.each(function(){var a=g(this);_taboola.push({mode:a.data("mode"),container:a.attr("id"),placement:a.data("placement"),target_type:a.data("type")})}),a.length&&(_taboola.push({mode:"thumbs-1r",container:a.attr("id"),placement:"mid-page"}),$last_taboola_divider=a),last_taboola_article_id=i)}!function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?(this._wrapped=a,void 0):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.1";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(null==b?x.identity:b);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e=null;return function(){var f=this,g=arguments,h=function(){e=null,c||(d=a.apply(f,g))},i=c&&!e;return clearTimeout(e),e=setTimeout(h,b),i&&(d=a.apply(f,g)),d}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n"," ":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var a=this,b=a.Backbone,c=[];c.push;var d=c.slice;c.splice;var e;e="undefined"!=typeof exports?exports:a.Backbone={},e.VERSION="1.1.0";var f=a._;f||"undefined"==typeof require||(f=require("underscore")),e.$=a.jQuery||a.Zepto||a.ender||a.$,e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1;var g=e.Events={on:function(a,b,c){if(!i(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!i(this,"once",a,[b,c])||!b)return this;var d=this,e=f.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,g,h,j,k,l,m;if(!this._events||!i(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:f.keys(this._events),j=0,k=h.length;k>j;j++)if(a=h[j],g=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=g.length;m>l;l++)e=g[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=d.call(arguments,1);if(!i(this,"trigger",a,b))return this;var c=this._events[a],e=this._events.all;return c&&j(c,b),e&&j(e,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var g in d)a=d[g],a.off(b,c,this),(e||f.isEmpty(a._events))&&delete this._listeningTo[g];return this}},h=/\s+/,i=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(h.test(c)){for(var f=c.split(h),g=0,i=f.length;i>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},j=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},k={listenTo:"on",listenToOnce:"once"};f.each(k,function(a,b){g[b]=function(b,c,d){var e=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=f.uniqueId("l"));return e[g]=b,d||"object"!=typeof c||(d=this),b[a](c,d,this),this}}),g.bind=g.on,g.unbind=g.off,f.extend(e,g);var l=e.Model=function(a,b){var c=a||{};b||(b={}),this.cid=f.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(c=this.parse(c,b)||{}),c=f.defaults({},c,f.result(this,"defaults")),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)};f.extend(l.prototype,g,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return f.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;g=c.unset,i=c.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=f.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],f.isEqual(l[d],b)||h.push(d),f.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete l[d]:l[d]=b;if(!i){h.length&&(this._pending=!0);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,f.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,f.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)f.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),b.trigger("sync",b,d,a),void 0):!1},K(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,g,h=this.attributes;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,c=f.extend({validate:!0},c),d&&!c.wait){if(!this.set(d,c))return!1}else if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=f.extend({},h,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=h;var b=i.parse(a,c);return c.wait&&(b=f.extend(d||{},b)),f.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),i.trigger("sync",i,a,c),void 0)},K(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),g=this.sync(e,this,c),d&&c.wait&&(this.attributes=h),g},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;K(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=f.result(this,"urlRoot")||f.result(this.collection,"url")||J();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},f.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,f.extend(b,{validationError:c})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];f.each(m,function(a){l.prototype[a]=function(){var b=d.call(arguments);return b.unshift(this.attributes),f[a].apply(f,b)}});var n=e.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,f.extend({silent:!0},b))},o={add:!0,remove:!0,merge:!0},p={add:!0,remove:!1};f.extend(n.prototype,g,{model:l,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return e.sync.apply(this,arguments)},add:function(a,b){return this.set(a,f.extend({merge:!1},b,p))},remove:function(a,b){var c=!f.isArray(a);a=c?[a]:f.clone(a),b||(b={});var d,e,g,h;for(d=0,e=a.length;e>d;d++)h=a[d]=this.get(a[d]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h));return c?a[0]:a},set:function(a,b){b=f.defaults({},b,o),b.parse&&(a=this.parse(a,b));var c=!f.isArray(a);a=c?a?[a]:[]:f.clone(a);var d,e,g,h,i,j,k,m=b.at,n=this.model,p=this.comparator&&null==m&&b.sort!==!1,q=f.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!p&&u&&w?[]:!1;for(d=0,e=a.length;e>d;d++){if(i=a[d],g=i instanceof l?h=i:i[n.prototype.idAttribute],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),p&&!k&&j.hasChanged(q)&&(k=!0)),a[d]=j;else if(u){if(h=a[d]=this._prepareModel(i,b),!h)continue;r.push(h),h.on("all",this._onModelEvent,this),this._byId[h.cid]=h,null!=h.id&&(this._byId[h.id]=h)}x&&x.push(j||h)}if(w){for(d=0,e=this.length;e>d;++d)t[(h=this.models[d]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(p&&(k=!0),this.length+=r.length,null!=m)for(d=0,e=r.length;e>d;d++)this.models.splice(m+d,0,r[d]);else{x&&(this.models.length=0);var y=x||r;for(d=0,e=y.length;e>d;d++)this.models.push(y[d])}if(k&&this.sort({silent:!0}),!b.silent){for(d=0,e=r.length;e>d;d++)(h=r[d]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),a=this.add(a,f.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,f.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,f.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return d.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a.id]||this._byId[a.cid]||this._byId[a]},at:function(a){return this.models[a]},where:function(a,b){return f.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),f.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(f.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return f.invoke(this.models,"get",a)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},K(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?f.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof l)return a.collection||(a.collection=this),a;b=b?f.clone(b):{},b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var q=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];f.each(q,function(a){n.prototype[a]=function(){var b=d.call(arguments);return b.unshift(this.models),f[a].apply(f,b)}});var r=["groupBy","countBy","sortBy"];f.each(r,function(a){n.prototype[a]=function(b,c){var d=f.isFunction(b)?b:function(a){return a.get(b)};return f[a](this.models,d,c)}});var s=e.View=function(a){this.cid=f.uniqueId("view"),a||(a={}),f.extend(this,f.pick(a,u)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},t=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName","events"];f.extend(s.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof e.$?a:e.$(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=f.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(f.isFunction(c)||(c=this[a[b]]),c){var d=b.match(t),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,""===g?this.$el.on(e,c):this.$el.on(e,g,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"),!1);else{var a=f.extend({},f.result(this,"attributes"));this.id&&(a.id=f.result(this,"id")),this.className&&(a["class"]=f.result(this,"className"));var b=e.$("<"+f.result(this,"tagName")+">").attr(a);this.setElement(b,!1)}}}),e.sync=function(a,b,c){var d=w[a];f.defaults(c||(c={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var g={type:d,dataType:"json"};if(c.url||(g.url=f.result(b,"url")||J()),null!=c.data||!b||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(c.attrs||b.toJSON(c))),c.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),c.emulateHTTP&&("PUT"===d||"DELETE"===d||"PATCH"===d)){g.type="POST",c.emulateJSON&&(g.data._method=d);var h=c.beforeSend;c.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",d),h?h.apply(this,arguments):void 0}}"GET"===g.type||c.emulateJSON||(g.processData=!1),"PATCH"===g.type&&v&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=c.xhr=e.ajax(f.extend(g,c));return b.trigger("request",b,i,c),i};var v=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var x=e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,z=/(\(\?)?:\w+/g,A=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(x.prototype,g,{initialize:function(){},route:function(a,b,c){f.isRegExp(a)||(a=this._routeToRegExp(a)),f.isFunction(b)&&(c=b,b=""),c||(c=this[b]);var d=this;return e.history.route(a,function(f){var g=d._extractParameters(a,f);c&&c.apply(d,g),d.trigger.apply(d,["route:"+b].concat(g)),d.trigger("route",b,g),e.history.trigger("route",d,b,g)}),this},navigate:function(a,b){return e.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=f.result(this,"routes");for(var a,b=f.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(B,"\\$&").replace(y,"(?:$1)?").replace(z,function(a,b){return b?a:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return f.map(c,function(a){return a?decodeURIComponent(a):null})}});var C=e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,F=/msie [\w.]+/,G=/\/$/,H=/[?#].*$/;C.started=!1,f.extend(C.prototype,g,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(G,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(D,"")},start:function(a){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=f.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var b=this.getFragment(),c=document.documentMode,d=F.exec(navigator.userAgent.toLowerCase())&&(!c||7>=c);this.root=("/"+this.root+"/").replace(E,"/"),d&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b;var g=this.location,h=g.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&h&&g.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+g.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),C.started=!1
},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),this.loadUrl(),void 0)},loadUrl:function(a){return a=this.fragment=this.getFragment(a),f.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!C.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(H,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),e.history=new C;var I=function(a,b){var c,d=this;c=a&&f.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},f.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&f.extend(c.prototype,a),c.__super__=d.prototype,c};l.extend=n.extend=x.extend=s.extend=C.extend=I;var J=function(){throw new Error('A "url" property or function must be specified')},K=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this),function(a,b){if("object"==typeof exports&&exports)b(exports);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.Mustache=c}}(this,function(a){function b(a,b){return t.call(a,b)}function c(a){return!b(p,a)}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a){return String(a).replace(/[&<>"'\/]/g,function(a){return w[a]})}function f(a){this.string=a,this.tail=a,this.pos=0}function g(a,b){this.view=a||{},this.parent=b,this._cache={}}function h(){this.clearCache()}function i(b,c,d,e){for(var f,g,h,j="",k=0,l=b.length;l>k;++k)switch(f=b[k],g=f[1],f[0]){case"#":if(h=d.lookup(g),"object"==typeof h)if(v(h))for(var m=0,n=h.length;n>m;++m)j+=i(f[4],c,d.push(h[m]),e);else h&&(j+=i(f[4],c,d.push(h),e));else if("function"==typeof h){var o=null==e?null:e.slice(f[3],f[5]);h=h.call(d.view,o,function(a){return c.render(a,d)}),null!=h&&(j+=h)}else h&&(j+=i(f[4],c,d,e));break;case"^":h=d.lookup(g),(!h||v(h)&&0===h.length)&&(j+=i(f[4],c,d,e));break;case">":h=c.getPartial(g),"function"==typeof h&&(j+=h(d));break;case"&":h=d.lookup(g),null!=h&&(j+=h);break;case"name":h=d.lookup(g),null!=h&&(j+=a.escape(h));break;case"text":j+=g}return j}function j(a){for(var b,c=[],d=c,e=[],f=0,g=a.length;g>f;++f)switch(b=a[f],b[0]){case"#":case"^":e.push(b),d.push(b),d=b[4]=[];break;case"/":var h=e.pop();h[5]=b[2],d=e.length>0?e[e.length-1][4]:c;break;default:d.push(b)}return c}function k(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(c=b,d.push(b)));return d}function l(a){return[new RegExp(d(a[0])+"\\s*"),new RegExp("\\s*"+d(a[1]))]}function m(b,e){function g(){if(z&&!A)for(;y.length;)delete x[y.pop()];else y=[];z=!1,A=!1}if(b=b||"",e=e||a.tags,"string"==typeof e&&(e=e.split(o)),2!==e.length)throw new Error("Invalid tags: "+e.join(", "));for(var h,i,m,p,t,u=l(e),v=new f(b),w=[],x=[],y=[],z=!1,A=!1;!v.eos();){if(h=v.pos,m=v.scanUntil(u[0]))for(var B=0,C=m.length;C>B;++B)p=m.charAt(B),c(p)?y.push(x.length):A=!0,x.push(["text",p,h,h+1]),h+=1,"\n"==p&&g();if(!v.scan(u[0]))break;if(z=!0,i=v.scan(s)||"name",v.scan(n),"="===i?(m=v.scanUntil(q),v.scan(q),v.scanUntil(u[1])):"{"===i?(m=v.scanUntil(new RegExp("\\s*"+d("}"+e[1]))),v.scan(r),v.scanUntil(u[1]),i="&"):m=v.scanUntil(u[1]),!v.scan(u[1]))throw new Error("Unclosed tag at "+v.pos);if(t=[i,m,h,v.pos],x.push(t),"#"===i||"^"===i)w.push(t);else if("/"===i){if(0===w.length)throw new Error('Unopened section "'+m+'" at '+h);var D=w.pop();if(D[1]!==m)throw new Error('Unclosed section "'+D[1]+'" at '+h)}else if("name"===i||"{"===i||"&"===i)A=!0;else if("="===i){if(e=m.split(o),2!==e.length)throw new Error("Invalid tags at "+h+": "+e.join(", "));u=l(e)}}var D=w.pop();if(D)throw new Error('Unclosed section "'+D[1]+'" at '+v.pos);return x=k(x),j(x)}var n=/\s*/,o=/\s+/,p=/\S/,q=/\s*=/,r=/\s*\}/,s=/#|\^|\/|>|\{|&|=|!/,t=RegExp.prototype.test,u=Object.prototype.toString,v=Array.isArray||function(a){return"[object Array]"===u.call(a)},w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(a){var b=this.tail.match(a);return b&&0===b.index?(this.tail=this.tail.substring(b[0].length),this.pos+=b[0].length,b[0]):""},f.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c),this.pos+=c}return b},g.make=function(a){return a instanceof g?a:new g(a)},g.prototype.push=function(a){return new g(a,this)},g.prototype.lookup=function(a){var b=this._cache[a];if(!b){if("."==a)b=this.view;else for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var d=a.split("."),e=0;b&&e<d.length;)b=b[d[e++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this._cache[a]=b}return"function"==typeof b&&(b=b.call(this.view)),b},h.prototype.clearCache=function(){this._cache={},this._partialCache={}},h.prototype.compile=function(b,c){var d=this._cache[b];if(!d){var e=a.parse(b,c);d=this._cache[b]=this.compileTokens(e,b)}return d},h.prototype.compilePartial=function(a,b,c){var d=this.compile(b,c);return this._partialCache[a]=d,d},h.prototype.getPartial=function(a){return a in this._partialCache||!this._loadPartial||this.compilePartial(a,this._loadPartial(a)),this._partialCache[a]},h.prototype.compileTokens=function(a,b){var c=this;return function(d,e){if(e)if("function"==typeof e)c._loadPartial=e;else for(var f in e)c.compilePartial(f,e[f]);return i(a,c,g.make(d),b)}},h.prototype.render=function(a,b,c){return this.compile(a)(b,c)},a.name="mustache.js",a.version="0.7.2",a.tags=["{{","}}"],a.Scanner=f,a.Context=g,a.Writer=h,a.parse=m,a.escape=e;var x=new h;a.clearCache=function(){return x.clearCache()},a.compile=function(a,b){return x.compile(a,b)},a.compilePartial=function(a,b,c){return x.compilePartial(a,b,c)},a.compileTokens=function(a,b){return x.compileTokens(a,b)},a.render=function(a,b,c){return x.render(a,b,c)},a.to_html=function(b,c,d,e){var f=a.render(b,c,d);return"function"!=typeof e?f:(e(f),void 0)}}),function(a,b){"use strict";var c="srcset"in document.createElement("img"),d=function(){this.width=a.innerWidth||b.documentElement.clientWidth,this.height=a.innerHeight||b.documentElement.clientHeight,this.pixelRatio=a.devicePixelRatio||1},e=function(a){this.viewport=a,this.maxWidth=1/0,this.maxHeight=1/0,this.maxPixelRatio=1,this.candidates=[]};e.prototype={constructor:e,parseImage:function(a){var b=/[^\s]+/,c=/\s(\d+)h/,d=/\s(\d+)w/,e=/\s(\d+((\.\d+)?))x/,f=a.getAttribute("srcset"),g=this.candidates;if(f){var h,i=f.split(","),j=i.length;for(h=0;j>h;h+=1){var k=i[h].match(b)[0],l=c.test(i[h])?parseInt(i[h].match(c)[1],10):1/0,m=d.test(i[h])?parseInt(i[h].match(d)[1],10):1/0,n=e.test(i[h])?parseFloat(i[h].match(e)[1]):1;g.push({src:k,height:l,width:m,pixelRatio:n})}}return this},getBestCandidate:function(a){var b=this.candidates,c=a.width,d=a.height,e=a.pixelRatio,f=function(a){var c,d=b.length,e=b[0];for(c=0;d>c;c+=1)a(b[c],e)&&(e=b[c]);return e},g=function(a){var c,d=b.length;for(c=d-1;c>=0;c-=1)a(b[c])&&b.splice(c,1)};if(0===b.length)return null;var h=f(function(a,b){return a.width>b.width});g(function(a){return a.width<c}),0===b.length&&(b=[h]);var i=f(function(a,b){return a.height>b.height});g(function(a){return a.height<d}),0===b.length&&(b=[i]);var j=f(function(a,b){return a.pixelRatio>b.pixelRatio});g(function(a){return a.pixelRatio<e}),0===b.length&&(b=[j]);var k=f(function(a,b){return a.width<b.width});g(function(a){return a.width>k.width});var l=f(function(a,b){return a.height<b.height});g(function(a){return a.height>l.height});var m=f(function(a,b){return a.pixelRatio<b.pixelRatio});return g(function(a){return a.pixelRatio>m.pixelRatio}),b[0]}};var f,g=function(){if(!c){var a,b=new d,f=document.querySelectorAll("img"),g=f.length;for(a=0;g>a;a+=1){var h=new e,i=f[a],j=h.parseImage(i).getBestCandidate(b);j&&(i.src=j.src)}}},h=function(b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&"DOMContentLoaded"!==b&&a.attachEvent("on"+b,c)};h("DOMContentLoaded",function(){g(),a.removeEventListener("load",g,!1)}),h("load",g),h("resize",function(){f&&a.clearTimeout(f),f=a.setTimeout(g,50)}),a.srcset=g}(window,document),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b){return a.isFunction(b)||"object"==typeof b?b:{top:b,left:b}}var c=a.scrollTo=function(b,c,d){return a(window).scrollTo(b,c,d)};return c.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:!0},c.window=function(){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!=a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return/webkit/i.test(navigator.userAgent)||"BackCompat"==d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"==d&&(d=9e9),f=a.extend({},c.defaults,f),e=e||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=b(f.offset),f.over=b(f.over),this._scrollable().each(function(){function g(a){j.animate(l,e,f.easing,a&&function(){a.call(this,k,f)})}if(null!=d){var h,i=this,j=a(i),k=d,l={},m=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(k)){k=b(k);break}if(k=a(k,this),!k.length)return;case"object":(k.is||k.style)&&(h=(k=a(k)).offset())}var n=a.isFunction(f.offset)&&f.offset(i,k)||f.offset;a.each(f.axis.split(""),function(a,b){var d="x"==b?"Left":"Top",e=d.toLowerCase(),o="scroll"+d,p=i[o],q=c.max(i,b);if(h)l[o]=h[e]+(m?0:p-j.offset()[e]),f.margin&&(l[o]-=parseInt(k.css("margin"+d))||0,l[o]-=parseInt(k.css("border"+d+"Width"))||0),l[o]+=n[e]||0,f.over[e]&&(l[o]+=k["x"==b?"width":"height"]()*f.over[e]);else{var r=k[e];l[o]=r.slice&&"%"==r.slice(-1)?parseFloat(r)/100*q:r}f.limit&&/^\d+$/.test(l[o])&&(l[o]=l[o]<=0?0:Math.min(l[o],q)),!a&&f.queue&&(p!=l[o]&&g(f.onAfterFirst),delete l[o])}),g(f.onAfter)}}).end()},c.max=function(b,c){var d="x"==c?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])},c}),function(a){a.fn.touchwipe=function(b){var c={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};return b&&a.extend(c,b),this.each(function(){function a(){this.removeEventListener("touchmove",b),e=null,g=!1}function b(b){if(c.preventDefaultEvents&&b.preventDefault(),g){var d=b.touches[0].pageX,h=b.touches[0].pageY,i=e-d,j=f-h;Math.abs(i)>=c.min_move_x?(a(),i>0?c.wipeLeft(b):c.wipeRight(b)):Math.abs(j)>=c.min_move_y&&(a(),j>0?c.wipeDown():c.wipeUp())}}function d(a){1==a.touches.length&&(e=a.touches[0].pageX,f=a.touches[0].pageY,g=!0,this.addEventListener("touchmove",b,!1))}var e,f,g=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",d,!1)}),this}}(jQuery),function(a){for(var b,c=["Width","Height"];b=c.pop();)!function(b,c){a.fn[b]=b in new Image?function(){return this[0][b]}:function(){var a,b,d=this[0];return"img"===d.tagName.toLowerCase()&&(a=new Image,a.src=d.src,b=a[c]),b}}("natural"+b,b.toLowerCase())}(jQuery),function(){window.console||(window.console={});for(var a=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],b=0;b<a.length;b++)window.console[a[b]]||(window.console[a[b]]=function(){})}(),function(a){window.FinalFire=function(b){this.config=a.extend({},!0,{subEventArray:[],finalEvent:"complete",reset:!1},b),this.wasTriggered={},this.subEventArrayLen=this.config.subEventArray.length,this.setAllTriggered(!1,!0)},FinalFire.prototype={bind:function(b){var c=this;a(this).on(b,function(a){c.wasTriggered[a.type]=!0,c.wasAllTriggered(c)&&c.emit(c)})},setAllTriggered:function(a,b){for(var c="",d=0;d<this.subEventArrayLen;d++)this.wasTriggered[this.config.subEventArray[d]]=a,b&&(c+=this.config.subEventArray[d]+" ");b&&this.bind(c)},wasAllTriggered:function(a){for(var b=0;b<a.subEventArrayLen;b++){if(!a.wasTriggered[a.config.subEventArray[b]])return!1;if(b===a.subEventArrayLen-1)return!0}},emit:function(b){a(b).trigger(b.config.finalEvent),b.config.reset?b.setAllTriggered(!1):a(b).off(b.config.finalEvent)}}}(jQuery),function(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=0,g=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),g=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(g=0,f=-1*e),void 0!==c.wheelDeltaY&&(g=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(f=-1*c.wheelDeltaX/120),d.unshift(b,e,f,g),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),function(a,b,c){function d(a){return a}function e(a){return f(decodeURIComponent(a.replace(h," ")))}function f(a){return 0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),a}function g(a){return i.json?JSON.parse(a):a}var h=/\+/g,i=a.cookie=function(f,h,j){if(h!==c){if(j=a.extend({},i.defaults,j),null===h&&(j.expires=-1),"number"==typeof j.expires){var k=j.expires,l=j.expires=new Date;l.setDate(l.getDate()+k)}return h=i.json?JSON.stringify(h):String(h),b.cookie=[encodeURIComponent(f),"=",i.raw?h:encodeURIComponent(h),j.expires?"; expires="+j.expires.toUTCString():"",j.path?"; path="+j.path:"",j.domain?"; domain="+j.domain:"",j.secure?"; secure":""].join("")}for(var m=i.raw?d:e,n=b.cookie.split("; "),o=f?null:{},p=0,q=n.length;q>p;p++){var r=n[p].split("="),s=m(r.shift()),t=m(r.join("="));if(f&&f===s){o=g(t);break}f||(o[s]=g(t))}return o};i.defaults={},a.removeCookie=function(b,c){return null!==a.cookie(b)?(a.cookie(b,null,c),!0):!1}}(jQuery,document),function(a){function b(a,b){""===a.val()?a.data("placeholder").removeClass(b.hideClass):a.data("placeholder").addClass(b.hideClass)}function c(a,b){a.data("placeholder").addClass(b.hideClass)}function d(a,b){var c=b.is("textarea"),d=parseFloat(b.css("padding-top")),e=parseFloat(b.css("padding-left")),f=b.offset();d&&(f.top+=d),e&&(f.left+=e),a.css({width:b.innerWidth()-(c?20:4),height:b.innerHeight()-6,lineHeight:b.css("line-height"),whiteSpace:c?"normal":"nowrap",overflow:"hidden"}).offset(f)}function e(a,b){var d=a.val();!function e(){i=requestAnimationFrame(e),a.val()!==d&&(c(a,b),g(),f(a,b))}()}function f(a,c){!function d(){i=requestAnimationFrame(d),b(a,c)}()}function g(){cancelAnimationFrame(i)}function h(a){j&&window.console&&window.console.log&&window.console.log(a)}var i,j=!1;a.fn.placeHolder=function(f){h("init placeHolder");var i=this,j=a(this).length;return this.options=a.extend({className:"placeholder",visibleToScreenreaders:!0,visibleToScreenreadersHideClass:"placeholder-hide-except-screenreader",visibleToNoneHideClass:"placeholder-hide",hideOnFocus:!1,removeLabelClass:"visuallyhidden",hiddenOverrideClass:"visuallyhidden-with-placeholder",forceHiddenOverride:!0,forceApply:!1,autoInit:!0},f),this.options.hideClass=this.options.visibleToScreenreaders?this.options.visibleToScreenreadersHideClass:this.options.visibleToNoneHideClass,a(this).each(function(f){function k(){!i.options.hideOnFocus&&window.requestAnimationFrame?e(p,i.options):c(p,i.options)}var l,m,n,o,p=a(this),q=p.attr("placeholder"),r=p.attr("id");return(""===q||void 0===q)&&(q=p[0].attributes.placeholder.value),l=p.closest("label"),p.removeAttr("placeholder"),l.length||r?(l=l.length?l:a('label[for="'+r+'"]').first(),l.length?(o=a(l).find(".placeholder"),o.length?(d(o,p),o.text(q),p):(l.hasClass(i.options.removeLabelClass)&&l.removeClass(i.options.removeLabelClass).addClass(i.options.hiddenOverrideClass),m=a("<span>").addClass(i.options.className).text(q).appendTo(l),n=m.width()>p.width(),n&&m.attr("title",q),d(m,p),p.data("placeholder",m),m.data("input",p),m.click(function(){a(this).data("input").focus()}),p.focusin(k),p.focusout(function(){b(a(this),i.options),!i.options.hideOnFocus&&window.cancelAnimationFrame&&g()}),b(p,i.options),a(document).bind("fontresize resize",function(){d(m,p)}),a.event.special.resize?a("textarea").bind("resize",function(){d(m,p)}):a("textarea").css("resize","none"),f>=j-1&&"undefined"!=typeof a.attrHooks&&(a.attrHooks.placeholder={get:function(b){return"input"===b.nodeName.toLowerCase()||"textarea"===b.nodeName.toLowerCase()?a(b).data("placeholder")?a(a(b).data("placeholder")).text():a(b)[0].placeholder:void 0},set:function(b,c){return a(a(b).data("placeholder")).text(c)}}),p.is(":focus")&&k(),void 0)):(h("the input element with the placeholder needs a label!"),void 0)):(h("the input element with the placeholder needs an id!"),void 0)})},a(function(){var b=window.placeHolderConfig||{};return b.autoInit===!1?(h("placeholder:abort because autoInit is off"),void 0):("placeholder"in a("<input>")[0]||"placeHolder"in a("<input>")[0])&&!b.forceApply?(h("placeholder:abort because browser has native support"),void 0):(a("input[placeholder], textarea[placeholder]").placeHolder(b),void 0)})}(jQuery),Date.prototype.toISOString||!function(){function a(a){var b=String(a);return 1===b.length&&(b="0"+b),b}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(),function(a,b){Time.Slideshow=function(c,d,e){e=e||{},this.img_curr_index=e.img_curr_index||0,this.cycle=null!=e.cycle?e.cycle:!0,this.isAutoPlay=null!=e.isAutoPlay?e.isAutoPlay:!0,this.transition_duration=e.transition_duration||".3s",this.transition_timing=e.transition_timing||"ease-out",this.next_buttonClass=e.next_buttonClass||"next time-icons time-icons-next-outline",this.prev_buttonClass=e.prev_buttonClass||"prev time-icons time-icons-previous-outline",this.pause_play_buttonClass=e.pause_play_buttonClass||"pause_play time-icons ",this.play_class_state=e.play_class_state||"time-icons-play",this.pause_class_state=e.pause_class_state||"time-icons-pause",this.current_class=e.currentClass||"current",this.pre_render=e.pre_render||!1,this.post_render=e.post_render||!1,this.play_timer=e.play_timer||4e3,this.experience=e.experience||"desktop",this.img_arr=c,this.img_arr_length=c.length,this.div_id=d,this.$div_id=a("#"+this.div_id),this.max_slide=7,this.num_slide=this.img_arr_length>=this.max_slide?this.max_slide:this.img_arr_length,this.isMoreThanMaxSlide=this.num_slide<this.img_arr_length,this.num_slide_counter=this.num_slide,this.slide_offset=~~(this.num_slide/2),this.slide_offset_prev=this.slide_offset,this.slide_offset_next=0===this.num_slide%2?this.slide_offset-1:this.slide_offset,this.slide_curr_index=this.slide_offset,this.slide_prev_index=this.slide_offset-1,this.slide_next_index=this.slide_offset+1,this.img_prev_index=this.img_curr_index?this.img_curr_index-1:this.img_arr_length-1,this.img_next_index=this.img_curr_index<this.img_arr_length-1?this.img_curr_index+1:0,this.img_first_index=this.img_curr_index-this.slide_offset_prev>=0?this.img_curr_index-this.slide_offset_prev:this.img_arr_length+(this.img_curr_index-this.slide_offset_prev),this.isMoreThanMaxSlide&&(this.slide_first_index=0,this.slide_last_index=this.num_slide-1,this.img_last_index=this.img_curr_index+this.slide_offset_next<=this.img_arr_length-1?this.img_curr_index+this.slide_offset_next:this.img_curr_index+this.slide_offset_next-this.img_arr_length),this.isPlay=this.isAutoPlay,this.isTransition=!1,this.transitionEnd=!1,this.transform=!1,this.canTransition=!1,this.controlPanelIsVisible=!0,this.initial_swipe=!0,this.time_ref=null;var f,g=this.$div_id.get(0),h={transition:["transitionend","transition"],OTransition:["oTransitionEnd","-o-transition"],MozTransition:["transitionend","-moz-transition"],WebkitTransition:["webkitTransitionEnd","-webkit-transition"],msTransition:["MStransitionend","-ms-transition"]},i={transform:"transform",msTransform:"-ms-transform",webkitTransform:"-webkit-transform",OTransform:"-o-transform",MozTransform:"-moz-transform"};for(f in h)if(g.style[f]!==b){this.transitionEnd=h[f][0],this.transition=h[f][1];break}for(f in i)if(g.style[f]!==b){this.transform=i[f];break}if(this.transform&&this.transitionEnd&&this.transition){this.canTransition=!0;var j=this.transform,k=(this.transition,this.transition_duration),l=this.transition_timing;this.css_next_el={"z-index":2,transform:"translate3d(-100%, 0, 0)",transition:j+" "+k+" "+l},this.css_curr_next_el={"z-index":2,left:0,transform:"translate3d(-100%, 0, 0)",transition:j+" "+k+" "+l},this.css_prev_el={"z-index":2,transform:"translate3d(100%, 0, 0)",transition:j+" "+k+" "+l},this.css_curr_prev_el={"z-index":2,left:0,transform:"translate3d(100%, 0, 0)",transition:j+" "+k+" "+l},this.css_show_control_panel={height:"60px",transition:"height .2s "+l},this.css_hide_control_panel={height:"0",transition:"height .2s "+l}}else this.css_next_el={"z-index":2},this.css_curr_next_el={"z-index":2,left:0},this.css_prev_el={"z-index":2},this.css_curr_prev_el={"z-index":2,left:0},this.css_show_control_panel={height:"0"},this.css_hide_control_panel={height:"100%"}},Time.Slideshow.prototype.render=function(){var b,c,d,e=this.img_first_index,f=this.img_arr_length-1,g=!0,h="",i="",j=[];if(this.pre_render&&this.pre_render(),!this.$div_id.length)return!1;for(;this.num_slide_counter--;)e>f&&(e=0),e!=this.img_curr_index?(j=[],b=this.img_arr[e],d=b.src,j.push(d.small_2x+" 320w 2x"),j.push(d.large+" 800w"),j.push(d.large_2x+" 800w 2x"),slide_el='<figure class="slide"><img src="'+d.large+'" alt="'+b.alt+'" srcset="'+j.join()+'"/><figcaption class="slide-caption"><span class="credit">'+_.unescape(b.credit)+"</span></figcaption></figure>",g?h+=slide_el:i+=slide_el):g=!1,e+=1;this.$slideshow_wrapper=this.$div_id.find(".slideshow-wrapper").eq(0),c=this.$slideshow_wrapper.find("figure").eq(0),c.before(h),c.after(i),this.slide_els_arr=this.$div_id.find("figure").toArray(),this.$slide_curr_el=a(this.slide_els_arr[this.slide_curr_index]),this.$slide_prev_el=a(this.slide_els_arr[this.slide_prev_index]),this.$slide_next_el=a(this.slide_els_arr[this.slide_next_index]),this.isMoreThanMaxSlide&&(this.$slide_first_el=a(this.slide_els_arr[this.slide_first_index]),this.$slide_last_el=a(this.slide_els_arr[this.slide_last_index])),this.$slide_curr_el.addClass("current"),this.$slide_next_el.get(0).style.left="100%",this.$slide_prev_el.get(0).style.left="-100%",this.post_render&&this.post_render()},Time.Slideshow.prototype.render_control_panel=function(){var a='<div class="control-panel"></div>';this.$div_id.append(a),this.$control_panel=this.$div_id.find(".control-panel").eq(0)},Time.Slideshow.prototype.render_controls=function(){var a=this.isAutoPlay?this.pause_class_state:this.play_class_state;prev_button='<button class="'+this.prev_buttonClass+'"></button>',next_button='<button class="'+this.next_buttonClass+'"></button>',pause_play_button=this.isAutoPlay?'<button class="'+this.pause_play_buttonClass+" "+a+'"></button>':"",controls='<div class="slideshow-controls">'+prev_button+pause_play_button+next_button+"</div>",this.$control_panel.append(controls),this.$prev_button=this.$div_id.find(".prev"),this.$next_button=this.$div_id.find(".next"),this.cycle||(0===this.img_curr_index&&this.$control_panel.addClass("disable-prev"),this.img_curr_index===this.img_arr_length-1&&this.$control_panel.addClass("disable-next")),this.isAutoPlay&&(this.$pause_play_button=this.$div_id.find(".pause_play"))},Time.Slideshow.prototype.render_count_display=function(){var a='<div class="count-display"> <span class="current_index">'+(this.img_curr_index+1)+'</span> of <span class="total">'+this.img_arr_length+"</span></div>";this.$control_panel.append(a),this.$current_index_text=this.$div_id.find(".current_index").eq(0)},Time.Slideshow.prototype.endTransitionNextHandler=function(){if(this.$slide_curr_el.removeAttr("style").removeClass(this.current_class),this.$slide_prev_el.get(0).style.left="",this.img_curr_index=this.img_curr_index+1<this.img_arr_length?this.img_curr_index+=1:0,this.$current_index_text.text(this.img_curr_index+1),this.isMoreThanMaxSlide){this.img_last_index=this.img_last_index+1<this.img_arr_length?this.img_last_index+=1:0,this.img_first_index=this.img_first_index+1<this.img_arr_length?this.img_first_index+=1:0,this.slide_first_index=this.slide_first_index+1<this.num_slide?this.slide_first_index+=1:0;var b=this.img_arr[this.img_last_index],c=b.src,d=[];d.push(c.small_2x+" 320w 2x"),d.push(c.large+" 800w"),d.push(c.large_2x+" 800w 2x"),this.$slide_first_el.find("img").attr("src",c.large).attr("srcset",d.join()),this.$slide_first_el.find(".credit").html(b.credit),this.slide_last_index=this.slide_last_index+1<this.num_slide?this.slide_last_index+=1:0,this.$slide_first_el=a(this.slide_els_arr[this.slide_first_index]),this.$slide_last_el=a(this.slide_els_arr[this.slide_last_index])}this.slide_prev_index=this.slide_curr_index,this.slide_curr_index=this.slide_next_index,this.slide_next_index=this.slide_next_index+1<this.num_slide?this.slide_next_index+=1:0,this.$slide_curr_el=a(this.slide_els_arr[this.slide_curr_index]),this.$slide_prev_el=a(this.slide_els_arr[this.slide_prev_index]),this.$slide_next_el=a(this.slide_els_arr[this.slide_next_index]),this.$slide_curr_el.removeAttr("style").addClass(this.current_class),this.$slide_next_el.get(0).style.left="100%",this.$slide_prev_el.get(0).style.left="-100%",!this.cycle&&this.$control_panel.hasClass("disable-prev")&&this.$control_panel.removeClass("disable-prev"),this.isPlay&&this.cycle?this.play():this.isPlay&&this.img_curr_index<this.img_arr_length-1?this.play():this.isPlay&&this.img_curr_index>=this.img_arr_length-1?(this.pause(),this.$control_panel.addClass("disable-next")):this.cycle||this.img_curr_index!==this.img_arr_length-1||this.$control_panel.addClass("disable-next"),this.isTransition=!1},Time.Slideshow.prototype.endTransitionPrevHandler=function(){if(this.$slide_prev_el.get(0).style.left="",this.$slide_curr_el.removeAttr("style").removeClass(this.current_class),this.img_curr_index=this.img_curr_index-1>=0?this.img_curr_index-=1:this.img_arr_length-1,this.$current_index_text.text(this.img_curr_index+1),this.isMoreThanMaxSlide){this.img_first_index=this.img_first_index-1>=0?this.img_first_index-=1:this.img_arr_length-1,this.img_last_index=this.img_last_index-1>=0?this.img_last_index-=1:this.img_arr_length-1,this.slide_first_index=this.slide_first_index-1>=0?this.slide_first_index-=1:this.num_slide-1;var b=this.img_arr[this.img_first_index];srcset=b.src,srcset_attr=[],srcset_attr.push(srcset.small_2x+" 320w 2x"),srcset_attr.push(srcset.large+" 800w"),srcset_attr.push(srcset.large_2x+" 800w 2x"),this.$slide_last_el.find("img").attr("src",srcset.large).attr("srcset",srcset_attr.join()),this.$slide_last_el.find(".credit").html(b.credit),this.slide_last_index=this.slide_last_index-1>=0?this.slide_last_index-=1:this.num_slide-1,this.$slide_first_el=a(this.slide_els_arr[this.slide_first_index]),this.$slide_last_el=a(this.slide_els_arr[this.slide_last_index])}this.$slide_next_el.get(0).style.left="",this.$slide_curr_el.removeAttr("style").removeClass(this.current_class),this.slide_next_index=this.slide_curr_index,this.slide_curr_index=this.slide_prev_index,this.slide_prev_index=this.slide_prev_index-1>=0?this.slide_prev_index-=1:this.num_slide-1,this.$slide_curr_el=a(this.slide_els_arr[this.slide_curr_index]),this.$slide_prev_el=a(this.slide_els_arr[this.slide_prev_index]),this.$slide_next_el=a(this.slide_els_arr[this.slide_next_index]),this.$slide_curr_el.removeAttr("style").addClass(this.current_class),this.$slide_next_el.get(0).style.left="100%",this.$slide_prev_el.get(0).style.left="-100%",!this.cycle&&this.$control_panel.hasClass("disable-next")&&this.$control_panel.removeClass("disable-next"),this.isPlay&&this.img_curr_index<this.img_arr_length-1&&this.cycle?this.play():this.isPlay&&this.img_curr_index>=this.img_arr_length-1?this.pause():this.cycle||0!==this.img_curr_index||this.$control_panel.addClass("disable-prev"),this.isTransition=!1},Time.Slideshow.prototype.sliding=function(b,c){if(this.isPlay&&clearTimeout(this.time_ref),this.isTransition)return!1;var d,e,f,g;if("next"===b){if(!this.cycle&&this.img_curr_index>=this.img_arr_length-1&&!this.isPlay&&!c)return!1;this.isTransition=!0,c&&!this.cycle&&this.$control_panel.hasClass("disable-next")&&this.$control_panel.removeClass("disable-next"),d=this.$slide_next_el,e=a.proxy(this.endTransitionNextHandler,this),f=this.css_next_el,g=this.css_curr_next_el}else{if(!this.cycle&&this.img_curr_index<=0)return!1;this.isTransition=!0,d=this.$slide_prev_el,e=a.proxy(this.endTransitionPrevHandler,this),f=this.css_prev_el,g=this.css_curr_prev_el}d.css(f),this.$slide_curr_el.css(g),this.canTransition?d.one(this.transitionEnd,e):e()},Time.Slideshow.prototype.sliding_next=function(){this.sliding("next")},Time.Slideshow.prototype.sliding_prev=function(){this.sliding("prev")},Time.Slideshow.prototype.pause=function(){this.isPlay=!1,clearTimeout(this.time_ref),this.$pause_play_button.removeClass(this.pause_class_state).addClass(this.play_class_state)},Time.Slideshow.prototype.pause_play=function(){this.isPlay?this.pause():(this.sliding("next",!0),this.play())},Time.Slideshow.prototype.play=function(){var a=this;this.isPlay=!0,clearTimeout(this.time_ref),this.time_ref=setTimeout(function(){a.sliding("next")},a.play_timer),this.$pause_play_button.removeClass(this.play_class_state).addClass(this.pause_class_state)},Time.Slideshow.prototype.hide_control_panel=function(){this.$control_panel.css(this.css_hide_control_panel),this.controlPanelIsVisible=!1},Time.Slideshow.prototype.show_control_panel=function(){this.$control_panel.css(this.css_show_control_panel),this.controlPanelIsVisible=!0},Time.Slideshow.prototype.hide_show_control_panel=function(){this.controlPanelIsVisible?this.hide_control_panel():this.show_control_panel()},Time.Slideshow.prototype.bind_hide_show_control_panel_event=function(){this.$slideshow_wrapper.add(this.$next_button).add(this.$prev_button).add(this.$pause_play_button).unbind("click.bind_hide_show_control_panel"),this.$div_id.hover(a.proxy(this.show_control_panel,this),a.proxy(this.hide_control_panel,this))},Time.Slideshow.prototype.bind_desktop_control_events=function(){this.$next_button.bind("click",a.proxy(this.sliding_next,this)),this.$prev_button.bind("click",a.proxy(this.sliding_prev,this)),this.$slideshow_wrapper.bind("click",a.proxy(this.sliding_next,this)),this.$slideshow_wrapper.add(this.$next_button).add(this.$prev_button).bind("click.bind_hide_show_control_panel",a.proxy(this.bind_hide_show_control_panel_event,this)),this.isAutoPlay&&this.$pause_play_button.bind("click",a.proxy(this.pause_play,this)).bind("click.bind_hide_show_control_panel",a.proxy(this.bind_hide_show_control_panel_event,this))
},Time.Slideshow.prototype.swipe=function(a){this.initial_swipe&&(this.hide_control_panel(),this.initial_swipe=!1),"next"===a?this.sliding_next():this.sliding_prev()},Time.Slideshow.prototype.swipe_left=function(a){a.preventDefault(),this.swipe("next")},Time.Slideshow.prototype.swipe_right=function(a){a.preventDefault(),this.swipe("prev")},Time.Slideshow.prototype.render_swipe_instructions=function(){var a='<p class="swipe-instructions">Swipe for More</p>';this.$control_panel.append(a)},Time.Slideshow.prototype.bind_mobile_control_events=function(){var b=this;this.$slideshow_wrapper.bind("click",a.proxy(b.hide_show_control_panel,b)),this.$div_id.touchwipe({wipeLeft:a.proxy(b.swipe_left,b),wipeRight:a.proxy(b.swipe_right,b),min_move_x:6,min_move_y:6,preventDefaultEvents:!1})},Time.Slideshow.prototype.init=function(){return this.img_arr_length<=2?!1:(this.render(),this.render_control_panel(),"desktop"===this.experience?(this.render_controls(),this.bind_desktop_control_events(),this.isAutoPlay&&this.play()):(this.render_swipe_instructions(),this.isPlay=!1,this.isAutoPlay=!1,this.bind_mobile_control_events()),this.render_count_display(),void 0)}}(jQuery);var last_taboola_article_id=!1,$last_taboola_divider=!1;;
window.Time.templates = {
  "article-single-cover": "<article class=\"full-article cover {{#hero}}has-hero-image{{/hero}} {{#paid}}paid{{/paid}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{#hero}}  <figure class=\"cover-article-image cover-article-nojs-touch\">    <img src=\"{{src.small}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>    <div class=\"cover-article-image-overlay\">      <figcaption class=\"image-caption\">        <h5 class=\"magazine-header\">Magazine</h5>        <h1 class=\"article-title\" {{#headline_color}}style=\"color:{{headline_color}};\"{{/headline_color}}>{{{title}}}</h1>      </figcaption>    </div>  </figure>  {{/hero}}  <header class=\"article-header\">    <h1 class=\"article-title\">{{{title}}}</h1>    {{> article-meta}}  </header>  <section class=\"article-body\" itemprop=\"articleBody\">    {{#hero}}    <figcaption class=\"image-caption cover-image-caption\">      {{#caption}}<span class=\"caption\">{{{caption}}}</span>{{/caption}}      {{#credit}}<span class=\"credit\">{{{credit}}}</span>{{/credit}}    </figcaption>    {{/hero}}    {{#excerpt}}    <p class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</p>    {{/excerpt}}    {{#paid}}      <p class=\"subscribe subscribe-top\">Subscriber content preview. <span class=\"magazine-cm-subscribe magazine-cm-subscribe-top\" id=\"magazine-cm-subscribe-top-{{id}}\"></span> or <a href=\"#signin\">Sign In</a></p>    {{/paid}}    {{{content}}}  </section>  {{> article-footer}}</article>",
  "article-single-gallery": "<article class=\"full-article has-primary-gallery {{#hero}}has-hero-image{{/hero}} {{#paid}}paid{{/paid}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{> article-header}}  {{#excerpt}}  <h2 class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</h2>  {{/excerpt}}  <figure class=\"bleed primary-module-hero {{gallery.skin}} primary-gallery\" data-gallery=\"{{id}}\"></figure>  <section class=\"article-body\" itemprop=\"articleBody\">    {{{content}}}  </section>  {{> article-footer}}</article>",
  "article-single-interactive": "<article class=\"full-article {{#hero}}has-hero-image{{/hero}} {{#paid}}paid{{/paid}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{> article-header}}  <div class=\"interactive-wrap\">    {{{interactive}}}  </div>  <section class=\"article-body\" itemprop=\"articleBody\">    {{#excerpt}}    <h2 class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</h2>    {{/excerpt}}    {{{content}}}  </section>  {{> article-footer}}</article>",
  "article-single-list": "<article class=\"list-article {{format}} {{#hero}}has-hero-image{{/hero}} {{#paid}}paid{{/paid}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{> article-header}}  <section class=\"article-body\" itemprop=\"articleBody\">    {{#excerpt}}    <h2 class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</h2>    {{/excerpt}}    {{#content}}      {{{content}}}    {{/content}}    <ul class=\"article-items\">    {{#list_items}}      <li class=\"article-item clearfix\" id=\"{{id}}\" data-item-slug=\"{{slug}}\">        {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}        <header class=\"article-item-header\">          {{#ranking}}<span class=\"article-item-title-prefix\">{{ranking}}. </span>{{/ranking}}          <h2 class=\"article-item-title\" itemprop=\"headline\">{{{title}}}</h2>          <div class=\"article-item-share\">            <button class=\"time-icons time-icons-share expand-share\" data-event=\"exp-micro\">Share</button>            <span class=\"social-links-tooltip\">              <a class=\"time-icons time-icons-mail\" href=\"mailto:?subject={{{email_title}}}&body={{{email_body}}}\" data-event=\"email-micro\"></a>              <a class=\"time-icons time-icons-tw popup\" href=\"#\" data-href=\"https://twitter.com/intent/tweet?url={{{encoded_shortlink}}}&text={{{twitter_text}}}&via={{twitter_via}}\" data-event=\"twitter-micro\"></a>              <a class=\"time-icons time-icons-fb popup\" href=\"https://www.facebook.com/sharer/sharer.php?u={{{encoded_url}}}\" data-event=\"fb-micro\"></a>              <a class=\"time-icons time-icons-gplus popup\" href=\"https://plus.google.com/share?url={{{encoded_url}}}\" data-event=\"google+-micro\"></a>              <a class=\"time-icons time-icons-reddit popup\" href=\"http://reddit.com/submit?url={{{encoded_url}}}&title={{{encoded_title}}}\" data-event=\"reddit-micro\"></a>            </span>          </div>        </header>        {{#hero}}        <figure class=\"{{class}}\">          <img src=\"{{hero.src.large}}\" itemprop=\"image\" alt=\"{{alt}}\" srcset=\"{{#hero.src.small_2x}}{{hero.src.small_2x}} 320w 2x{{/hero.src.small_2x}}{{#hero.src.large}}, {{hero.src.large}} 800w{{/hero.src.large}}{{#hero.src.large_2x}}, {{hero.src.large_2x}} 800w 2x{{/hero.src.large_2x}}\"/>          <figcaption class=\"image-caption\">            {{#caption}}<span class=\"caption\">{{{caption}}}</span>{{/caption}}            {{#credit}}<span class=\"credit\">{{{credit}}}</span>{{/credit}}          </figcaption>        </figure>        {{/hero}}        <section class=\"article-item-body\" itemprop=\"articleBody\">          {{{content}}}        </section>      </li>    {{/list_items}}    </ul>  </section>  {{> article-footer}}</article>",
  "article-single-sponsored": "<article class=\"full-article-sponsored {{#hero}}hero-image{{/hero}}\" id=\"article-{{id}}\"  data-article=\"{{id}}\" style=\"{{#sponsor.color}}border-bottom-color:{{sponsor.color}};{{/sponsor.color}}\">    <style type=\"text/css\">      {{#color}}      #article-{{id}} a,      #article-{{id}} a:hover,      #article-{{id}} a:active {        color: #{{color}}!important;      }      {{/color}}      {{#fonts}}      #article-{{id}} p {        font-family: #{fonts}}!important;      }      {{/fonts}}    </style>    <div class=\"sponsor-header\" {{#sponsor.color}}style=\"background-color: {{sponsor.color}};\"{{/sponsor.color}}>      {{#sponsor.thumbnail}}<a href=\"/content-from/{{sponsor.slug}}/\"><img class=\"sponsored-logo\" src=\"{{sponsor.thumbnail}}\"/></a>{{/sponsor.thumbnail}}      <span class=\"sponsored-text\">Content From: </span>      <a href=\"/content-from/{{sponsor.slug}}/\" class=\"sponsored-from\">{{sponsor.name}}</a>    </div>  <div class=\"sponsored-article-content-wrap\">    <header class=\"article-header\">      <h1 class=\"article-title\">{{{title}}}</h1><div class=\"article-meta\">  <time class=\"publish-date\" datetime=\"{{time.published}}\" pubdate>{{time.pretty}}</time>  {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link\">Edit</a>{{/edit_link}}  <section class=\"social-links\">    {{>article-share-buttons}}  </section></div>    </header>    {{#hero}}    <figure class=\"hero-image\">      <img src=\"{{ src.small }}\" alt=\"{{ alt }}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>      <figcaption class=\"image-caption\">        {{#caption}}<span class=\"caption\">{{{caption}}}</span>{{/caption}}        {{#credit}}<span class=\"credit\">{{{credit}}}</span>{{/credit}}      </figcaption>    </figure>    {{/hero}}    {{#excerpt}}    <section class=\"article-excerpt\">      <p>{{{excerpt}}}</p>    </section>    {{/excerpt}}    <section class=\"article-body\">      {{{content}}}    </section>    <footer class=\"article-footer sponsored-article-footer\"><div class=\"article-meta\">  <section class=\"social-links\">    {{>article-share-buttons}}  </section></div>    </footer>  </div></article>",
  "article-single-video": "<article class=\"full-article {{#hero}}has-hero-image{{/hero}} {{#paid}}paid{{/paid}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{> article-header}}  <section class=\"article-body\" itemprop=\"articleBody\">    {{#video}}      <figure class=\"primary-video-wrapper{{{#video.align}}} video-{{{video.align}}}{{{/video.align}}}\" itemprop=\"video\">{{{video.embed}}}</figure>    {{/video}}    {{#excerpt}}    <h2 class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</h2>    {{/excerpt}}    {{#content}}      <span class=\"read-video-article\">+ READ ARTICLE</span>      <div class=\"video-content\">         {{{content}}}      </div>    {{/content}}  </section>  {{> article-footer}}</article>",
  "article-single": "<article class=\"full-article {{#hero}}has-hero-image{{/hero}} {{#paid}}paid{{/paid}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{> article-header}}  <section class=\"article-body\" itemprop=\"articleBody\">    {{#hero}}    <figure class=\"{{class}}\">      <img src=\"{{src.small}}\" itemprop=\"image\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>      <figcaption class=\"image-caption\">        {{#caption}}<span class=\"caption\">{{{caption}}}</span>{{/caption}}        {{#credit}}<span class=\"credit\">{{{credit}}}</span>{{/credit}}      </figcaption>    </figure>    {{/hero}}    {{#excerpt}}    <h2 class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</h2>    {{/excerpt}}    {{#paid}}      <p class=\"subscribe subscribe-top\">Subscriber content preview. <span class=\"magazine-cm-subscribe magazine-cm-subscribe-top\" id=\"magazine-cm-subscribe-top-{{id}}\"></span> or <a href=\"#signin\">Sign In</a></p>    {{/paid}}    {{{content}}}  </section>  {{> article-footer}}</article>",
  "article-tile-magazine-cover": "<article class=\"rail-article-magazine-cover\" data-article=\"{{id}}\" data-issue=\"{{magazine_id}}\">  <div class=\"content\">    {{#magazine.hero}}    <img class=\"magazine-thumb\" src=\"{{src.small}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>    {{/magazine.hero}}    <h4 class=\"rail-article-magazine-issue\"><date>{{magazine.date}}</date><span>Vol {{magazine.volume}} No {{magazine.issue}}</h4>    <h3 class=\"rail-article-title\"><a class=\"article-permalink\" href=\"{{url}}\" data-event=\"tile\">{{{title}}}</a></h3>    {{! <div class=\"magazine_arrow\"></div> }}  </div>  {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}</article>",
  "article-tile-magazine": "<article class=\"rail-article-magazine collapsed {{#icon}}has-icon{{/icon}}\" data-article=\"{{id}}\" data-issue=\"{{magazine_id}}\">  <div class=\"content\">    <h3 class=\"rail-article-title\"><a class=\"article-permalink\" href=\"{{url}}\" data-event=\"tile\">{{{title}}}</a></h3>    {{#excerpt}}    <h2 class=\"rail-article-excerpt\">{{{excerpt}}}</h2>    {{/excerpt}}    {{#icon}}<span class=\"tile-icon time-icons time-icons-{{icon}}\"></span>{{/icon}}  </div>  {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}</article>",
  "article-tile-partner": "<article class=\"rail-article\">  <div class=\"content\">    <h3 class=\"rail-article-title rail-article-title-partners\"><a class=\"article-permalink\" href=\"{{ url }}\" target=\"_blank\" data-event=\"related-partner\">{{{title}}}</a> <span class=\"left-rail-partner-name\">{{{partner}}}</span></h3>  </div>  {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}</article>",
  "article-tile-sponsored": "<article class=\"rail-article-sponsored\" data-article=\"{{id}}\">  <div class=\"content\">    <span class=\"sponsored-text\">Content From</span>    <a href=\"/content-from/{{sponsor.slug}}/\" class=\"sponsored-from\">{{sponsor.name}}</a>    <h3 class=\"rail-article-title\"><a class=\"article-permalink\" href=\"{{url}}\" data-event=\"tile\">{{{title}}}</a></h3>  </div>  {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}</article>",
  "article-tile": "<article class=\"rail-article format-{{format}} {{#icon}}has-icon{{/icon}}\" data-article=\"{{id}}\">  <div class=\"content\">    {{#display_hero}}<img class=\"rail-article-photo\" src=\"{{hero.thumbnail}}\"/>{{/display_hero}}    <h3 class=\"rail-article-title\">      <a class=\"article-permalink\" href=\"{{url}}\" data-event=\"tile\">{{{title}}}</a>      {{#newsfeed}}{{#time}}<time datetime=\"{{{time.updated}}}\">{{{time.short}}}</time>{{/time}}{{/newsfeed}}    </h3>    {{#topic}}<a href=\"{{url}}\" class=\"full-coverage-link\" data-event=\"tile\">Full Coverage</a>{{/topic}}    {{#icon}}<span class=\"tile-icon time-icons time-icons-{{icon}}\"></span>{{/icon}}  </div>  {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link tr time-icons time-icons-edit\"></a>{{/edit_link}}</article>",
  "gallery-ad-slide": "  <div class=\"gallery-slide gallery-ad-slide\" id=\"gallery-ad-slide-{{gallery_id}}-{{gallery_ad_index}}\" pos=\"{{gallery_ad_index}}\">    <strong class=\"advert-headline\">Advertisement</strong>  </div>",
  "gallery-module-headless": "<article class=\"gallery-headless {{skin}}\" id=\"{{id}}\">  <div class=\"gallery-slides\"></div>  <footer class=\"gallery-footer\">    <figcaption class=\"gallery-meta\" aria-hidden=\"true\" >      <span class=\"gallery-meta-caption\"></span>      <span class=\"gallery-meta-author\" ></span>    </figcaption>    <nav class=\"gallery-controls\">      <span class=\"gallery-slide-counter\">        <span class=\"current-slide\"></span>        of        <span class=\"total-slides\" ></span>      </span>      <button class=\"prev time-icons time-icons-previous-outline\"></button>      <button class=\"next time-icons time-icons-next-outline\"></button>    </nav>  </footer>  {{>gallery-share-buttons}}</article>",
  "gallery-module-home": "<article class=\"gallery-large\" id=\"{{id}}\">  <div class=\"prev gallery-home-button-prev\">    <button class=\"time-icons time-icons-previous-outline\"></button>  </div>  <div class=\"gallery-slides\"></div>  <div class=\"next gallery-home-button-next\">    <button class=\"time-icons time-icons-next-outline\"></button>  </div></article>",
  "gallery-module-small": "<article class=\"gallery-portrait {{skin}}\">  <div class=\"superior-gallery-header\" aria-hidden=\"true\">    <h2 class=\"gallery-title\">{{title}}</h2>  </div>  <div class=\"gallery-slides\"></div>  <section class=\"gallery-portrait-panel\">    {{>gallery-share-buttons}}    <header class=\"gallery-header\">      <h2 class=\"gallery-portrait-title\">{{title}}</h2>    </header>    <figcaption class=\"gallery-meta\" aria-hidden=\"true\" >      <span class=\"gallery-meta-caption\"></span>      <span class=\"gallery-meta-author\" ></span>    </figcaption>    <footer class=\"gallery-portrait-footer\">      <span class=\"gallery-slide-counter\">        <span class=\"current-slide\"></span>        of        <span class=\"total-slides\" ></span>      </span>      <nav class=\"gallery-portrait-controls\">        <button class=\"prev time-icons time-icons-previous-outline\"></button>        <button class=\"next time-icons time-icons-next-outline\"></button>      </nav>    </footer>  </section>  {{>gallery-share-buttons}}</article>",
  "gallery-module": "<article class=\"gallery-large {{skin}}\" id=\"{{id}}\">  <header class=\"gallery-header\">    <h2 class=\"gallery-title\">{{{title}}}</h2>    {{>gallery-share-buttons}}  </header>  <div class=\"gallery-slides\"></div>  <footer class=\"gallery-footer\">    <figcaption class=\"gallery-meta\" aria-hidden=\"true\">      <span class=\"gallery-meta-caption\"></span>      <span class=\"gallery-meta-author\" ></span>    </figcaption>    <nav class=\"gallery-controls\">      <span class=\"gallery-slide-counter\">        <span class=\"current-slide\"></span>        of        <span class=\"total-slides\" ></span>      </span>      <button class=\"prev time-icons time-icons-previous\"></button>      <button class=\"next time-icons time-icons-next\"></button>    </nav>  </footer></article>",
  "gallery-related": "<section class=\"gallery-viewport related-galleries\">  <div class=\"gallery-related-wrap\">  {{#galleries}}  <article class=\"gallery-related-item\" id=\"gallery-{{id}}\">    <a class=\"gallery-related-link\" href=\"{{url}}\" data-gallery-ref=\"{{id}}\">      <img class=\"gallery-related-image\" src=\"{{image}}\" />      <h3 class=\"gallery-related-title\">{{title}}</h3>    </a>  </article>  {{/galleries}}</section>",
  "gallery-slide": "<figure class=\"gallery-slide\">  <div class=\"gallery-viewport\">    <img class=\"gallery-slide-img\" src=\"{{src.large_2x}}\" alt=\"{{caption}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>   </div>  <figcaption class=\"gallery-slide-meta\">    {{#caption}}<span class=\"gallery-caption\">{{{caption}}}</span>{{/caption}}    {{#credit}}<span class=\"gallery-author\" >{{{credit}}}</span>{{/credit}}  </figcaption></figure>",
  "homepage-breaking": "<div class=\"home-breaking\"><h2 class=\"home-module-header\">{{{label}}}</h2><h3 class=\"small-home-header\">{{#url}}<a href=\"{{url}}\" data-event=\"hp-breaking\">{{/url}}{{{title}}}</h3>{{#url}}</a>{{/url}}{{#twitter}}<a href=\"{{twitter}}\" class=\"time-icons time-icons-tw popup\"></a>{{/twitter}}</div>",
  "homepage-brief-bottom": "<section class=\"home-brief home-brief-bottom\">  <div class=\"articles\">    {{#articles}}    <article class=\"home-brief-article border-separated-article {{#hero}}has-hero{{/hero}}\">      {{#hero}}        {{#video}}          <figure class=\"home-brief-hero\" data-video=\"{{video.embed}}\">            <div class=\"overlay\">              <span class=\"smallcaps\">Video</span>              <h3>{{video.title}}<span class=\"time-icons time-icons-next-outline\"></span></h3>            </div>            <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>          </figure>        {{/video}}        {{^video}}          <a href=\"{{url}}\" data-event=\"the-brief\">            <figure class=\"home-brief-hero\">               <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>            </figure>          </a>        {{/video}}      {{/hero}}      <h2><a href=\"{{url}}\">{{{short_title}}}</a></h2>      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    </article>    {{/articles}}  </div></section>",
  "homepage-brief-lead": "<section class=\"home-brief home-brief-lead\">  <div class=\"articles\">    {{#articles}}    <article class=\"home-brief-lead-article\">      <h2><a href=\"{{url}}\" data-event=\"the-brief\">{{{short_title}}}</a></h2>      {{#edit_link}}        <div class=\"edit-link-wrapper\">          <a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>        </div>      {{/edit_link}}      {{^slideshow}}        {{#hero}}  <figure class=\"home-brief-hero\">  <a href=\"{{url}}\" {{#video}}data-video=\"{{video.embed}}\"{{/video}} {{#gallery}}data-gallery=\"{{id}}\"{{/gallery}} data-event=\"the-brief\">            <img src=\"{{src.full}}\" alt=\"{{alt}}\" srcset=\"{{#src.large_2x}}{{src.large_2x}} 320w 2x{{/src.large_2x}}{{#src.full}}, {{src.full}} 800w{{/src.full}}{{#src.full_2x}}, {{src.full_2x}} 800w 2x{{/src.full_2x}}\"/>        {{#gallery}}            <div class=\"next gallery-home-button-next\">  <button class=\"time-icons time-icons-next-outline\"></button>            </div>        {{/gallery}}        {{#video}}        <span class=\"time-icons time-icons-next-outline home-brief-video-icon\"></span>        {{/video}}          </a>  {{#credit}}          <figcaption class=\"image-caption\">            <span class=\"credit\">{{{credit}}}</span>          </figcaption>          {{/credit}}        </figure>        {{/hero}}      {{/slideshow}}      {{#slideshow}}        <div id=\"slideshow-{{id}}\" class=\"slideshow\" {{#autoplay}}data-autoplay=\"true\"{{/autoplay}} {{#loop}}data-cycle=\"true\"{{/loop}} data-id=\"{{id}}\">          <div class=\"slideshow-wrapper\">          {{#hero}}            <figure class=\"slide\">                <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>              {{#credit}}              <figcaption class=\"slide-caption\">                <span class=\"credit\">{{{credit}}}</span>              </figcaption>              {{/credit}}            </figure>          {{/hero}}          </div>        </div>      {{/slideshow}}      <div class=\"home-brief-title-and-excerpt\">        {{#excerpt}}        <p class=\"home-excerpt\">          {{{excerpt}}}        </p>        {{/excerpt}}        {{#related}}        <div class=\"related-lead-articles\">          {{#posts}}          <div class=\"red-bullet\">            <h3 class=\"home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\"><a href=\"{{url}}\" data-event=\"the-brief\">{{{title}}}</a></h3>            {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}          </div>          {{/posts}}        </div>        {{/related}}      </div>    </article>    {{/articles}}  </div></section>",
  "homepage-brief-top": "<section class=\"home-brief home-brief-top\">  <h3 class=\"the-brief-header\"><span>The</span> Brief</h3>  <div class=\"articles\">    {{#articles}}    <article class=\"home-brief-article border-separated-article {{#hero}}has-hero{{/hero}}\">      {{^slideshow}}      {{#hero}}  <figure class=\"home-brief-hero\">      <a href=\"{{url}}\" {{#video}}data-video=\"{{video.embed}}\"{{/video}} {{#gallery}}data-gallery=\"{{id}}\"{{/gallery}} data-event=\"the-brief\">            <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>        {{#gallery}}            <div class=\"next gallery-home-button-next\">  <button class=\"time-icons time-icons-next-outline\"></button>            </div>        {{/gallery}}        {{#video}}        <span class=\"time-icons time-icons-next-outline home-brief-video-icon\"></span>        {{/video}}      </a>  {{#credit}}          <figcaption class=\"image-caption\">            <span class=\"credit\">{{{credit}}}</span>          </figcaption>          {{/credit}}    </figure>  {{/hero}}      {{/slideshow}}      {{#slideshow}}        <div id=\"slideshow-{{id}}\" class=\"slideshow\" {{#autoplay}}data-autoplay=\"true\"{{/autoplay}} {{#loop}}data-cycle=\"true\"{{/loop}} data-id=\"{{id}}\">          <div class=\"slideshow-wrapper\">          {{#hero}}            <figure class=\"slide\">                <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>              {{#credit}}              <figcaption class=\"slide-caption\">                <span class=\"credit\">{{{credit}}}</span>              </figcaption>              {{/credit}}            </figure>          {{/hero}}          </div>        </div>      {{/slideshow}}      <h2><a href=\"{{url}}\" data-event=\"the-brief\">{{{short_title}}}</a></h2>      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}      {{#excerpt}}      <p class=\"home-excerpt\">        {{{excerpt}}}      </p>      {{/excerpt}}      {{#related}}        <div class=\"related-lead-articles\">          {{#posts}}          <div class=\"red-bullet\">            <h3 class=\"home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\"><a href=\"{{url}}\" data-event=\"the-brief\">{{{title}}}</a></h3>          </div>          {{/posts}}        </div>        {{/related}}    </article>    {{/articles}}  </div>  <div class=\"home-brief-signup\">    <form action=\"https://ebm.cheetahmail.com/r/regf2\" method=\"post\" target=\"time_brief_popup\" onsubmit=\"window.open(this.action, 'time_brief_popup', 'width=486,height=250');\">    <label for=\"homepage-brief-signup-input\">Sign up for <span>THE</span> <strong>BRIEF</strong></label>        <input type=\"hidden\" name=\"n\" value=\"4\">        <input name=\"aid\" type=\"hidden\" value=\"1078532063\">        <input type=\"hidden\" name=\"fsub\" value=\"2095224265\">        <input type=\"hidden\" name=\"TIME_SOURCE\" value=\"Time_Brief_Widget\">        <input type=\"hidden\" name=\"re\" value=\"http://f.time.chtah.net/i/30/1078532063/thanks.html\">        <input type=\"text\" class=\"text\" name=\"email\" placeholder=\"Email\" id=\"home-brief-signup-input\" />        <input type=\"submit\" class=\"submit button\" value=\"Submit\" />    </form>  </div></section>",
  "homepage-brief": "<section class=\"home-brief layout-{{layout}}\">  <h3 class=\"the-brief-header\"><span>The</span> Brief</h3>  <div class=\"articles\">    {{#articles}}    <article class=\"home-brief-article border-separated-article home-brief-{{layout}} {{#hero}}has-hero{{/hero}}\">      {{#is_compact}}        <h2><a href=\"{{url}}\" data-event=\"the-brief\">{{{short_title}}}</a></h2>        {{#edit_link}}          <div class=\"edit-link-wrapper\">            <a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>          </div>        {{/edit_link}}      {{/is_compact}}    {{^slideshow}}        {{#hero}}    <figure class=\"home-brief-hero\">        <a href=\"{{url}}\" {{#video}}data-video=\"{{video.embed}}\"{{/video}} {{#gallery}}data-gallery=\"{{id}}\"{{/gallery}} data-event=\"the-brief\">              <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>          {{#gallery}}              <div class=\"next gallery-home-button-next\">    <button class=\"time-icons time-icons-next-outline\"></button>              </div>          {{/gallery}}          {{#video}}          <span class=\"time-icons time-icons-next-outline home-brief-video-icon\"></span>          {{/video}}        </a>    {{#credit}}            <figcaption class=\"image-caption\">              <span class=\"credit\">{{{credit}}}</span>            </figcaption>            {{/credit}}      </figure>  {{/hero}}      {{/slideshow}}      {{#slideshow}}        <div id=\"slideshow-{{id}}\" class=\"slideshow\" {{#autoplay}}data-autoplay=\"true\"{{/autoplay}} {{#loop}}data-cycle=\"true\"{{/loop}} data-id=\"{{id}}\">          <div class=\"slideshow-wrapper\">          {{#hero}}            <figure class=\"slide\">                <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>              {{#credit}}              <figcaption class=\"slide-caption\">                <span class=\"credit\">{{{credit}}}</span>              </figcaption>              {{/credit}}            </figure>          {{/hero}}          </div>        </div>      {{/slideshow}}<div class=\"home-brief-title-and-excerpt\">        {{^is_compact}}    <h2><a href=\"{{url}}\" data-event=\"the-brief\">{{{short_title}}}</a></h2>        {{/is_compact}}      {{#excerpt}}      <p class=\"home-excerpt\">        {{{excerpt}}}      </p>      {{/excerpt}}        {{#related}}        <div class=\"related-lead-articles\">          {{#posts}}          <div class=\"red-bullet\">            <h3 class=\"home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\"><a href=\"{{url}}\" data-event=\"the-brief\">{{{title}}}</a></h3>            {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}          </div>          {{/posts}}        </div>        {{/related}}</div>    {{^is_compact}}      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    {{/is_compact}}        </article>    {{/articles}}  </div>  <div class=\"home-brief-signup\">    <form action=\"https://ebm.cheetahmail.com/r/regf2\" method=\"post\" target=\"time_brief_popup\" onsubmit=\"window.open(this.action, 'time_brief_popup', 'width=486,height=250');\">    <label for=\"homepage-brief-signup-input\">Sign up for <span>THE</span> <strong>BRIEF</strong></label>        <input type=\"hidden\" name=\"n\" value=\"4\">        <input name=\"aid\" type=\"hidden\" value=\"1078532063\">        <input type=\"hidden\" name=\"fsub\" value=\"2095224265\">        <input type=\"hidden\" name=\"TIME_SOURCE\" value=\"Time_Brief_Widget\">        <input type=\"hidden\" name=\"re\" value=\"http://f.time.chtah.net/i/30/1078532063/thanks.html\">        <input type=\"text\" class=\"text input-field\" name=\"email\" placeholder=\"Email\" id=\"home-brief-signup-input\" />        <input type=\"submit\" class=\"submit button\" value=\"Submit\" />    </form>  </div></section>",
  "homepage-columnists": "<section class=\"home-columnists home-right-rail-module\">  {{#title}}<h2 class=\"home-module-header\">{{title}}</h2>{{/title}}  <div class=\"articles\">    {{#articles}}    <article class=\"home-columnists-article border-separated-article {{#hero}}has-hero{{/hero}}\">    {{#hero}}    <a href=\"{{url}}\" class=\"home-article-thumbnail\" data-event=\"columnists\">    <img src=\"{{ src.small }}\" alt=\"{{ alt }}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\">    </a>    {{/hero}}    <div class=\"home-columnists-author-and-title {{^hero}}home-columnists-author-and-title-no-hero{{/hero}} home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\">    <h3 class=\"home-columnists-author\"><a href=\"{{author.url}}\">{{author.name}}</a></h3><h4 class=\"small-home-header\"><a class=\"home-columnists-title\" href=\"{{url}}\" data-event=\"columnists\">{{{short_title}}}</a></h4></div>    {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    </article>    {{/articles}}  </div></section>",
  "homepage-editorial-promo": "<section class=\"read-more-divider-hero\">{{#articles}}  {{#hero}}  <img class=\"article-thumbnail\" src=\"{{ src.full }}\" alt=\"{{ alt }}\"   srcset=\"{{#src.large_2x}}{{src.large_2x}} 320w 2x{{/src.large_2x}}{{#src.full_2x}}, {{src.full_2x}} 800w{{/src.full_2x}}{{#src.full_2x}}, {{src.full_2x}} 800w 2x{{/src.full_2x}}\"/>  {{/hero}}  <a class=\"related-article\" href=\"{{url}}\" data-event=\"large-image\">    <div class=\"single-related-article-interior\">      {{#section}}      <div class=\"tags\">        <h6 class=\"section-tag\">{{name}}</h6>      </div>      {{/section}}      <h4 class=\"article-title\">{{{short_title}}}</h4>    </div>  </a>{{/articles}}</section>",
  "homepage-freeform": "<section class=\"home-freeform home-right-rail-module\">  {{#title}}<h2 class=\"home-module-header\">{{title}}</h2>{{/title}}  <div class=\"articles\">    {{#articles}}    <article class=\"home-freeform-article border-separated-article {{format}} {{#hero}}has-hero{{/hero}}\">      {{#hero}}      <figure class=\"home-freeform-hero\">        <a href=\"{{url}}\">          <img src=\"{{src.small}}\" alt=\"{{alt}}\" srcset=\"{{#src.small}}{{src.small}} 320w{{/src.small}}{{#src.small_2x}},{{src.small_2x}} 320w 2x{{/src.small_2x}}\"/>        </a>      </figure>      {{/hero}}      <h3 class=\"medium-home-header home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\"><a href=\"{{url}}\">{{{short_title}}}</a></h3>      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    </article>    {{/articles}}  </div></section>",
  "homepage-hero-feature": "<section class=\"home-hero-feature\">{{#articles}}  {{#hero}}  <img class=\"article-thumbnail\" src=\"{{ src.small }}\" alt=\"{{ alt }}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>  {{/hero}}  <a class=\"related-article\" href=\"{{url}}\" data-event=\"large-image\">    <div class=\"single-related-article-interior\">      {{#section}}      <div class=\"tags\">        <h6 class=\"section-tag\">{{name}}</h6>      </div>      {{/section}}      <h4 class=\"article-title\">{{{short_title}}}</h4>    </div>  </a>{{/articles}}</section>",
  "homepage-magazine": "<section class=\"home-magazine home-right-rail-module\">  {{#title}}<h2 class=\"home-module-header\">{{title}}</h2>{{/title}}{{#lead_story}}  <div class=\"home-magazine-current-issue border-separated-article {{#hero}}has-hero{{/hero}}\">    {{#hero}}    <a href=\"{{url}}?pcd=hp-magmod\" class=\"home-article-thumbnail\" data-event=\"hp-magmod\">    <img src=\"{{ src.small }}\" alt=\"{{ alt }}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>    </a>    {{/hero}}    <div class=\"home-magazine-title-and-subscribe\">    <h3 class=\"medium-home-header {{#paid}}home-icons-key{{/paid}}\"><a href=\"{{url}}?pcd=hp-magmod\">{{{short_title}}}</a></h3><a class=\"home-magazine-subscribe\" href=\"https://subscription.time.com/storefront/subscribe-to-time/link/1019507.html\">Subscribe</a>    </div>    {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}  </div>{{/lead_story}}  <div class=\"home-magazine-articles\">    {{#articles}}    <article class=\"home-magazine-article border-separated-article\">      <h3 class=\"small-home-header home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\"><a href=\"{{url}}?pcd=hp-magmod\" data-event=\"hp-magmod\">{{{short_title}}}</a></h3>      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    </article>    {{/articles}}  </div></section>",
  "homepage-newsfeed": "<section class=\"home-newsfeed\">  <h2 class=\"home-module-header\">{{title}}</h2>  <div class=\"articles\">    {{#articles}}    <article class=\"home-newsfeed-article\">      <h5 {{#paid}}class=\"home-icons-key\"{{/paid}}><a href=\"{{url}}\">{{{short_title}}}</a></h5>      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    </article>    {{/articles}}  </div></section>",
  "homepage-photo-of-the-day": "<section class=\"home-photo-of-the-day home-lower-center home-center\">  <h2 class=\"home-module-header\">{{title}}</h2>  {{#articles}}  <article class=\"home-photo-of-the-day-article\">    {{^slideshow}}      {{#hero}}      <figure class=\"home-photo-of-the-day-hero\">        <a href=\"{{url}}\" data-event=\"photo-day\">          <img src=\"{{src.large}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>        </a>        {{#credit}}        <figcaption class=\"image-caption\">          <span class=\"credit\">{{{credit}}}</span>        </figcaption>        {{/credit}}      </figure>      {{/hero}}    {{/slideshow}}    {{#slideshow}}      <div id=\"slideshow-{{id}}\" class=\"slideshow\" {{#autoplay}}data-autoplay=\"true\"{{/autoplay}} {{#loop}}data-cycle=\"true\"{{/loop}} data-id=\"{{id}}\">        <div class=\"slideshow-wrapper\">        {{#hero}}          <figure class=\"slide\">              <img src=\"{{src.small_2x}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>            {{#credit}}            <figcaption class=\"slide-caption\">              <span class=\"credit\">{{{credit}}}</span>            </figcaption>            {{/credit}}          </figure>        {{/hero}}        </div>      </div>    {{/slideshow}}    <h3 {{#paid}}class=\"homepage-icons-key\"{{/paid}}><a href=\"{{url}}\" data-event=\"photo-day\">{{{short_title}}}</a></h3>    <p class=\"home-excerpt\">      {{{excerpt}}}    </p>    {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}  </article>  {{/articles}}</section>",
  "homepage-popular": "<section class=\"home-popular home-right-rail-module\">  {{#title}}<h2 class=\"home-module-header\">{{title}}</h2>{{/title}}  <div class=\"articles\">    {{#articles}}    <article class=\"home-popular-article border-separated-article\">    <div class=\"home-popular-title home-icons-{{format}} {{#paid}}home-icons-key{{/paid}}\">      <h3 class=\"small-home-header\"><a href=\"{{url}}\" data-event=\"popular\">{{{title}}}</a></h3>    </div>      {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}    </article>    {{/articles}}  </div></section>",
  "homepage-sections": "<section class=\"home-sections home-bottom-center home-center\">  <div class=\"sections\">    {{#featured}}      <div class=\"section section-{{index}}\">        <h2><a href=\"{{url}}\">{{section}}</a></h2>        <div class=\"articles\">          {{#articles}}          <article class=\"home-featured-article border-separated-article\" data-article=\"{{id}}\">            <h3><a href=\"{{url}}\" data-event=\"hp-news\">{{{title}}}</a></h3>            {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}          </article>          {{/articles}}        </div>      </div>    {{/featured}}  </div>  <ul class=\"list\">    <li><label>MORE SECTIONS</label></li>    {{#list}}      <li>        <h2><a href=\"{{url}}\">{{section}}</a></h2>      </li>    {{/list}}  </ul></section>",
  "load-more": "<div class=\"infinite-scroll-loader\">  <img src=\"/content/themes/vip/time2014/img/loader-light.gif\" alt=\"Loading\"></div>",
  "magazine-cover-image": "{{#hero}}<figure class=\"cover-article-image\">  <img src=\"{{src.small}}\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>  <div class=\"cover-article-image-overlay\">    <figcaption class=\"image-caption\">      <h5 class=\"magazine-header\">Magazine</h5>      <h1 class=\"article-title\" {{#headline_color}}style=\"color:{{headline_color}};\"{{/headline_color}}>{{{title}}}</h1>    </figcaption>  </div></figure>{{/hero}}",
  "market-data": "<table id=\"market-data\">  {{#markets}}    <tr class=\"market-data-row\">      <th class=\"market-data-market\">{{index}}</th>      <td class=\"market-value\">{{last}}</td>      <td class=\"{{change_class}} market-change\">{{change}}</td>      <td class=\"{{percent_class}} market-percentage\">{{percent}}%</td>    </tr>  {{/markets}}</table>{{#msg}}<span class=\"micro\">{{msg}}</span>{{/msg}}",
  "poll-module": "<section class=\"user-poll\">  <h5 class=\"user-poll-title\">{{title}}</h5>  <form class=\"user-poll-options\" id=\"{{id}}\" method=\"\" action=\"\">    {{#options}}    <div class=\"user-poll-row\">      <input name=\"{{id}}\" class=\"user-poll-radio\" id=\"{{.}}\" value=\"{{.}}\" type=\"radio\"><label class=\"user-poll-label\" for=\"{{.}}\">{{.}}</label>    </div>    {{/options}}    <button class=\"user-poll-button-primary\" type=\"submit\" >Vote</button>    <button class=\"user-poll-button-secondary\" >View Results</button>  </form></section>",
  "poll-results": "<section class=\"user-poll-results\">  <div class=\"user-poll-graph-display\">    {{#options}}    <div class=\"user-poll-row\">      <div class=\"user-poll-graph\">        <span class=\"user-poll-graph-label\">{{label}}</span>        <div class=\"user-poll-graph-filled\"></div>      </div>      <div class=\"user-poll-meta\">{{percentage}}% ({{votes}} Votes)</div>    </div>    {{/options}}  </div>  <footer class=\"user-poll-results-footer\">    <a class=\"return-to-poll\" href=\"\">Return to Poll</a>    <span class=\"total-votes\">Total Votes:       <span class=\"total-votes-number\">{{total_votes}}</span>    </span>    <span class=\"user-poll-social\">      <a href=\"#tw\" class=\"time-icons time-icons-tw\"></a>      <a href=\"#fb\" class=\"time-icons time-icons-fb\"></a>      <a href=\"#Comments\" class=\"time-icons time-icons-comment\">2</a>    </span>  </footer></section>",
  "rail-header-author": "<header class=\"rail-article-author\">  {{#name}}<h2 class=\"rail-article-brand-title\">{{name}}</h2>{{/name}}  {{#thumbnail}}<img class=\"rail-article-author-photo\" src=\"{{thumbnail}}\" />{{/thumbnail}}  {{#bio}}<p class=\"rail-article-summary-paragraph\">{{{bio}}}</p>{{/bio}}  {{#twitter}}<a target=\"_blank\" href=\"https://twitter.com/{{twitter}}\" class=\"time-icons time-icons-tw\"></a>{{/twitter}}  {{#email}}<a href=\"mailto:{{email}}\" class=\"time-icons time-icons-mail\"></a>{{/email}}  {{#gplus}}<a target=\"_blank\" href=\"https://plus.google.com/{{gplus}}?rel=author\" class=\"time-icons time-icons-gplus\"></a>{{/gplus}}</header>",
  "rail-header-topic": "<header class=\"rail-article-summary\"><h2 class=\"rail-article-topic-title\">{{name}}</h2></header>",
  "rail-tabs": "<div class=\"tabs-inner\">  {{#tabs}}<a href=\"{{href}}\" class=\"rail-tab\" id=\"{{env}}\" data-sub=\"{{sub}}\" role=\"tab\" aria-controls=\"rail-articles\" data-event=\"{{omniture}}\" {{#type}}data-type=\"{{type}}\"{{/type}} {{#silent}}data-silent{{/silent}}>{{{label}}}</a>{{/tabs}}    <form class=\"search-form\" method=\"get\" action=\"http://search.time.com/results.html\" autocomplete=\"off\" role=\"search\">      <input name=\"Ntt\" class=\"search-field\" type=\"search\" placeholder=\"Search\"/>      <input class=\"search-field-submit\" type=\"submit\" value=\"Search\">    </form>    <a href=\"javascript:void 0;\" data-bypass=\"true\" class=\"main-nav-search-button\">      <span class=\"time-icons time-icons-search main-nav-search-icon\" title=\"Click to search Time.com\"></span>    </a>  </div>  <div class=\"topic-banner\">    </div>",
  "related-divider-article-with-ad": "<section class=\"read-more-divider-article-with-ad\">  {{#articles}}  <article class=\"related-article\">    {{#hero}}    <a class=\"article-thumbnail-wrap\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">      <img class=\"article-thumbnail\" src=\"{{src.large}}\" alt=\"{{short_title}}\">    </a>    {{/hero}}    {{#section}}    <section class=\"tags\">      {{#section}}      <a class=\"section-tag\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">{{name}}</a>      {{/section}}      {{#topic}}      <a class=\"topic-tag\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">{{name}}</a>      {{/topic}}    </section>    {{/section}}    <a class=\"article-title-link\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">      <h4 class=\"article-title\">{{short_title}}</h4>    </a>  </article>  {{/articles}}  <div class=\"article-divider-ad-unit\"></div></section>",
  "related-divider-hero": "<section class=\"read-more-divider-hero\">{{#articles}}  {{#hero}}  <img class=\"article-thumbnail\" src=\"{{ src.small }}\" alt=\"{{ alt }}\"   srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>  {{/hero}}  <a class=\"related-article {{#short_title}}has-title{{/short_title}}\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">    <div class=\"single-related-article-interior\">      {{#section}}      <div class=\"tags\">        <h6 class=\"section-tag\">{{name}}</h6>      </div>      {{/section}}      <h4 class=\"article-title\">{{{short_title}}}</h4>    </div>  </a>{{/articles}}</section>",
  "related-divider-latest": "<section class=\"read-more-divider-two-col-list\">  <div class=\"latest-headlines\">    <h3 class=\"divider-col-heading\">Latest Headlines</h3>    <section class=\"related-articles\">      {{#latest_headlines}}      <article class=\"related-article\">        <a class=\"article-title-link\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">          <h4 class=\"article-title\">{{{short_title}}}</h4>        </a>      </article>      {{/latest_headlines}}    </section>  </div>  <div class=\"most-read\">    <h3 class=\"divider-col-heading\">Most Read</h3>     <section class=\"related-articles\">      {{#most_read}}      <article class=\"related-article\">        <a class=\"article-title-link\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">          <h4 class=\"article-title\">{{{short_title}}}</h4>        </a>      </article>      {{/most_read}}    </section>  </div></section>",
  "related-divider": "<section class=\"read-more-divider-grid\">  <div class=\"divider-300x600\"></div>  <div class=\"articles\">    {{#articles}}    <article class=\"related-article\">      {{#hero.src.large}}      <a class=\"article-thumbnail-wrap\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">        <img class=\"article-thumbnail\" src=\"{{hero.thumbnail}}\" alt=\"{{short_title}}\">      </a>      {{/hero.src.large}}      {{#section}}      <section class=\"tags\">        {{#section}}        <a class=\"section-tag\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">{{name}}</a>        {{/section}}      </section>      {{/section}}      <a class=\"article-title-link\" href=\"{{url}}\" data-event=\"{{omniture_event}}\">        <h4 class=\"article-title\">{{{short_title}}}</h4>      </a>    </article>    {{/articles}}  </div></section>",
  "section-menu": "{{#menu}}<div class=\"topic-banner-inner\"><span class=\"topic-banner-slug\">Topics</span>{{#items}}<a class=\"topic-banner-header\" href=\"{{url}}\" title=\"{{attr_title}}\" target=\"{{target}}\" data-event=\"subnav\">{{title}}</a>{{/items}}</div>{{/menu}}",
  "special-story-microsharing": "<div class=\"article-item-share\"><a class=\"time-icons time-icons-share expand-share\" href=\"javascript:void 0;\" title=\"Click to view article share options\"></a><span class=\"social-links-tooltip\">  <a class=\"time-icons time-icons-mail\" href=\"mailto:?subject={{{email_title}}}&body={{{email_body}}}\" data-event=\"email\" title=\"Click to Email this article\"></a>  <a class=\"time-icons time-icons-tw popup\" href=\"https://twitter.com/intent/tweet?url={{{encoded_url}}}&text={{#twitter_text}}{{{twitter_text}}}{{/twitter_text}}{{^twitter_text}}{{{encoded_title}}}{{/twitter_text}}&via={{twitter_via}}\" data-event=\"tweet\" title=\"Click to Tweet this article\"></a>  <a class=\"time-icons time-icons-fb popup\" href=\"http://www.facebook.com/sharer.php?s=100&u={{{encoded_url}}}&title={{{facebook_title}}}&summary={{{facebook_summary}}}\" data-event=\"fb-share\" title=\"Click to post this article to Facebook\"></a>  <a class=\"time-icons time-icons-gplus popup\" href=\"https://plus.google.com/share?url={{{encoded_url}}}\" data-event=\"google+\" title=\"Click to post this article to Google+\"></a>  <a class=\"time-icons time-icons-reddit popup\" href=\"http://reddit.com/submit?url={{{encoded_url}}}&title={{{encoded_title}}}\" data-event=\"reddit\" title=\"Click to post this article to Reddit\"></a></span></div>",
  "special-story": "<article class=\"special-story {{#hero}}has-hero-image{{/hero}}\" id=\"article-{{id}}\" data-article=\"{{id}}\" itemscope itemtype=\"http://schema.org/Article\">  {{#lead}}  <div class=\"lead\">    {{#mobile}}      <figure class=\"{{class}}\">        <img src=\"{{src.small}}\" itemprop=\"image\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large}}, {{src.large}} 800w{{/src.large}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>        <figcaption class=\"image-caption\">          {{#caption}}<span class=\"caption\">{{{caption}}}</span>{{/caption}}          {{#credit}}<span class=\"credit\">{{{credit}}}</span>{{/credit}}        </figcaption>      </figure>    {{/mobile}}    {{^mobile}}      {{#embed}}        {{{embed}}}      {{/embed}}      {{^embed}}        {{#hero}}        <figure class=\"{{class}}\">          <img src=\"{{src.large}}\" itemprop=\"image\" alt=\"{{alt}}\" srcset=\"{{#src.small_2x}}{{src.small_2x}} 320w 2x{{/src.small_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w{{/src.large_2x}}{{#src.large_2x}}, {{src.large_2x}} 800w 2x{{/src.large_2x}}\"/>          <figcaption class=\"image-caption\">            {{#caption}}<span class=\"caption\">{{{caption}}}</span>{{/caption}}            {{#credit}}<span class=\"credit\">{{{credit}}}</span>{{/credit}}          </figcaption>        </figure>        {{/hero}}      {{/embed}}    {{/mobile}}  </div>  {{/lead}}  <div class=\"article-navigation\">    <div class=\"sticky\">      <div class=\"inner\">        <div class=\"social-links\">          <a class=\"time-icons time-icons-share expand-share\" href=\"javascript:void 0;\" title=\"Click to view article share options\"></a>          {{>article-share-buttons}}        </div>        {{#navigation}}        <nav class=\"chapters\">          <h4 class=\"open-chapters\"><a href=\"javascript:void 0;\">Chapters</a></h4>          <ul>            {{#chapters}}            <li{{#has_chapter_label}} class=\"has-chapter-label\"{{/has_chapter_label}}><a href=\"#{{anchor}}\" title=\"{{title}}\" data-event=\"special-ch\">{{short_title}}</a>            {{/chapters}}          </ul>        </nav>        {{/navigation}}      </div>    </div>  </div>  {{#mobile_title}}  <header class=\"article-header\">    <h1 class=\"article-title\" itemprop=\"headline\"{{#headline_color}} style=\"color:{{headline_color}}\"{{/headline_color}}>{{{mobile_title}}}</h1>  </header>  {{/mobile_title}}  <section class=\"article-subhead\">    <div class=\"inner\">      {{#excerpt}}      <h2 class=\"article-excerpt\" itemprop=\"alternativeHeadline\">{{{excerpt}}}</h2>      {{/excerpt}}      <div class=\"article-sub-headline{{#hide_date}} hide-time{{/hide_date}}\">        <div class=\"article-meta\">          <ul class=\"article-authors\">          {{#authors}}            <li class=\"article-author\">              <span class=\"byline\">{{#url}}<a itemprop=\"author\" href=\"{{url}}\" data-bypass=\"true\">{{/url}}{{name}}{{#url}}</a>{{/url}}</span>              {{#twitter}}<a class=\"author-twitter\" target=\"_blank\" href=\"https://twitter.com/{{twitter}}\">@{{twitter}}</a>{{/twitter}}            </li>          {{/authors}}          </ul>          <time class=\"publish-date\" itemprop=\"datePublished\" datetime=\"{{time.published}}\" pubdate>{{time.pretty}}</time>          {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}        </div>      </div>    </div>  </section>  <div class=\"social-links mobile-only\">    <span class=\"time-icons time-icons-comment livefyre-commentcount toggle-comments\" data-lf-site-id=\"314099\" data-lf-article-id=\"{{id}}\" data-url=\"{{url}}\" data-title=\"{{title}}\" title=\"Click to view and post comments\">0</span>    {{>article-share-buttons}}  </div>  <div class=\"article-body\" itemprop=\"articleBody\">    {{{content}}}  </div>  <footer class=\"article-footer\">    <div class=\"article-meta\">      <div class=\"social-links\">        {{>article-share-buttons}}        <span class=\"time-icons time-icons-comment livefyre-commentcount toggle-comments\" data-lf-site-id=\"314099\" data-lf-article-id=\"{{id}}\" data-url=\"{{url}}\" data-title=\"{{title}}\" title=\"Click to view and post comments\">0</span>      </div>      <ul class=\"article-authors\">      {{#authors}}        <li class=\"article-author\">          <span class=\"byline\">{{#url}}<a itemprop=\"author\" href=\"{{url}}\" data-bypass=\"true\">{{/url}}{{name}}{{#url}}</a>{{/url}}</span>          {{#twitter}}<a class=\"author-twitter\" target=\"_blank\" href=\"https://twitter.com/{{twitter}}\">@{{twitter}}</a>{{/twitter}}        </li>      {{/authors}}      </ul>    </div>    <section class=\"livefyre-comment\" id=\"livefyre-{{id}}\"></section>  </footer></article>",
  "ticker-headline": "<article class=\"headline\">  <time class=\"headline-date\" datetime=\"{{ time.updated }}\">{{time.pretty}}</time>  <a class=\"headline-permalink\" href=\"{{ url }}\" data-event=\"newsbar\">    {{#label}}<span class=\"headline-label\">{{label}}:</span> {{/label}}{{{short_title}}}  </a></article>",
  "ticker-module": "<div class=\"ticker-container-outer\">  <div class=\"ticker-container\">    <section class=\"headlines\"></section>    <div class=\"ticker-nav\">      <a class=\"ticker-tweet popup\"><span ariahidden=\"true\" class=\"ticker-tweet-icon\" data-event=\"newsbar-twitter\">&#xe00e;</span><span class=\"visuallyhidden\">Tweet</span></a>      <span aria-hidden=\"true\" class=\"ticker-register\"></span>      <button class=\"prev time-icons time-icons-previous\" data-event=\"newsbar-arrows\"></button>      <button class=\"next time-icons time-icons-next\" data-event=\"newsbar-arrows\"></button>    </div>  </div></div>",
  "top-header": "<div class=\"top-header-container {{#tax}}time-tax-{{tax}}{{/tax}}\">  <h1 class=\"top-header-title\">{{{name}}}</h1></div>",
  "partials/article-footer": "<footer class=\"article-footer {{^comments_allowed}}no-comments{{/comments_allowed}}\">  {{#paid}}  <p class=\"subscribe subscribe-bottom\">To continue reading: <span class=\"magazine-cm-subscribe magazine-cm-subscribe-bottom\" id=\"magazine-cm-subscribe-bottom-{{id}}\"></span> or <a href=\"#signin\">Sign In</a></p>    <div class=\"magazine-cm-module\" id=\"magazine-cm-module-{{id}}\"></div>  {{/paid}}  <div class=\"article-meta\">    {{>article-share-buttons}}    {{#comments_allowed}}      <span class=\"time-icons time-icons-comment livefyre-commentcount toggle-comments\" data-lf-site-id=\"314099\" data-lf-article-id=\"{{id}}\" data-url=\"{{url}}\" data-title=\"{{title}}\" title=\"Click to view and post comments\">0 Comments</span>    {{/comments_allowed}}    <div class=\"article-shortlink\">      <span class=\"article-shortlink-input time-icons time-icons-link shortlink\"></span>      <input type=\"text\" id=\"article-shortlink-{{id}}\" data-event=\"short link\" value=\"{{{shortlink}}}\">    </div>  </div>  {{#comments_allowed}}    <section class=\"livefyre-comment\" id=\"livefyre-{{id}}\"></section>  {{/comments_allowed}}</footer>",
  "partials/article-header": "<header class=\"article-header\">  <section class=\"tags\">    {{#section}}    <a class=\"section-tag\" itemprop=\"articleSection\" href=\"{{url}}\" data-event=\"section-{{slug}}\">{{{name}}}</a>    {{/section}}    {{#tag}}    <a class=\"topic-tag\" itemprop=\"articleSection\" href=\"{{url}}\" data-event=\"tag-{{slug}}\">{{{name}}}</a>    {{/tag}}  </section>  <h1 class=\"article-title\" itemprop=\"headline\">{{{title}}}</h1>  {{>article-meta}}</header>",
  "partials/article-meta": "<div class=\"article-sub-headline\">  <div class=\"article-meta\">    <ul class=\"article-authors\">    {{#authors}}      <li class=\"article-author\">        <span class=\"byline\">{{#url}}<a itemprop=\"author\" href=\"{{url}}\">{{/url}}{{name}}{{#url}}</a>{{/url}}</span>        {{#twitter}}<a class=\"author-twitter\" target=\"_blank\" href=\"https://twitter.com/{{twitter}}\">@{{twitter}}</a>{{/twitter}}      </li>    {{/authors}}    </ul>    <time class=\"publish-date\" itemprop=\"datePublished\" datetime=\"{{time.published}}\" pubdate>{{time.pretty}}</time>    {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}  </div>  <div class=\"social-links\">    <a class=\"time-icons time-icons-share expand-share\" href=\"javascript:void 0;\" title=\"Click to view article share options\"></a>    {{>article-share-buttons}}  </div></div>",
  "partials/article-share-buttons": "<span class=\"social-links-tooltip\">  <a class=\"time-icons time-icons-mail\" href=\"mailto:?subject={{{email_title}}}&body={{{email_body}}}\" data-event=\"email\" title=\"Click to Email this article\"></a>  <a class=\"time-icons time-icons-tw popup\" href=\"#\" data-href=\"https://twitter.com/intent/tweet?url={{{encoded_shortlink}}}&text={{{twitter_text}}}&via={{twitter_via}}\" data-event=\"tweet\" title=\"Click to Tweet this article\"></a>  <a class=\"time-icons time-icons-fb popup\" href=\"https://www.facebook.com/sharer/sharer.php?u={{{encoded_url}}}\" data-event=\"fb-share\" title=\"Click to post this article to Facebook\"></a>  <a class=\"time-icons time-icons-gplus popup\" href=\"https://plus.google.com/share?url={{{encoded_url}}}\" data-event=\"google+\" title=\"Click to post this article to Google+\"></a>  <a class=\"time-icons time-icons-reddit popup\" href=\"http://reddit.com/submit?url={{{encoded_url}}}&title={{{encoded_title}}}\" data-event=\"reddit\" title=\"Click to post this article to Reddit\"></a>  {{#reprint_url}}<a class=\"time-icons time-icons-reprints\" href=\"{{reprint_url}}\" data-event=\"reprints\" title=\"Click to order a reprint of this article\"></a>{{/reprint_url}}</span>",
  "partials/gallery-share-buttons": "<div class=\"gallery-buttons\">  <button class=\"gallery-restart\">Replay</button>  <button class=\"gallery-share time-icons time-icons-share expand-share\" title=\"Click to view gallery share options\" data-event=\"exp-micro\">Share</button>  <span class=\"social-links-tooltip\"><a class=\"time-icons time-icons-mail\" href=\"mailto:?subject={{{email_title}}}&body={{{email_body}}}\" data-event=\"email-micro\" title=\"Click to Email this article\"></a><a class=\"time-icons time-icons-tw popup\" href=\"#\" data-href=\"https://twitter.com/intent/tweet?url={{{encoded_shortlink}}}&text={{{twitter_text}}}&via={{twitter_via}}\" data-event=\"twitter-micro\" title=\"Click to Tweet this article\"></a><a class=\"time-icons time-icons-fb popup\" href=\"https://www.facebook.com/sharer/sharer.php?u={{{encoded_url}}}\" data-event=\"fb-micro\" title=\"Click to post this article to Facebook\"></a><a class=\"time-icons time-icons-gplus popup\" href=\"https://plus.google.com/share?url={{{encoded_url}}}\" data-event=\"google+-micro\" title=\"Click to post this article to Google+\"></a><a class=\"time-icons time-icons-reddit popup\" href=\"http://reddit.com/submit?url={{{encoded_url}}}&title={{{encoded_title}}}\" data-event=\"reddit-micro\" title=\"Click to post this article to Reddit\"></a></span>  {{#fullscreen}}  <button class=\"gallery-toggle-fullscreen time-icons time-icons-fullscreen\" title=\"Click to view the gallery full screen\">Fullscreen</button>  {{/fullscreen}}</div>"
};
window.Time.partials = {
  "article-footer": "<footer class=\"article-footer {{^comments_allowed}}no-comments{{/comments_allowed}}\">  {{#paid}}  <p class=\"subscribe subscribe-bottom\">To continue reading: <span class=\"magazine-cm-subscribe magazine-cm-subscribe-bottom\" id=\"magazine-cm-subscribe-bottom-{{id}}\"></span> or <a href=\"#signin\">Sign In</a></p>    <div class=\"magazine-cm-module\" id=\"magazine-cm-module-{{id}}\"></div>  {{/paid}}  <div class=\"article-meta\">    {{>article-share-buttons}}    {{#comments_allowed}}      <span class=\"time-icons time-icons-comment livefyre-commentcount toggle-comments\" data-lf-site-id=\"314099\" data-lf-article-id=\"{{id}}\" data-url=\"{{url}}\" data-title=\"{{title}}\" title=\"Click to view and post comments\">0 Comments</span>    {{/comments_allowed}}    <div class=\"article-shortlink\">      <span class=\"article-shortlink-input time-icons time-icons-link shortlink\"></span>      <input type=\"text\" id=\"article-shortlink-{{id}}\" data-event=\"short link\" value=\"{{{shortlink}}}\">    </div>  </div>  {{#comments_allowed}}    <section class=\"livefyre-comment\" id=\"livefyre-{{id}}\"></section>  {{/comments_allowed}}</footer>",
  "article-header": "<header class=\"article-header\">  <section class=\"tags\">    {{#section}}    <a class=\"section-tag\" itemprop=\"articleSection\" href=\"{{url}}\" data-event=\"section-{{slug}}\">{{{name}}}</a>    {{/section}}    {{#tag}}    <a class=\"topic-tag\" itemprop=\"articleSection\" href=\"{{url}}\" data-event=\"tag-{{slug}}\">{{{name}}}</a>    {{/tag}}  </section>  <h1 class=\"article-title\" itemprop=\"headline\">{{{title}}}</h1>  {{>article-meta}}</header>",
  "article-meta": "<div class=\"article-sub-headline\">  <div class=\"article-meta\">    <ul class=\"article-authors\">    {{#authors}}      <li class=\"article-author\">        <span class=\"byline\">{{#url}}<a itemprop=\"author\" href=\"{{url}}\">{{/url}}{{name}}{{#url}}</a>{{/url}}</span>        {{#twitter}}<a class=\"author-twitter\" target=\"_blank\" href=\"https://twitter.com/{{twitter}}\">@{{twitter}}</a>{{/twitter}}      </li>    {{/authors}}    </ul>    <time class=\"publish-date\" itemprop=\"datePublished\" datetime=\"{{time.published}}\" pubdate>{{time.pretty}}</time>    {{#edit_link}}<a href=\"{{{edit_link}}}\" target=\"_blank\" class=\"edit-link time-icons time-icons-edit\"></a>{{/edit_link}}  </div>  <div class=\"social-links\">    <a class=\"time-icons time-icons-share expand-share\" href=\"javascript:void 0;\" title=\"Click to view article share options\"></a>    {{>article-share-buttons}}  </div></div>",
  "article-share-buttons": "<span class=\"social-links-tooltip\">  <a class=\"time-icons time-icons-mail\" href=\"mailto:?subject={{{email_title}}}&body={{{email_body}}}\" data-event=\"email\" title=\"Click to Email this article\"></a>  <a class=\"time-icons time-icons-tw popup\" href=\"#\" data-href=\"https://twitter.com/intent/tweet?url={{{encoded_shortlink}}}&text={{{twitter_text}}}&via={{twitter_via}}\" data-event=\"tweet\" title=\"Click to Tweet this article\"></a>  <a class=\"time-icons time-icons-fb popup\" href=\"https://www.facebook.com/sharer/sharer.php?u={{{encoded_url}}}\" data-event=\"fb-share\" title=\"Click to post this article to Facebook\"></a>  <a class=\"time-icons time-icons-gplus popup\" href=\"https://plus.google.com/share?url={{{encoded_url}}}\" data-event=\"google+\" title=\"Click to post this article to Google+\"></a>  <a class=\"time-icons time-icons-reddit popup\" href=\"http://reddit.com/submit?url={{{encoded_url}}}&title={{{encoded_title}}}\" data-event=\"reddit\" title=\"Click to post this article to Reddit\"></a>  {{#reprint_url}}<a class=\"time-icons time-icons-reprints\" href=\"{{reprint_url}}\" data-event=\"reprints\" title=\"Click to order a reprint of this article\"></a>{{/reprint_url}}</span>",
  "gallery-share-buttons": "<div class=\"gallery-buttons\">  <button class=\"gallery-restart\">Replay</button>  <button class=\"gallery-share time-icons time-icons-share expand-share\" title=\"Click to view gallery share options\" data-event=\"exp-micro\">Share</button>  <span class=\"social-links-tooltip\"><a class=\"time-icons time-icons-mail\" href=\"mailto:?subject={{{email_title}}}&body={{{email_body}}}\" data-event=\"email-micro\" title=\"Click to Email this article\"></a><a class=\"time-icons time-icons-tw popup\" href=\"#\" data-href=\"https://twitter.com/intent/tweet?url={{{encoded_shortlink}}}&text={{{twitter_text}}}&via={{twitter_via}}\" data-event=\"twitter-micro\" title=\"Click to Tweet this article\"></a><a class=\"time-icons time-icons-fb popup\" href=\"https://www.facebook.com/sharer/sharer.php?u={{{encoded_url}}}\" data-event=\"fb-micro\" title=\"Click to post this article to Facebook\"></a><a class=\"time-icons time-icons-gplus popup\" href=\"https://plus.google.com/share?url={{{encoded_url}}}\" data-event=\"google+-micro\" title=\"Click to post this article to Google+\"></a><a class=\"time-icons time-icons-reddit popup\" href=\"http://reddit.com/submit?url={{{encoded_url}}}&title={{{encoded_title}}}\" data-event=\"reddit-micro\" title=\"Click to post this article to Reddit\"></a></span>  {{#fullscreen}}  <button class=\"gallery-toggle-fullscreen time-icons time-icons-fullscreen\" title=\"Click to view the gallery full screen\">Fullscreen</button>  {{/fullscreen}}</div>"
};
!function(a){Time.component.Dropdown=function(){function b(b,c){var d=this;return this.$el=a(b),this.opts=a.extend(!0,{},this.opts,c),this.$el.on("click.dropdown-"+this.opts.classToAdd,function(a){return d.toggle(a)}),this}var c;return b.prototype.opts={parentSelector:"body",classToAdd:"show-nav",menuSelector:".main-nav",handleClickOutside:!0},b.isShowing=!1,c=a("html"),b.prototype.show=function(b){return b&&b.preventDefault(),a(this.opts.parentSelector).addClass(this.opts.classToAdd),this.isShowing=!0,this.opts.handleClickOutside&&this.bindClose(b),a(this.opts.menuSelector).trigger("shown"),this.$el},b.prototype.hide=function(b){return b&&b.preventDefault(),a(this.opts.parentSelector).removeClass(this.opts.classToAdd),a(this.opts.menuSelector).trigger("hidden"),this.isShowing=!1,this.$el},b.prototype.bindClose=function(b){var c=this;return a("html").on("click.dropdown-"+this.opts.classToAdd,function(){var d,e,f;return d=a(b.target||window.event.srcElement),e=!d.is(c.opts.menuSelector),f=0===a(c.opts.menuSelector).has(d).length,e&&f?(a("html").off(".dropdown-"+c.opts.classToAdd),c.hide()):void 0}),this},b.prototype.toggle=function(a){return a&&a.preventDefault(),this.isShowing?(this.$el.trigger("clicked-close"),this.hide(a)):(this.$el.trigger("clicked-open"),this.show(a))},b.prototype.destroy=function(){return this.$el.off("dropdown-"+this.opts.classToAdd),a.removeData(this.$el,"Dropdown Navigation MobileNavigation"),a("html").off("dropdown-"+this.opts.classToAdd)},b}(),Time.component.Gallery=function(){function b(){}return b.prototype.init=function(b){var c;return this.curr_index=b?b:0,this.max_index=this.$items.length-1,this.$counter_total&&this.setCounterTotal(),c=this,Modernizr.touch&&(this.$el.touchwipe({wipeLeft:a.proxy(c.advance,c),wipeRight:a.proxy(c.recede,c),min_move_x:6,min_move_y:6,preventDefaultEvents:!1}),this.$el.click(c.advance,c)),this.recalculate_gallery(!0),this.trigger("gallery:init"),setTimeout(function(){return srcset()},2e3)},b.prototype.auto_play=function(a){var b=this;return null==a&&(a=500),this.timerID&&clearTimeout(this.timerID),this.timerID=setTimeout(function(){return b.advance()},a)},b.prototype.advance=function(a){a&&a.preventDefault(),this.curr_index++,this.curr_index>this.max_index?this.circular?(this.curr_index=0,this.recalculate_gallery()):this.handle_end():this.recalculate_gallery()},b.prototype.recede=function(a){a&&a.preventDefault(),this.curr_index--,this.curr_index<0?this.circular?(this.curr_index=this.max_index,this.recalculate_gallery()):this.handle_beginning():this.recalculate_gallery()},b.prototype.goto_index=function(a){return this.curr_index=a,this.recalculate_gallery()},b.prototype.goto_start=function(){return this.goto_index(0)},b.prototype.goto_end=function(){return this.goto_index(this.max_index)},b.prototype.handle_end=function(){return this.trigger("gallery:max_limit"),this.goto_end()},b.prototype.handle_beginning=function(){return this.trigger("gallery:min_limit"),this.goto_start()},b.prototype.recalculate_gallery=function(a){var b,c,d,e,f,g,h,i,j;for(i=this.$items,c=e=0,g=i.length;g>e;c=++e)b=i[c],c<this.curr_index&&b.addClass("passed").removeClass("current upcoming"),c===this.curr_index&&b.addClass("current").removeClass("passed upcoming").trigger("isCurrent"),c>this.curr_index&&b.addClass("upcoming").removeClass("passed current");if(a)for(j=this.$items,c=f=0,h=j.length;h>f;c=++f)d=j[c],this.handle_scaling(c);return this.trigger("gallery:recalc",this),this.curr_index===this.max_index?this.trigger("gallery:last"):void 0},b.prototype.getCurrentItem=function(){return this.$items[this.curr_index]},b.prototype.getCurrentIndex=function(){return this.curr_index},b.prototype.setCounterTotal=function(a){return this.$counter_total.text(a?a+1:this.max_index+1)},b.prototype.setCounterCurrent=function(a){return this.$counter_current.text(a?a+1:this.curr_index+1)},b}();var b=function(a,b){return function(){return a.apply(b,arguments)}};Time.component.InfiniteScroll=function(){function a(a,c,d,e,f,g){var h=this;null==g&&(g=window),this.on_scroll=b(this.on_scroll,this),this.$viewport=a,this.$content=c,this.threshold=d,this.down_callback=e,this.context=g,this.position=a.scrollTop(),null!=f&&(this.up_callback=f),_.defer(function(){return h.bind()})}return a.prototype.bind=function(){return this.$viewport.off("scroll.infinite_scroll"),this.$viewport.on("scroll.infinite_scroll",this.on_scroll)},a.prototype.unbind=function(){return this.$viewport.off("scroll.infinite_scroll")},a.prototype.on_scroll=function(){return"undefined"!=typeof throttle_timeout&&null!==throttle_timeout&&clearTimeout(throttle_timeout),this.handle_scroll()},a.prototype.handle_scroll=_.debounce(function(){return!this.paused&&this.$viewport.scrollTop()<=this.threshold&&this.up_callback&&this.position>this.$viewport.scrollTop()?this.up_callback.call(this.context):!this.paused&&this.$viewport.height()+this.$viewport.scrollTop()+this.threshold>=this.$content.height()&&this.down_callback.call(this.context),null!=this.throttle_timeout&&clearTimeout(this.throttle_timeout),this.position=this.$viewport.scrollTop(),this.position},50),a.prototype.pause=function(){return this.paused=!0},a.prototype.resume=function(){return this.paused=!1},a}();var c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Time.component.MobileNavigation=function(b){function c(){var b,d,e,f=this;b=a(document),e=0,d=a(".main-header"),c.__super__.constructor.apply(this,arguments),a(this.opts.menuSelector).on("shown",function(){var a,c,f;return e=b.scrollTop(),a=d.outerHeight(),c=Time.util.getHeight(),f=Time.util.getWidth()}),a(this.opts.menuSelector).on("hidden",function(){return Modernizr.touch&&b.scrollTop(e),Time.util.enable_scrolling(),a(f.opts.menuSelector).removeProp("style")}),a(this.opts.parentSelector).find(".main-nav-section").on("click",function(){return f.hide()}),a(".tertiary-nav-special a").on("click",function(){return f.hide()})}return d(c,b),c}(Time.component.Dropdown);var c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Time.component.Navigation=function(b){function c(){var b,d=this;c.__super__.constructor.apply(this,arguments),b=!1,this.$el.on("clicked-open",function(){return b=a(".rail-articles-scroll").scrollTop()}),a(this.opts.menuSelector).on("hidden",function(){return _.defer(function(){return a(".rail-articles-scroll").scrollTop(b)}),Time.Ad.update_left_rail_all_el_pos()}),a(this.opts.parentSelector).find(".main-nav-section").on("click",function(){return d.hide()}),a(".tertiary-nav-special a").on("click",function(){return d.hide()})}return d(c,b),c}(Time.component.Dropdown);var e,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Time.component.RailSearch=function(b){function c(){return e=c.__super__.constructor.apply(this,arguments)}return d(c,b),c.prototype.opts={parentSelector:"body",classToAdd:"show-search",menuSelector:".tabs-inner",handleClickOutside:!0,formSelector:".search-form",fieldSelector:".search-field"},c.prototype.toggle=function(a){return a&&a.preventDefault(),this.isShowing?(this.handleEnter(),this.exitSearch(a)):this.enterSearch(a)},c.prototype.enterSearch=function(b){var c=this;return this.show(b),a(".search-field").focus(),a("body").on("keydown.rail-search-"+this.opts.classToAdd,function(a){return c.handleKeydown(a)})},c.prototype.handleKeydown=function(a){var b;return b=a.which||a.keyCode,this.isEnter(b)?this.handleEnter():this.isESC(b)?this.exitSearch():void 0},c.prototype.handleEnter=function(){var b;return b=a(this.opts.fieldSelector).val(),b.length&&!/\s+/.test(b)?a(this.opts.formSelector).submit():void 0},c.prototype.exitSearch=function(b){return a("body").off("keydown.rail-search-"+this.opts.classToAdd),this.hide(b)},c.prototype.isEnter=function(a){return 13===parseInt(a)?!0:!1},c.prototype.isESC=function(a){return 27===parseInt(a)?!0:!1},c}(Time.component.Dropdown),Time.util={getWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||screen.width},getHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||screen.height},disable_scrolling:function(){return a("body").attr("style","overflow: hidden; position: fixed;")},enable_scrolling:function(){return a("body").css({overflow:"",position:""})},is_android_lte_23:function(){var a,b,c,d,e;if(c=navigator.userAgent.match(/Android ([0-9]+)/),null==c||!c.length)return!1;for(a=d=0,e=c.length;e>d;a=++d)if(b=c[a],3.1>=parseFloat(b.replace("Android ","")))return!0;return!1},getDayOfYear:function(){var a,b;return b=new Date,a=new Date(b.getFullYear(),0,1),Math.round((b-a)/1e3/60/60/24+.5,0)},waitFor:function(a,b,c,d,e){return null==c&&(c=!1),null==d&&(d=500),null==e&&(e=12),0===e?!1:(e-=1,setTimeout(function(){return typeof a===b?c():Time.util.waitFor(a,b,c,d,e)},d))}},Time.component.make=function(b,c,d){return a(c).each(function(){var e;return a.data(this,b)?void 0:(e=new Time.component[b](c,d),a.data(this,b,e))})},Time.log=function(a,b,c){return null==b&&(b=!1),null==c&&(c="log"),Time.developer_mode&&"undefined"!=typeof console&&null!==console&&(null!=Time.active_log_namespaces&&b&&-1!==Time.active_log_namespaces.indexOf(b)||!b&&!Time.active_log_namespaces)?console[c](a):!1},Time.component.Modal=function(){function b(b,c){this.opts=a.extend(!0,{},this.defaults,c),this.$el=a(b),this.bind()}return b.prototype.defaults={closeSelector:".close-button",buttonSelector:".modal-button",interiorSelector:".modal",classToShow:"active",isShowing:!1,handleResize:!1,$html:a("html")},b.prototype.bind=function(){var a=this;return this.opts.$html.delegate(this.opts.buttonSelector,{"click.smart-modal":function(b){return a.show(b)}})},b.prototype.show=function(b){var c;return b&&b.preventDefault(),this.opts.isShowing?this.$el:(c=a.extend(!0,b,{type:"shown"}),this.isShowing=!0,this.opts.$html.css("overflow","hidden"),this.bindClose(),this.$el.addClass(this.opts.classToShow).trigger(c))},b.prototype.hide=function(a){return a&&a.preventDefault(),this.opts.isShowing=!1,this.unbindClose(),this.opts.$html.css("overflow","visible"),this.$el.removeClass(this.opts.classToShow).trigger("hidden")},b.prototype.bindClose=function(){var b=this;return this.opts.$html.on({"click.smart-modal-close":function(c){var d,e,f;return d=a(c.target||event.sourceElement),e=d.is(b.opts.closeSelector||a(b.opts.closeSelector).has(d).length>0),f=!a(b.opts.interiorSelector).has(d).length>0&&!a(b.opts.interiorSelector).is(d),f||e?(c.preventDefault(),b.hide()):void 0}})},b.prototype.unbindClose=function(){return this.opts.$html.off(".smart-modal-close")},b.prototype.destroy=function(){return this.opts.$html.off(".smart-modal .smart-modal-close"),this.$el.off(".smart-modal").removeData(".smart-modal")},b}(),Time.models.Article=Backbone.Model.extend({initialize:function(){return this.views={},null!=this.collection?this.listenTo(this.collection,"flush",this.unset_active):void 0},url:function(){return Time.api_url+"post/"+this.get("id")+"/"},fetch:function(a){var b,c,d,e=this;return null==a&&(a={}),this.syncing?void 0:((null==a.cache||a.cache)&&(a.cache=!0),this.trigger("sync:syncing"),this.syncing=!0,a.dataType="json",d=a.success,a.success=function(b,c,f){return"object"!=typeof c?(e.trigger("sync:error"),a.error(b,c,f),!1):(e.trigger("sync:success"),null!=d?d(b,c,f):void 0)},b=a.complete,a.complete=function(a,c,d){return e.trigger("sync:complete"),e.syncing=!1,null!=b?b(a,c,d):void 0},c=a.error,a.error=function(a,b,d){return e.trigger("sync:error"),c?c(a,b,d):void 0},Backbone.Collection.prototype.fetch.call(this,a))},create_tile_view:function(){return this.views.tile_view="magazine"===this.collection.active_env?new Time.views.ArticleMagazineTile({model:this}):new Time.views.ArticleTile({model:this})},create_single_view:function(){return this.views.single_view=new Time.views.ArticleSingle({model:this}),this.views.single_view},has_single_view:function(){return null!=this.views.single_view},has_tile_view:function(){return null!=this.views.tile_view},is_in_content_well:function(){return Time.application.$viewport.find(".full-article[data-article='"+this.id+"']").length},navigate_to:function(){var a;a=Time.application.sanitize_url(this.get("url")),Time.application.router.navigate(a,!1),Time.taboola_counter++;try{render_taboola_modules()}catch(b){}return Time.Tracking.article_view(this.attributes)},set_active:function(){this.is_active||(this.trigger("activate"),this.is_active=!0,null!=this.collection?(this.collection.set_active_article(this),this.collection.freeze_url||this.collection.freeze_url_once?this.collection.freeze_url_once=!1:this.navigate_to()):this.navigate_to(),Time.application.set_title(this.attributes.title),this.render_ad())},unset_active:function(){return this.is_active?(this.trigger("deactivate"),this.is_active=!1):void 0},render_ad:function(){Time.Ad.activate_ads(this)}}),Time.models.Divider=Backbone.Model.extend({initialize:function(a){if(this.index=Time.models.Divider.index++,null!=a.article&&(this.article=a.article),this.listenTo(this,"divider:render",function(){this.view.$el.insertAfter(this.article.views.single_view.$el)}),null==Time.application.active_rail||"videos"!==Time.application.active_rail.active_env&&"mobile"!==Time.device)switch(this.index%3){case 0:this.init_advert();break;case 1:this.init_taboola();break;case 2:this.init_articles()}else this.init_advert();return this},init_advert:function(){return this.set("type","advert"),this.view=new Time.views.DividerAdvert({model:this})},init_articles:function(){return this.set("type","articles"),null!=Time.bootstrap.dividers&&(this.set("articles_html",Time.bootstrap.dividers[Time.models.Divider.bootstrap_index]),Time.models.Divider.bootstrap_index++,Time.models.Divider.bootstrap_index>=Time.bootstrap.dividers.length&&(Time.models.Divider.bootstrap_index=0)),this.view=new Time.views.DividerArticles({model:this})},init_taboola:function(){return this.set("type","taboola"),this.view=new Time.views.DividerTaboola({model:this})}}),Time.models.Divider.index=0,Time.models.Divider.bootstrap_index=0,Time.models.GalleryModule=Backbone.Model.extend({base_url:"/api/gallery/",initialize:function(){var a=this;return this.syncing=!1,_.bindAll(this,"url"),null!=this.collection?this.listenTo(this.collection.article_view,"article:rendered",function(){return a.get("is_primary")?void 0:a.create_view(!0)}):void 0},create_view:function(a){var b=this;return this.view=new Time.views.GalleryModule({model:this}),a&&this.view.render(),this.listenTo(this.view,"gallery:last",function(){return b.get("next_gallery_id")&&null!=b.collection?b.collection.preload_gallery_data(b.get("next_gallery_id")):void 0}),this.listenTo(this.view,"gallery:max_limit",function(){return b.get("next_gallery_id")?b.collection.replace_gallery(b.id,b.get("next_gallery_id")):void 0}),this.listenTo(this.view,"gallery:min_limit",function(){return b.get("previous_gallery_id")?b.collection.replace_gallery(b.id,b.get("previous_gallery_id"),!0):void 0}),this.view},url:function(){return this.base_url+this.id+"/"},parse:function(a){return a.gallery},destroy_view:function(){return null!=this.view?(this.view.destroy(),this.view.length=0,this.view=null):void 0},fetch:function(a){var b,c,d=this;return null==a&&(a={}),b=a.complete,c=a.success,null!=this.collection.get_from_cache(this.id)&&this.collection.get_from_cache(this.id).has_data?(this.set(this.collection.get_from_cache(this.id)),null!=b&&b.call(this),null!=c&&c.call(this),this.trigger("sync:success")):this.syncing?void 0:(this.trigger("sync:syncing"),this.syncing=!0,a.dataType="json",a.complete=function(a){return d.trigger("sync:complete"),d.syncing=!1,null!=b?b.call(model,a,options):void 0},a.success=function(b,e,f){return typeof e===!1?(d.trigger("sync:error"),a.error(b,e,f),!1):(d.trigger("sync:success"),null==e.error&&(d.set("has_data",!0),null!=c)?c.call(b,e,f):void 0)},Backbone.Collection.prototype.fetch.call(this,a))},has_data:function(){return null!=this.get("has_data")&&this.get("has_data")}}),Time.models.GallerySlide=Backbone.Model.extend({initialize:function(a){return null!=a.gallery_view&&(this.gallery_view=a.gallery_view),this.view="related"===a.view?new Time.views.GalleryRelated({model:this}):new Time.views.GallerySlide({model:this}),this}}),Time.models.TickerHeadline=Time.models.Article.extend({initialize:function(){return this.view=new Time.views.TickerHeadline({model:this})}}),Time.collections.Rail=Backbone.Collection.extend({model:Time.models.Article,syncing:!1,page:1,endpoint:"latest",active_env:"trending",real_article_index:0,sponsored_article_index:0,sponsored_article_cycles:0,ad_in_left_rail:0,freeze_url:!1,freeze_url_once:!1,initialize:function(){var a,b=this;return a=!1,Time.application.first_article=!1,Time.application.load_ticker(),this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenTo(this,"add",function(c){return"number"==typeof a&&clearTimeout(a),a=setTimeout(function(){return b.trigger("tiles-rendered")},1e3),b.real_article_index++,c.create_tile_view(),0===b.real_article_index%10&&null!=Time.bootstrap.sponsors?b.add_sponsored_article():void 0}),this},prioritize_articles:function(a){var b,c,d,e;if(c={},d=function(a,b){var c;return c=_.find(a,function(a){return a.id===parseInt(b,10)}),c?a=Time.application.filter(a,parseInt(b,10)):c=Time.application.temp_article?Time.application.temp_article.attributes:!1,c&&a.unshift(c),Time.application.first_article=b,a},null==a)return e=Time.bootstrap.latest.articles,c=d(e,Time.bootstrap.single_article.id),Time.bootstrap.latest.articles=c,Time.bootstrap.latest.articles;if(null!=a.articles&&a.articles.length>0)if(e=a.articles,Time.application.first_article)a.articles=Time.application.filter(a.articles,Time.application.first_article);else{if(b=Backbone.history.fragment,b=b.substring(0,b.indexOf("/")),isNaN(b))return a;c=d(e,b),a.articles=c}return a},load_articles:function(){return null!=Time.bootstrap.latest&&null!=Time.bootstrap.latest.articles?this.add(this.prioritize_articles()):Time.application.railXHR=this.fetch()},load_section_header:function(b){var c;return null!=b.menu&&b.menu.items.length>0?(c=Mustache.to_html(Time.templates["section-menu"],b),a(".topic-banner").html(c)):void 0},url:function(){var a;return a=Time.api_url+this.endpoint+"/",this.page>1&&(a+="page/"+this.page+"/"),a},fetch:function(a){var b,c,d,e=this;return null==a&&(a={}),this.syncing?void 0:((null==a.cache||a.cache)&&(a.cache=!0),this.trigger("sync:syncing"),this.syncing=!0,a.dataType="json",a.next_page&&this.page++,b=a.complete,a.complete=function(a,c,d){return e.syncing=!1,e.trigger("sync:complete"),null!=b?b(a,c,d):void 0},d=a.success,a.success=function(b,c,f){var g,h;return"object"!=typeof c?(e.trigger("sync:error"),a.error(b,c,f),!1):(e.trigger("sync:success"),null!=d&&d(b,c,f),g=null!=c.articles&&c.articles.length<Time.posts_per_page,h=null!=c.read&&c.read.length>0||null!=c.shared&&c.shared.length>0,c.error||c.articles===!1||g||h?e.reached_page_limit():void 0)},c=a.error,a.error=function(a,b){return e.reached_ceiling=!0,e.trigger("sync:error"),null!=c?c(a,b,options):void 0},Backbone.Collection.prototype.fetch.call(this,a))},load_single_article:function(a,b){var c,d=this;return null!=this.get(a)?this.synchronize(a,b):(c=new Time.models.Article({id:a}),c.create_single_view(),this.listenToOnce(c,"change:title",function(){return d.set_visible_article(c),c.set_active(),d.listenToOnce(c,"article:rendered",function(){return d.listenToOnce(d,"viewport_filled",function(){return null!=b?(d.freeze_url_once=!0,c.views.single_view.jump_to_item(b)):Time.application.reset_scroll()}),d.fill_viewport()}),c.views.single_view.render()}),null!=Time.application.temp_article&&Time.application.temp_article.get("id")===a?c.set(Time.application.temp_article.attributes):null!=Time.bootstrap.single_article&&a===Time.bootstrap.single_article.id?c.set(Time.bootstrap.single_article):c.fetch()),c},parse:function(a){return a=this.prioritize_articles(a),a.articles&&"videos"===this.active_env&&_.each(a.articles,function(a){return null!=a.hero?a.display_hero=!0:void 0}),a.articles},set_active_article:function(a){return this.active_article=a},get_active_article:function(){return this.get(this.active_article)},set_visible_article:function(a){return this.visible_article=a},get_visible_article:function(){return this.get(this.visible_article)},get_previous_article:function(){var a;return a=this.at(this.indexOf(this.get_active_article())-1),void 0!==a?a:!1},get_next_article:function(){var a;return a=this.at(this.indexOf(this.get_visible_article())+1),void 0!==a?a:!1},show_previous_article:function(){var a;return a=this.get_previous_article(),a&&!a.is_in_content_well()?(a.has_single_view()||a.create_single_view(),a.views.single_view.render({method:"prepend"})):void 0},show_next_article:function(){var a;return a=this.get_next_article(),a?(a.is_in_content_well()||(a.has_single_view()||a.create_single_view(),a.views.single_view.render({method:"append"})),this.set_visible_article(a)):this.fetch_next_page()},fetch_next_page:function(){return this.reached_ceiling?void 0:this.fetch({next_page:!0,remove:!1})},reached_page_limit:function(){return this.reached_ceiling=!0,this.view.scroll_limit_message()},synchronize:function(a,b){var c,d,e=this;return null==a&&(a=this.at(0).id),d=this,this.trigger("flush"),c=this.get(a),this.listenToOnce(c,"article:rendered",function(){e.set_visible_article(c),null!=b?(e.freeze_url_once=!0,"gallery"===c.attributes.format?Time.initial_gallery_slug=b:c.views.single_view.jump_to_item(b)):Time.application.reset_scroll(),c.set_active(),Time.application.is_homepage||window.setTimeout(function(){d.fill_viewport()},0)}),null==c.views.single_view&&c.create_single_view(),c.views.single_view.render(),c.views.single_view.$el.removeClass("offScreen"),Time.application.arr_article_views.push(c.views.single_view)},fill_viewport:function(){!this.reached_ceiling&&Time.application.$viewport.get(0).scrollHeight<=Time.application.$window.height()-Time.application.$main_header.height()&&this.show_next_article(),this.trigger("viewport_filled")},add_sponsored_article:function(){var a,b;if(this.sponsored_article_index+1>Time.bootstrap.sponsors.length&&(this.sponsored_article_index=0,this.sponsored_article_cycles++),null==Time.bootstrap.sponsors[this.sponsored_article_index])return!1;this.rail_index=this.real_article_index+this.sponsored_article_index+Time.bootstrap.sponsors.length*this.sponsored_article_cycles,Time.bootstrap.sponsors[this.sponsored_article_index].id=parseInt(this.sponsored_article_cycles.toString()+Time.bootstrap.sponsors[this.sponsored_article_index].id.toString()),this.add(Time.bootstrap.sponsors[this.sponsored_article_index],{silent:!0,at:this.rail_index}),b=this.at(this.rail_index);try{return b.create_tile_view(),this.sponsored_article_index++,this.trigger("rail:added_sponsored_article")}catch(c){a=c}},load_tabs:function(a){var b,c;return c=Time.tab_data["default"],b="/"+this.active_env+"/"+this.sub+"/",c.tabs[0]={label:a,omniture:"nav-"+this.sub,env:this.active_env,sub:this.sub,href:b},Time.application.load_tabs(c),Time.application.tabs_view.set_active(0)}}),Time.collections.ArticleGalleries=Backbone.Collection.extend({model:Time.models.GalleryModule,cache:{},initialize:function(){return this.listenTo(this,"add, change",function(a){return this.add_to_cache(a.attributes,a.id)})},delete_gallery:function(a){return null!=this.get(a)&&(this.get(a).destroy_view(),this.remove(a)),this.models},replace_gallery:function(a,b,c,d){var e;return null==c&&(c=!1),e=this.get(a).view.$el,Time.application.show_loader(e),this.article_view.$(".gallery-wrapper[data-gallery="+a+"]").attr("data-gallery",b).data("gallery",b),this.delete_gallery(a),null==this.get(b)&&this.add({id:b}),c||(this.get(b).set("previous_gallery_id",a),null!=d&&this.get(b).set("previous_gallery_fullscreen",d)),this.listenTo(this.get(b),"sync:success",function(){var a;return Time.application.hide_loader(e),a=this.get(b).create_view(!0),c?(this.listenTo(a,"gallery:init",function(){return a.goto_end()}),a.trigger("gallery:rendered")):void 0}),this.get(b).has_data()||this.get(b).syncing?this.get(b).has_data()&&this.get(b).trigger("sync:success"):this.get(b).fetch(),this.get(b)},preload_gallery_data:function(a){return null==this.get(a)?(this.add({id:a}),this.get(a).fetch()):void 0},add_to_cache:function(a,b){return null==b&&(b=null),null==b&&(b=a.id),null==this.cache[b]&&(this.cache[b]=a),this.cache},get_from_cache:function(a){return null!=this.cache[a]?this.cache[a]:null}}),Time.collections.Author=Time.collections.Rail.extend({active_env:"author",endpoint:"author",initialize:function(a,b){var c,d=this;return c=!1,this.freeze_url_once=!0,this.sub=b.sub,this.endpoint+="/"+this.sub,this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)}),this.listenTo(this,"add",function(a){return"number"==typeof c&&clearTimeout(c),c=setTimeout(function(){return d.trigger("tiles-rendered")},1e3),d.real_article_index++,a.create_tile_view(),0===d.real_article_index%10&&null!=Time.bootstrap.sponsors?d.add_sponsored_article():void 0}),this},load_articles:function(){var a=this;return null!=Time.bootstrap.author&&null!=Time.bootstrap.author[this.sub]?(Time.application.render_top_banner(Time.bootstrap.author[this.sub].author),this.add(Time.bootstrap.author[this.sub].articles),this.view.render_author_header(Time.bootstrap.author[this.sub].author)):this.fetch({success:function(b,c){return Time.application.render_top_banner(c.author),a.view.render_author_header(c.author)}})}}),Time.collections.GallerySlides=Backbone.Collection.extend({model:Time.models.GallerySlide});var e,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Time.collections.Magazine=function(b){function c(){return e=c.__super__.constructor.apply(this,arguments)}return d(c,b),c.prototype.active_env="magazine",c.prototype.endpoint="magazine",c.prototype.initialize=function(b,c){var d,e,f=this;return d=!1,this.freeze_url_once=!0,Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.region=null!=c.sub?c.sub:"us",this.endpoint+=null!=Time.curRoute.magazine_id?"/issue/"+Time.curRoute.magazine_id:"/region/"+this.region,a(".top-banner").html(""),e=a("[data-region='"+this.region+"']").html(),a(".toggle-magazine-region-dropdown").html(e),Time.application.$body.addClass("has-section-menu"),this.view=new Time.views.Rail({collection:this}),this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)}),this.listenTo(this,"add",function(a){return"number"==typeof d&&clearTimeout(d),d=setTimeout(function(){return f.trigger("tiles-rendered")},1e3),f.real_article_index++,a.create_tile_view()}),this},c.prototype.load_articles=function(){return null!=Time.bootstrap.magazine&&Time.bootstrap.magazine[this.region]?this.add(this.parse(Time.bootstrap.magazine[this.region])):this.fetch(),this},c.prototype.parse=function(a){var b,c,d;if(b=a.articles,null!=b&&b.length){b[0].cover=1,b[0].magazine={};for(c in a)d=a[c],"articles"!==c&&(b[0].magazine[c]=d)}return b},c}(Time.collections.Rail),Time.collections.Popular=Time.collections.Rail.extend({active_env:"popular",endpoint:"popular",initialize:function(){var a,b=this;return this.freeze_url_once=!0,a=!1,Time.application.load_ticker(),this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)}),this.listenTo(this,"add",function(c){return"number"==typeof a&&clearTimeout(a),a=setTimeout(function(){return b.trigger("tiles-rendered")},1e3),b.real_article_index++,c.create_tile_view()}),Time.application.tabs_view.set_active("popular"),this},load_articles:function(){var a;return a=this,Time.application.railXHR=this.fetch({success:function(b,c){return a.view.render_header("10 Most Read"),_.each(c.read,function(b,c){return b.id=parseInt(b.id.toString()+c),b.url=b.url.replace(/\d+/,b.id),a.add(new Time.models.Article(b))}),a.view.render_header("10 Most Shared"),_.each(c.read,function(b,c){return b.id=parseInt(b.id.toString()+2*c),b.url=b.url.replace(/\d+/,b.id),a.add(new Time.models.Article(b))})}})}}),Time.collections.Section=Time.collections.Rail.extend({active_env:"section",endpoint:"section",initialize:function(b,c){var d,e=this;return d=!1,this.freeze_url_once=!0,a("body").addClass("tax-time_section"),this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.sub=c.sub,this.endpoint+="/"+this.sub,this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)}),this.listenTo(this,"add",function(a){return"number"==typeof d&&clearTimeout(d),d=setTimeout(function(){return e.trigger("tiles-rendered")},1e3),e.real_article_index++,a.create_tile_view(),0===e.real_article_index%10&&null!=Time.bootstrap.sponsors?e.add_sponsored_article():void 0}),this},load_articles:function(){var a=this;return null!=Time.bootstrap.section&&null!=Time.bootstrap.section[this.sub]?(null!=Time.bootstrap.section[this.sub].articles&&this.add(Time.bootstrap.section[this.sub].articles),Time.application.render_section_header(Time.bootstrap.section[this.sub]),this.listenToOnce(Time.application,"load_section_menu",function(){return Time.application.active_rail.load_section_header(Time.bootstrap.section[a.sub])}),this.load_tabs(this.sub,".rail-tabs")):this.fetch({success:function(b,c){return Time.application.render_section_header(c),a.listenToOnce(Time.application,"load_section_menu",function(){return Time.application.active_rail.load_section_header(c)})}})},load_tabs:function(a,b){var c,d;return d=Time.tab_data["default"],c="/"+this.sub+"/",d.tabs[0]={label:a,omniture:"nav-"+this.sub,env:this.active_env,sub:this.sub,href:c},Time.application.load_tabs(d,b),Time.application.tabs_view.set_active(0)}}),Time.collections.Sponsor=Time.collections.Rail.extend({active_env:"sponsor",endpoint:"/sponsor",initialize:function(a,b){var c,d=this;return c=0,this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)}),this.listenTo(this,"add",function(a){return"number"==typeof c&&clearTimeout(c),c=setTimeout(function(){return d.trigger("tiles-rendered")},1e3),d.real_article_index++,a.create_tile_view(),0===d.real_article_index%10&&null!=Time.bootstrap.sponsors?d.add_sponsored_article():void 0}),this.sponsor=b.sub,this.endpoint+="/"+this.sponsor,this},load_articles:function(){return null==Time.bootstrap.sponsor||null==Time.bootstrap.sponsor[this.slug]?this.fetch():null!=Time.bootstrap.sponsor[this.slug].articles?this.add(Time.bootstrap.sponsor[this.slug].articles):void 0}}),Time.collections.Tag=Time.collections.Rail.extend({active_env:"tag",endpoint:"tag",initialize:function(a,b){var c,d=this;return this.freeze_url_once=!0,c=!1,this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)
}),this.listenToOnce(this,"add reset",function(){var a=this;return"number"==typeof c&&clearTimeout(c),c=setTimeout(function(){return a.trigger("tiles-rendered")},1e3)}),this.sub=b.sub,this.endpoint+="/"+this.sub,this.listenTo(this,"add",function(a){return d.real_article_index++,a.create_tile_view(),0===d.real_article_index%10&&null!=Time.bootstrap.sponsors?d.add_sponsored_article():void 0}),this},load_articles:function(){var a=this;return null!=Time.bootstrap.tag&&null!=Time.bootstrap.tag[this.sub]?(null!=Time.bootstrap.tag[this.sub].articles&&(this.add(Time.bootstrap.tag[this.sub].articles),Time.bootstrap.tag[this.sub].name&&this.load_tabs(Time.bootstrap.tag[this.sub].name)),Time.application.render_top_banner(Time.bootstrap.tag[this.sub])):this.fetch({success:function(b,c){return Time.application.render_top_banner(c),c.name?a.load_tabs(c.name):void 0}})}}),Time.collections.Ticker=Backbone.Collection.extend({model:Time.models.TickerHeadline,load_headlines:function(){return null!=Time.bootstrap.ticker?(this.add(Time.bootstrap.ticker),this.trigger("reset")):this.fetch({reset:!0})},url:function(){return Time.api_url+"ticker/"},get_$items:function(){var a;return a=[],_.each(this.models,function(b){return a.push(b.view.$el)}),a}}),_.extend(Time.collections.Ticker.prototype,Backbone.Events),Time.collections.Topic=Time.collections.Rail.extend({active_env:"topic",endpoint:"topic",initialize:function(a,b){var c,d=this;return c=!1,this.freeze_url_once=!0,Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenToOnce(this,"article:rendered",function(){var a;return a=Time.application.active_rail.active_article?Time.application.active_rail.active_article.attributes:Time.bootstrap.single_article,Time.Tracking.article_view(a)}),this.view=new Time.views.Rail({collection:this}),this.sub=b.sub,this.endpoint+="/"+this.sub,this.load_tabs("Full Coverage"),this.listenTo(this,"add",function(a){return"number"==typeof c&&clearTimeout(c),c=setTimeout(function(){return d.trigger("tiles-rendered")},1e3),d.real_article_index++,a.create_tile_view(),0===d.real_article_index%10&&null!=Time.bootstrap.sponsors?d.add_sponsored_article():void 0}),this},load_articles:function(){var a=this;return null!=Time.bootstrap.topic&&null!=Time.bootstrap.topic[this.sub]?(null!=Time.bootstrap.topic[this.sub].articles&&this.add(Time.bootstrap.topic[this.sub].articles),this.view.render_topic_header(Time.bootstrap.topic[this.sub]),Time.application.render_top_banner(Time.bootstrap.topic[this.sub])):this.fetch({success:function(b,c){return Time.application.render_top_banner(c),a.view.render_topic_header(c)}})}}),Time.collections.Videos=Time.collections.Rail.extend({active_env:"videos",endpoint:"videos",initialize:function(){var a,b=this;return this.freeze_url_once=!0,a=!1,Time.application.load_ticker(),this.view=new Time.views.Rail({collection:this}),Time.Ad.set_initial_left_rail_load(!0),Time.application.arr_article_views.length=0,this.listenToOnce(this,"article:rendered",function(){return Time.Tracking.article_view(Time.application.active_rail.active_article.attributes)}),window.BCL=window.BCL||{},window.BCL.firstVideoAutoPlayed=!0,window.BCL.playArticleVideoId=null,Time.application.tabs_view.set_active("videos"),this.listenTo(this,"add",function(c){return"number"==typeof a&&clearTimeout(a),a=setTimeout(function(){return b.trigger("tiles-rendered")},1e3),b.real_article_index++,c.create_tile_view()}),this},load_articles:function(){return Time.application.railXHR=this.fetch({complete:function(){}})}}),Time.Ad=new TimeAdFactory,Time.Ad.init(TIME_DFP),Time.initial_gallery_slug=!1,Time.autoplay_video=!1,Backbone.View.prototype.destroy=function(){return this.trigger("view:destroy"),a(this.el).remove(),this.$el.remove(),this.remove(),this.unbind(),this},Time.views.Application=Backbone.View.extend({el:document,events:{"click a":"route","click a.popup":"open_popup","click .rail-tab":"load_tab","click .toggle-magazine-region-dropdown, .magazine-region":"toggle_magazine_region_dropdown","click .ie-message-modal":"hide_ie8_message","click .article-list a":"hide_article_list","click .toggle-comments":"toggle_comments"},title:a("title").text(),title_suffix:" | TIME.com",$window:a(window),$body:a("body"),$main_header:a(".main-header"),$notHeader:a("#notTheHeader"),$notHeaderWrapper:a("#notTheHeader>.wrapper"),$viewport:a(".article-viewport"),$viewportWrapper:a(".article-viewport>.wrapper"),$magazineCover:a(".magazine-cover:first"),$pushDown:a("#pushdown-ad"),$left_rail:a(".left-rail"),$articleListScroll:a(".rail-articles-scroll"),$articleList:a(".article-list"),$tabs:a(".left-rail-topper"),$top_banner:a(".top-banner"),admin_bar:!1,$admin_bar:{},sizes:{},skipNextScroll:!1,mobileSafari:/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase()),userAgent:window.navigator.userAgent,throttleSpeed:100,last_route:"",root:location.protocol+"//"+location.host,arr_article_views:[],article_breakpoint:a(window).height()/4,is_homepage:!1,first_article:!1,breakpoints:{small:{name:"small",size:400,is_beneath:!1},medium:{name:"medium",size:800,is_beneath:!1},large:{name:"large",size:1024,is_beneath:!1}},initialize:function(){var b,c;return a("html").addClass(Time.device),this.$body.hasClass("admin-bar")&&(this.admin_bar=!0,this.$admin_bar=a("#wpadminbar")),Time.$_GET={},document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){var b,c,d;return b=function(a){return decodeURIComponent(a.split("+").join(" "))},Time.$_GET[b(arguments[1])]=b(arguments[2]),Time.$_GET.loginfailure?(d=document.URL.split("?")[0],c=!(!window.history||!history.pushState),c&&window.history.pushState({html:"",pageTitle:""},"",d),a("#Sign_In_Modal_Error").removeClass("hidden"),a(function(){return a(".login-nav-wrapper .sign-in").trigger("click")})):void 0}),b="https://auth.time.com/logout.php",c='<a href="'+b+"?turl="+window.location+'">Sign Out</a>',null!=a.cookie&&null!=a.cookie("TimeIAT")&&a("span.signedin-wrap").prepend(c),null!=a.cookie&&null==a.cookie("first-visit")&&this.loadfirstvisit(),this.rail_is_opened=this.is_rail_open(),this.listenToOnce(this,"active-class-set",function(){return render_taboola_modules()})},run:function(){var b=this;b=this,Time.components.main_modal=new Time.component.Modal(".modal-container",{buttonSelector:'.sign-sub-wrap a[href="#signin"], .subscribe a[href="#signin"], .login-nav-wrapper .sign-in'}),a(this.el).on("click","#Sign_In",function(b){var c;return b.preventDefault(),c=document.URL.split("?"),c=c[0],a("#rurl").val(c+"?loginfailure=true"),a("#turl").val(c),a("#sign-in-form").submit()}),this.init_plugins(),this.capture_arrows(),this.loadChartbeat(),this.getSizes(!0),this.sizeContent(),Time.application.checkScroll(),this.$window.on("scroll",function(){return Time.application.checkScroll("window")}),b.handle_scroll=_.debounce(b.handle_scroll,50),this.$viewport.on("scroll",function(a){return b.handle_scroll(),Time.application.checkScroll(a),a.stopPropagation()}),this.$notHeader.on("scroll",function(a){return Time.application.checkScroll(a),a.stopPropagation()}),this.router=new Time.Router,this.$window.on("resize.application",function(){b.sizeContent(),b.handle_resize(),b.set_left_rail_bounds()}),this.sponsor_index=0,this.sponsor_arr=Time.bootstrap.sponsors?Time.bootstrap.sponsors:null,this.sponsor_length=this.sponsor_arr?this.sponsor_arr.length:0,this.listenTo(Time,"is-beneath-breakpoint-medium",function(){return b.enter_medium()}),this.listenTo(Time,"is-above-breakpoint-medium",function(){return b.enter_medium()}),this.listenTo(Time,"active_rail_set",function(){return b.init_infinite_scroll()}),this.handle_resize(!0),this.$body.on("click",".expand-share",function(a){return a.preventDefault(),b.toggle_share_tooltip(a),!0}),this.$body.on("click",function(c){return a(c.target).hasClass("expand-share")?void 0:b.toggle_share_tooltip("close")}),Modernizr.touch&&this.$viewport.on("blur",".article-shortlink input",function(){setTimeout(function(){var b;b=a(document).scrollTop(),a(document).scrollTop(b+1)},750)})},handle_scroll:function(){var a,b,c,d,e,f,g,h;for(h=this,d=0,b=Time.application.arr_article_views,f=b.length;f>d;)g=b[d],a=g.$el,e=g.model.get("id"),c=Time.application.article_position(a),g.model.get("check_scroll")&&("above"===c||"below"===c?g.model.get("visible")&&(h.hide_images(a),a.addClass("offScreen"),Time.application.$window.trigger("offscreen",g),g.model.set("visible",!1),"above"===c&&(d>0&&"undefined"!=typeof b[d-1]&&b[d-1].model.set("check_scroll",!1),"undefined"!=typeof b[d+1]&&b[d+1].model.set("check_scroll",!0)),"below"===c&&("undefined"!=typeof b[d+1]&&b[d+1].model.set("check_scroll",!1),"undefined"!=typeof b[d-1]&&b[d-1].model.set("check_scroll",!0))):g.model.get("visible")||(h.show_images(a),a.removeClass("offScreen"),Time.application.$window.trigger("onscreen",g),g.model.set("visible",!0),d>0&&b[d-1].model.set("check_scroll",!0),"undefined"!=typeof b[d+1]&&b[d+1].model.set("check_scroll",!0))),g.set_coords(),g.determine_active_state(),d++},article_position:function(b,c){var d,e,f,g;return g=a(window).height(),f=c||1,d="in",e=b.get(0).getBoundingClientRect(),e.bottom<=-(g*f)&&(d="above"),e.top>g+g*f&&(d="below"),d},hide_images:function(b){var c;return c=b.find("img"),c.each(function(){var b;return b=a(this),b.css({height:b.height()}).attr({"old-src":b.attr("src"),src:""})})},show_images:function(b){var c;return c=b.find("img"),c.each(function(){var b;return b=a(this),b.attr({src:b.attr("old-src")}).css({height:""})})},destroy_article:function(a){var b,c;return c=this.active_rail.get(a.data("article")),b=a.height(),c.destroy(),a.remove(),this.$viewportWrapper.scrollTop(this.$viewportWrapper.get(0).scrollTop-b)},toggle_share_tooltip:function(b){var c,d;return"close"===b?a(".expand-share").removeClass("expanded"):(c=a(b.target),d=c.hasClass("expanded"),a(".expand-share").removeClass("expanded"),d?void 0:c.addClass("expanded"))},loadfirstvisit:function(){return a.getScript(Time.home_url+"/wp-content/themes/vip/time2014/js/src/tooltip-first-visit.js")},getSizes:function(a){return a&&(this.sizes.window={},this.sizes.window.width=this.$window.width(),this.sizes.window.height=this.$window.height()),Time.sizes},sizeContent:function(){var a,b;return Time.log("main header : ",this.$main_header),b=this.$main_header.outerHeight(!0),a=this.$window.height()-b,this.admin_bar&&"undefined"!=typeof this.$admin_bar&&(a-=this.$admin_bar.height()),this.mobileSafari&&/iphone/i.test(navigator.userAgent.toLowerCase())?this.$notHeader.height(a+60):this.$notHeader.height(a),this.$viewport.height(a),this.$left_rail.height(a),this.$articleListScroll.css({top:this.$tabs.outerHeight()}),!0},checkScroll:function(a){if(null==a&&(a=!1),"window"===a&&(Time.application.scrollRedraw(Time.application.$articleListScroll.get(0)),this.$notHeader.removeClass("stick")),a===!0&&"boolean"==typeof a&&(this.$viewport.scrollTop(0),this.$notHeader.removeClass("stick")),this.$magazineCover.outerHeight(!0)+this.$pushDown.outerHeight(!0)>0){if(this.skipNextScroll)return this.skipNextScroll=!1,!0;if(this.$notHeader.hasClass("stick")){if((this.is_homepage||this.active_rail.active_article&&0===this.active_rail.active_article.views.tile_view.$el.index())&&this.$viewport.scrollTop()<=0&&(this.$pushDown.height()>0||this.$magazineCover.height()>0)&&(this.$notHeader.removeClass("stick"),"object"==typeof a))return this.skipNextScroll=!0}else if(this.$notHeader.height()+this.$notHeader.get(0).scrollTop>=this.$notHeader.get(0).scrollHeight&&(this.$notHeader.addClass("stick"),"object"==typeof a))return this.skipNextScroll=!0}else if(!this.$notHeader.hasClass("stick"))return this.$notHeader.addClass("stick")},load_ticker:function(){return null==this.ticker||"mobile"===Time.device?this.ticker=new Time.views.TickerModule:this.ticker.render()},redraw:function(b){var c,d;return this.mobileSafari?(b||(b=a("body").get(0)),d=document.createTextNode(" "),c=b.style.display,b.appendChild(d),b.style.display="inline-block",setTimeout(function(){return b.style.display=c,d.parentNode.removeChild(d)},20)):void 0},scrollRedraw:function(b){var c;return"undefined"==typeof b?c=Time.application.$body:(c=a(b),c.css("overflow","hidden").height(),c.css("overflow",""))},is_rail_open:function(){return a(".left-rail").offset().left>=0&&"block"===a(".rail-handle").css("display")},toggle_left_rail:function(){return Time.application.$notHeaderWrapper.hasClass("show-articles-beneath-medium")?Time.application.close_left_rail():(Time.application.open_left_rail(),Time.Ad.activate_left_rail_ads()),!0},open_left_rail:function(){return Time.application.$notHeaderWrapper.addClass("show-articles-beneath-medium"),Time.application.rail_is_opened=!0,Time.application.sizeContent(),omniTrackEv("mobi-expose"),!0},close_left_rail:function(){return Time.application.$notHeaderWrapper.removeClass("show-articles-beneath-medium"),Time.application.rail_is_opened=!1,Time.Ad.update_left_rail_all_el_pos(),omniTrackEv("mobi-close"),!0},init_plugins:function(){this.$notHeader.on("click",".article-permalink",function(){return Time.application.is_rail_open()?Time.application.close_left_rail():void 0}),this.$viewport.on("click",".read-video-article",function(b){var c,d;b.preventDefault(),c=a(b.target),d=c.parent().find(".video-content"),c.toggleClass("show"),c.hasClass("show")?(d.show(),c.text("- HIDE ARTICLE")):(d.hide(),c.text("+ READ ARTICLE"))}),this.$notHeader.find(".rail-handle").on("click",this.toggle_left_rail)},init_degraded_rail_left_rail:function(){return this.$window.on("scroll.degraded-rail",function(){var b,c,d;return c=a(".left-rail-header").outerHeight(),d=Time.util.getHeight(),b=a(document).scrollTop()})},sanitize_url:function(a){var b;return null==a&&(a=""),/^\/[^/]/.test(a)?b=a.substr(1,a.length):-1!==a.indexOf(this.root)&&(b=a.substr(this.root.length,a.length)),b},reset_scroll:function(b){var c=this;return null==b&&(b=1),null!=this.infinite_scroll&&this.infinite_scroll.pause(),_.defer(function(){return Time.application.$viewport.scrollTop(b),window.setTimeout(function(){null!=Time.application.infinite_scroll&&Time.application.infinite_scroll.resume()},500),c.trigger("application:ready"),a(".wpcom-protected-iframe").length&&(window.TIMEContentLoaded=document.createEvent("Event"),window.TIMEContentLoaded.initEvent("DOMContentLoaded",!0,!0),window.document.dispatchEvent(TIMEContentLoaded)),Time.application.checkScroll(),Time.application.sizeContent()})},route:function(b){var c,d,e,f,g;return d=b.currentTarget.href,c=a(b.currentTarget),f=c.is("[data-bypass]"),!f&&this.is_internal(d)&&this.should_route(d)?(e=this.sanitize_url(d),g=!c.is("[data-silent]"),b.preventDefault(),this.router.navigate(e,g)):void 0},should_route:function(a){var b,c;return c=/^\/($|(author\/)|(magazine)|(topic\/)|(([0-9]+)\/)|(tag\/)|(content\-from\/)|(right-now\/)|(popular\/)|(videos\/)|((business|culture|entertainment|health|newsfeed|opinion|politics|science|sports|style|tech|trending|us|world)\/?$))/,b=c.test(this.sanitize_url(a))},is_internal:function(a){var b;return b=a.substr(0,this.root.length)===this.root||-1===a.indexOf("//")},open_popup:function(b){var c,d,e,f,g;return b.preventDefault(),c=b.currentTarget,e=a(c).data("href")||a(c).attr("href"),g=550,d=420,f="scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+g+",height="+d,window.open(e,"Share",f),!1},set_title:function(a){return this.title=this.html_decode(a),document.title=this.title+this.title_suffix},handle_resize:function(a){var b,c,d;brightcove.createExperiences(),c=Time.util.getWidth(),d=[];for(b in this.breakpoints)(!this.breakpoints[b].is_beneath||null!=a&&a)&&c<=this.breakpoints[b].size&&(Time.trigger("is-beneath-breakpoint-"+this.breakpoints[b].name),this.breakpoints[b].is_beneath=!0),(this.breakpoints[b].is_beneath||null!=a&&a)&&c>this.breakpoints[b].size?(Time.trigger("is-above-breakpoint-"+this.breakpoints[b].name),d.push(this.breakpoints[b].is_beneath=!1)):d.push(void 0);return d},capture_arrows:function(){var b=this;return a("body").on("keydown.gallery-arrows",function(a){var c;return null!=b.active_rail&&b.active_rail.active_article&&b.active_rail.active_article.views.single_view.inline_galleries?(c=b.active_rail.active_article.views.single_view.get_active_gallery()||!1,37===a.keyCode&&c.recede(),39===a.keyCode&&c.advance(),a):a})},html_encode:function(a){return document.createElement("a").appendChild(document.createTextNode(a)).parentNode.innerHTML},html_decode:function(a){var b;return b=document.createElement("a"),b.innerHTML=a,b.textContent},loadChartbeat:function(a,b){var c,d;return d=this,c={uid:3088,domain:"www.time.com",pingServer:"ptimeinc.chartbeat.net",sections:"Time.com",domain:"time.com",zone:"Time.com"},yepnope([{test:window.pSUPERFLY,nope:"http://static.chartbeat.com/js/chartbeat_pub.js",complete:function(){return(window.pSUPERFLY?d.title!==b:void 0)?pSUPERFLY.virtualPage(a,b):void 0}}])},enter_medium:function(){return null!=this.$nav_component&&null!=this.$nav_component.data("Navigation")&&(this.$nav_component.data("Navigation").destroy(),this.$nav_component=null),this.$nav_component=Time.component.make("MobileNavigation",".header-nav-button",{menuSelector:".left-rail-header .main-nav",handleClickOutside:!1})},exit_medium:function(){return null!=this.$nav_component&&null!=this.$nav_component.data("MobileNavigation")&&(this.$nav_component.data("MobileNavigation").destroy(),this.$nav_component=null),this.$nav_component=Time.component.make("Navigation",".header-nav-button",{menuSelector:".main-nav",handleClickOutside:!1,scroller:".rail-articles-scroll"})},render_section_header:function(a){var b;return b=Mustache.to_html(Time.templates["top-header"],a),this.$top_banner.html(b),this.active_rail.load_tabs(this.active_rail.sub,".rail-tabs")},render_top_banner:function(a){var b;return b=Mustache.to_html(Time.templates["top-header"],a),this.$top_banner.html(b)},twitter_share_url:function(a,b,c){var d;return d="https://twitter.com/intent/tweet?",null!=a&&(d+="&url="+a),null!=b&&(d+="&text="+b),null!=c&&(d+="&via="+c),d},show_loader:function(a){return a.addClass("loading-overlay"),a},hide_loader:function(a){return a.removeClass("loading-overlay loading-error")},show_loader_error:function(a,b,c){var d,e=this;return null==b&&(b="Sorry, the requested content could not be loaded"),null==c&&(c=3e3),a.attr("data-error",b),a.addClass("loading-error"),c&&(d=window.setTimeout(function(){return e.hide_loader(a)},c)),a},load_tabs:function(a,b){return null==a&&(a=Time.tab_data["default"]),null==b&&(b=!1),null!=this.tabs_view&&this.remove_tabs(),this.tabs_view=new Time.views.Tabs(a,b),this.last_tabs=a,this.init_search()},remove_tabs:function(){return null!=this.tabs_view&&this.tabs_view.destroy(),this.tabs_view=null,a(".rail-tabs").empty()},filter:function(a,b){return a=_.filter(a,function(a){return a.id!==b})},init_search:function(){return this.$search_component&&(this.$search_component=null,delete this.$search_component),this.$search_component=Time.component.make("RailSearch",".main-nav-search-icon",{})},load_rail_env:function(b){var c,d,e,f,g=this;return a("body").removeClass("hidden"),null!=Time.homepage_refresh&&clearInterval(Time.homepage_refresh),this.rail_is_opened=a(".left-rail").offset().left>=0,Time.curRoute=b,this.exit_env(),this.abort_railXHR(),this.destroy_rail(),f={},f=a.extend(!0,{},f,b),f.env=null!=f.env?f.env.toLowerCase():"rail",null!=f.sub&&(f.sub=f.sub.toLowerCase()),null!=f.env&&(e=f.env.charAt(0).toUpperCase()+f.env.slice(1)),c=a("body"),f.env&&(d=a("body").data("env"),c.removeClass(d+"-template")),c.data("env",f.env).addClass(f.env+"-template"),this.active_rail=new Time.collections[e]([],{sub:f.sub}),this.listenToOnce(this.active_rail,"add",function(){return g.init_infinite_scroll(),_.defer(function(){var a;return null!=b.article_id?(a=null!=b.item_slug?b.item_slug:null,g.active_rail.load_single_article(b.article_id,a)):g.active_rail.synchronize()})}),this.active_rail.load_articles(),this.active_template=f.sub,this.active_route=f.env,null==f.open_rail||this.rail_is_opened||this.open_left_rail(),this.active_rail},exit_env:function(){return a("body").removeClass("has-section-menu tax-time_section home")},abort_railXHR:function(){return null!=Time.application.railXHR&&"object"==typeof Time.application.railXHR?(Time.application.railXHR.readyState<4&&Time.application.railXHR.abort(),Time.application.railXHR=null,delete Time.application.railXHR):void 0},destroy_rail:function(){return null==this.active_rail?!1:(_.each(this.active_rail.models,function(a){return null!=a.views.tile_view&&a.views.tile_view.destroy(),null!=a.views.single_view?a.views.single_view.destroy():void 0}),null!=Time.application.infinite_scroll&&(Time.application.infinite_scroll.unbind(),Time.application.infinite_scroll=null),this.active_rail.reset(),this.active_rail.view.annihilate(),this.active_rail=null)},init_infinite_scroll:function(){return this.infinite_scroll=new Time.component.InfiniteScroll(this.$viewport,this.$viewport.find(".wrapper"),400,this.active_rail.show_next_article,this.active_rail.show_previous_article,this.active_rail)},load_article:function(a,b){var c=this;return a=parseInt(a),null!=this.active_rail&&null!=this.active_rail.active_article&&this.active_rail.active_article.unset_active(),null!=this.active_rail&&null!=this.active_rail.get(a)?this.active_rail.synchronize(a):(this.temp_article=new Time.models.Article({id:a}),this.listenToOnce(this.temp_article,"change:title",function(){var d;return null!=c.temp_article.get("topic")?(d=c.temp_article.get("topic").slug,c.load_rail_env({env:"topic",sub:d,article_id:a,item_slug:b})):c.load_rail_env({article_id:a,item_slug:b})}),null!=Time.bootstrap.single_article&&a===Time.bootstrap.single_article.id?this.temp_article.set(Time.bootstrap.single_article):this.temp_article.fetch()),Time.application.active_template="article",Time.application.active_route="article"},toggle_magazine_region_dropdown:function(){return a(".magazine-region-header").toggleClass("open")},set_left_rail_bounds:function(){var b;return b=a(".left-rail-topper"),b.length?(this.left_rail_top=b.height()+this.$top_banner.height(),this.left_rail_bottom=this.$window.height(),this.left_rail_height=this.left_rail_bottom-this.left_rail_top,void 0):!1},autoshow_ie8_modal:function(){var b,c;return a(".lt-ie9").length?(window.localStorage||(window.localStorage={getItem:function(a){return a&&this.hasOwnProperty(a)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},key:function(a){return unescape(document.cookie.replace(/\s*\=(?:.(?!;))*$/,"").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[a])},setItem:function(a,b){return a?(document.cookie=escape(a)+"="+escape(b)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.length=document.cookie.match(/\=/g).length):void 0},length:0,removeItem:function(a){return a&&this.hasOwnProperty(a)?(document.cookie=escape(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.length--):void 0},hasOwnProperty:function(a){return new RegExp("(?:^|;\\s*)"+escape(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},window.localStorage.length=(document.cookie.match(/\=/g)||window.localStorage).length),c=Time.util.getDayOfYear(),b=localStorage.getItem("last_day"),null!=b&&parseInt(b)===parseInt(c)?!1:(a(".ie-message-modal").show(),localStorage.setItem("last_day",c))):!1},hide_ie8_message:function(b){a(b.target).is("a")||a(".ie-message-modal").hide()},toggle_comments:function(b){var c,d,e,f,g;return d=a(b.target),c=d.parents("article").eq(0),c.hasClass("comments-shown")?(this.hide_comments(c),c.removeClass("comments-shown")):(c.addClass("loading-comments"),e=d.data("lf-article-id"),g=d.data("url"),f=d.data("title"),this.show_comments(c,e,g,f))},show_comments:function(a,b,c,d){var e=this;return yepnope([{test:window.fyre,nope:["http://zor.livefyre.com/wjs/v3.0/javascripts/livefyre.js","http://profiles.time.com/media/cHJvZmlsZXMudGltZS5jb20=/javascripts/customprofiles.js"],complete:function(){var f,g,h,i,j;return a.hasClass("comments-rendered")?(a.find(".livefyre-comment").show(),a.addClass("comments-shown")):(a.addClass("comments-rendered"),e.authDelegate=e.authDelegate||new fyre.conv.SPAuthDelegate({engage:{app:"time.auth.fyre.co"}}),i=314099,j=b,g="livefyre-"+j,c=c,d=d,h={collectionMeta:{articleId:j,url:c,title:d},signed:!1,siteId:i,el:g,articleId:j,app:"main",postToButtons:["tw","fb","li"]},f={network:"time.fyre.co",authDelegate:e.authDelegate,string:{follow:"+Follow Conversation"}},fyre.conv.load(f,[h],function(){return a.addClass("comments-shown"),!1})),!1}}]),!1},hide_comments:function(a){return a.find(".livefyre-comment").hide()}}),a(function(){_(Time).extend(Backbone.Events),Modernizr.svg||a('img[src$=".svg"]').each(function(b,c){var d,e,f;return d=a(c),e=a(c).attr("data-fallback"),f=a(c).attr("src"),a(c).attr("src",e||f.replace(".svg",".png"))}),yepnope({test:Modernizr.input.placeholder,nope:["/content/themes/vip/time2014/js/vendor/placeholder.js"]}),Time.application=new Time.views.Application,Time.application.run(),a(".page-template-pagespage-special-story-php").length?Backbone.history.start({pushState:!1,hashChange:!1}):Backbone.history.start({pushState:!0}),a(".error404").length&&(this.page_view=new Time.views.error404),Time.taboola_counter=0,Time.application.autoshow_ie8_modal(),document.addEventListener("touchstart",function(){},!0)}),Time.views.ArticleTile=Backbone.View.extend({template:Time.templates["article-tile"],events:{"click .article-permalink":"video_check"},initialize:function(){var a=this;return this.$container=this.model.collection.view.$el,this.$scroll_container=this.model.collection.view.$scroll_container,this.listenTo(this.model,"activate",function(){return a.$el.addClass("active"),a.model.collection&&a.model.collection.view.jump_to_active_tiles?a.make_visible():void 0}),this.listenTo(this.model,"deactivate",function(){return a.$el.removeClass("active")}),this.listenTo(this.model,"article:tile-rendered",function(){return 5===a.model.collection.real_article_index%10?a.insert_ad_after():void 0}),this.render()},render:function(){return this.$el=this.$container.find("[data-article='"+this.model.id+"']"),this.$el.length||(this.set_template(),this.adjust_data(),this.$el=a(Mustache.to_html(this.template,this.model.attributes)),this.$el.appendTo(this.$container)),this.model.is_active&&this.model.set_active(),this.model.trigger("article:tile-rendered"),this.$el},set_template:function(){return null!=this.model.get("sponsor")&&(this.template=Time.templates["article-tile-sponsored"]),this.template},adjust_data:function(){return this.model.set("articleType",this.set_type_class()),this.model.set("sponsoredClass",this.set_sponsored_class())},set_sponsored_class:function(){},set_type_class:function(){return this.model.attributes.isVideo?"time-icons-video":this.model.attributes.isPhoto?"time-icons-photo":this.model.attributes.isLocked?"time-icons-key":""},make_visible:function(){var a,b,c,d,e;this.$el.position().top<0?(e=this.$el.position().top,c=this.$scroll_container.scrollTop(),b=parseInt(this.$container.css("paddingTop")),this.$scroll_container.scrollTop(e+c-b),this.$container.trigger("rail:scrolled-up")):this.$el.position().top>this.$scroll_container.height()-this.$el.outerHeight()&&(d=this.$el.position().top+this.$el.outerHeight(),c=this.$scroll_container.scrollTop(),a=this.$scroll_container.height(),this.$scroll_container.scrollTop(d+c-a),this.$container.trigger("rail:scrolled-down")),Time.Ad.update_left_rail_all_el_pos()},insert_ad_after:function(){var a;return a=this.create_advert(),a.insertAfter(this.$el),Time.Ad.render_left_rail_ad(a.attr("id")),a},create_advert:function(){var b,c;return this.model.collection.ad_in_left_rail+=1,c=this.model.collection.ad_in_left_rail,b=a("<div/>",{"class":"ad-unit",id:"ad-unit-"+c,pos:c})},video_check:function(){return"video"===this.model.attributes.format?Time.autoplay_video=!0:void 0}}),Time.views.ArticleMagazineTile=Time.views.ArticleTile.extend({template:Time.templates["article-tile-magazine"],initialize:function(){var a=this;return this.$container=this.model.collection.view.$el,this.$scroll_container=this.model.collection.view.$scroll_container,this.listenTo(this.model,"activate",function(){return a.$el.addClass("active"),a.model.collection.view.scroll_freeze||a.make_visible(),a.expand_issue()}),this.listenTo(this.model,"deactivate",function(){return a.$el.removeClass("active")}),this.listenTo(this.model,"article:tile-rendered",function(){return 5===a.model.collection.real_article_index%10&&Time.Ad.get_initial_left_rail_load()?a.insert_ad_after():void 0}),this.listenTo(this.model,"article:tile-rendered",function(){var b;return null!=a.model.get("magazine")?(b=a,a.$el.on("click",".magazine_arrow",function(a){return b.toggle_issue(a)})):void 0}),this.render()},set_template:function(){return this.template=null!=this.model.get("magazine")?Time.templates["article-tile-magazine-cover"]:Time.templates["article-tile-magazine"],this.template},magazine_items:!1,get_items:function(){return this.magazine_items?this.magazine_items:(this.set_items(),this.magazine_items)},set_items:function(){var b;return b=a("[data-issue='"+this.model.get("magazine_id")+"']:not(:first)"),this.magazine_items=b,b},toggle_issue:function(){return this.get_items().toggleClass("collapsed expanded")},expand_issue:function(){return this.get_items().addClass("expanded").removeClass("collapsed")},create_advert:function(){var b,c;return this.model.collection.ad_in_left_rail+=1,c=this.model.collection.ad_in_left_rail,b=a("<div/>",{"class":"ad-unit collapsed",id:"ad-unit-"+c,pos:c}).attr("data-issue",this.model.get("magazine_id"))}}),Time.views.ArticleSingle=Backbone.View.extend({template:Time.templates["article-single"],active_gallery_index:0,visible:!1,right_rail_modules:[],el:"<article></article>",initialize:function(b){var c=this;return null!=b.$el&&(this.$el=b.$el),this.model.set("check_scroll",!0),this.model.set("visisble",!0),this.is_single_on_pageload=null!=Time.bootstrap.single_article&&this.model.get("id")===Time.bootstrap.single_article.id?!0:!1,this.eventsToBeFiredArray=[],this.has_primary_gallery=this.inspect_component_and_add_event("gallery","primary-gallery-rendered"),this.has_galleries=this.inspect_component_and_add_event("galleries","galleries-rendered"),this.has_list_galleries=this.inspect_list_galleries(),this.has_hero_image=this.inspect_component_and_add_event("hero","hero-image-loaded"),this.listenTo(this.model,"activate",function(){return c.$el.addClass("active"),Time.application.trigger("active-class-set"),c.model.get("scripts")?Modernizr.load({load:c.model.get("scripts"),complete:function(){return a(window).trigger("post-load",{el:this.$el})}}):a(window).trigger("post-load",{el:c.$el})}),this.listenTo(this.model,"deactivate",function(){return c.$el.removeClass("active")}),this.load_listener=null,delete this.load_listener,this.eventsToBeFiredArray.length&&(this.load_listener=new FinalFire({subEventArray:this.eventsToBeFiredArray,finalEvent:"internal-components-rendered"})),this.listenToOnce(this.model,"article:rendered",function(){return console.log("article rendered"),console.trace(),Modernizr.touch||null==c.model.get("cover")||c.render_cover_image(),Time.application.$magazineCover.find("img").on("load",function(){return Time.application.checkScroll(!0)}),null!=c.model.get("cover")&&c.setup_cover_caption(),Time.application.trigger("load_section_menu"),a("body").trigger("newImages"),c.create_gallery_collection(),c.bind_events(),c.$el.find(".BrightcoveExperience").length?a("body").hasClass("desktop")?brightcove.createExperiences():setTimeout(function(){brightcove.createExperiences()},3e3):Time.autoplay_video=!1}),this},render:function(b){var c,d,e,f,g,h,i,j,k;return null==b&&(b={}),i=Time.application.$viewportWrapper.find("#article-"+this.model.id),this.$el.html().length||(i.length&&""!==i.html()?this.$el=i:(this.set_template(),this.$el=a(Mustache.to_html(this.template,this.model.attributes,Time.partials)))),null!=b.method&&"append"===b.method?(Time.application.$viewportWrapper.append(this.$el),Time.application.arr_article_views.push(this.model.views.single_view)):null!=b.method&&"prepend"===b.method?(Time.application.$viewportWrapper.prepend(this.$el),Time.application.arr_article_views.push(this.model.views.single_view),Time.application.$viewport.scrollTop(this.$el.outerHeight())):(Time.application.$viewportWrapper.html(this.$el),Time.application.$viewport.scrollTop(1),Time.application.trigger("viewport:reset")),srcset(),yepnope([{test:window.LF,nope:"http://zor.livefyre.com/wjs/v1.0/javascripts/CommentCount.js",complete:function(){return window.LF?LF.CommentCount({replacer:function(b,c){return a(b).removeClass("livefyre-commentcount"),b.innerHTML=c
}}):void 0}}]),"list"===this.model.get("format")&&(this.model.list_ads=[],k=this,d=1,c=this.$el.find(".article-item"),f=c.length,e=this.model.get("id"),c.each(function(b){var c,g;g=parseInt(b,10)+1,0===g%5&&f>g&&(c="list_ad_"+e+"_"+d,a('<li class="list_ad"><div class="list_ad_div" id="'+c+'" pos="'+d+'" ></div></li>').insertAfter(a(this)),k.model.list_ads.push(c),d+=1)})),this.bind_events(),this.render_divider(),this.model.trigger("article:rendered"),this.has_hero_image&&(h=this.$el.find(".portrait img, .landscape img, .bleed img, .wide img"),j=this,g=0,a(j.load_listener).trigger("hero-image-loaded")),this.$el.removeClass("offScreen"),this},set_template:function(){return null!=this.model.get("cover")?(console.log("template - cover"),this.template=Time.templates["article-single-cover"]):"list"===this.model.get("format")?(console.log("template - list"),this.template=Time.templates["article-single-list"]):"gallery"===this.model.get("format")?(console.log("template - gallery"),this.template=Time.templates["article-single-gallery"]):"video"===this.model.get("format")?(console.log("template - video"),this.template=Time.templates["article-single-video"]):"video"===this.model.get("format")?(console.log("template - video"),this.template=Time.templates["article-single-interactive"]):null!=this.model.get("sponsor")&&(console.log("template - sponsored"),this.template=Time.templates["article-single-sponsored"]),this.template},bind_events:function(){},unbind_events:function(){return a(window).off(".article-single-"+this.cid)},inspect_component_and_add_event:function(a,b){return this.is_single_on_pageload?null!=Time.bootstrap.single_article[a]?(this.eventsToBeFiredArray.push(b),!0):!1:this.model.get(a)?(this.eventsToBeFiredArray.push(b),!0):!1},inspect_list_galleries:function(){var a,b,c,d,e;if(this.is_single_on_pageload){if(Time.bootstrap.single_article.format===!1)return!1;c=Time.bootstrap.single_article.list_items}else{if(this.model.get("format")===!1)return!1;c=this.model.get("list_items")}if(null!=c)for(a=d=0,e=c.length;e>d;a=++d)if(b=c[a],null!=b.galleries&&b.galleries.length)return!0;return!1},create_gallery_collection:function(){var b,c,d,e,f,g,h,i=this;for(this.inline_galleries=new Time.collections.ArticleGalleries,this.inline_galleries.article_view=this,this.has_primary_gallery&&(this.inline_galleries.add(this.model.get("gallery")),this.inline_galleries.at(0).set("is_primary",!0)),this.has_galleries&&this.inline_galleries.add(this.model.get("galleries")),this.has_list_galleries&&(d=this.model.get("list_items"),null!=d&&_.each(d,function(a){return null!=a.galleries&&a.galleries.length?_.each(a.galleries,function(a){return i.inline_galleries.add(a)}):void 0})),this.inline_galleries.invoke("set",{has_data:!0}),g=this.inline_galleries.models,h=[],b=e=0,f=g.length;f>e;b=++e)c=g[b],c.get("is_primary")?0===b&&c.get("is_primary")?h.push(this.render_primary_gallery()):h.push(void 0):(c.create_view(!0),h.push(_.defer(function(){return a(i.load_listener).trigger("galleries-rendered")})));return h},render_primary_gallery:function(){var b=this;return this.$(".primary-module-hero").removeClass("bleed primary-module-hero").addClass("gallery-wrapper"),this.inline_galleries.at(0).create_view(!0),_.defer(function(){return a(b.load_listener).trigger("primary-gallery-rendered")})},render_cover_image:function(){var b;return b=a(".magazine-cover").show(),b.html(Mustache.to_html(Time.templates["magazine-cover-image"],this.model.attributes)),Time.application.checkScroll(),srcset(),this.listenTo(Time.application,"application:ready",function(){return this.listenTo(Time.application,"viewport:reset",function(){}),this.listenTo(this,"view:destroy",function(){return b.hide()}),this.listenTo(this.model,"article:rendered",function(){return b.show()})})},setup_cover_caption:function(){var b;return b=a(".cover-image-caption"),b.clone().insertAfter(a(".cover-article-nojs-touch"))},create_divider:function(){return null!=this.divider&&(null!=this.divider.view&&(null!=this.divider.view.$el&&this.divider.view.$el.remove(),this.divider.view=null,delete this.divider.view),this.divider=null,delete this.divider),this.divider=new Time.models.Divider({article:this.model}),this.divider},render_divider:function(){var a,b,c,d;b=this.create_divider(),b.view.render(),c=this.model.get("id"),d=b.get("type"),"advert"===d?b.ad_placeholder_id="ad-below-"+c:"articles"===d&&(a="divider-300x600-"+c,b.view.$el.find(".divider-300x600").eq(0).attr("id",a),b.ad_placeholder_id=a)},set_coords:function(){var a,b,c,d;return c=this.$el.get(0)?this.$el.get(0).getBoundingClientRect():!1,d=c?c.top:0,a=c?c.bottom:0,b=c?c.height:0,this.top_y=d,this.bottom_y=a,{top_y:this.top_y,bottom_y:this.bottom_y}},determine_active_state:function(){var a,b;return a=Time.application.article_breakpoint,this.bottom_y>=a&&this.top_y<a?(b=Time.application.active_rail.active_article,null==b||_.isEqual(b,this.model)||b.unset_active(),this.model.set_active(),this.determine_active_gallery()):void 0},determine_active_gallery:function(){var b,c,d,e,f,g,h,i,j,k;if(!this.model.attributes.galleries||!this.model.is_active)return!1;if(null==this.inline_galleries)return this.active_gallery_index=0;for(j=this.inline_galleries.models,k=[],e=h=0,i=j.length;i>h;e=++h){c=j[e];try{if(d=c.view.$el.position().top,g=a(window).scrollTop(),f=Time.application.$top_banner.height(),d>=g+f){this.active_gallery_index=e;break}k.push(void 0)}catch(l){b=l}}return k},get_active_gallery:function(){return this.inline_galleries.length?this.inline_galleries.at(this.active_gallery_index).view:!1},jump_to_item:function(a){var b,c;return b=this.$("[data-item-slug='"+a+"']"),b.length?(c=b.offset().top,"complete"!==document.readyState?window.onload=function(){return Time.application.reset_scroll(c)}:Time.application.reset_scroll(c),b):!1}}),Time.views.DividerAdvert=Backbone.View.extend({render:function(){return this.$el=a("<div/>").addClass("divider-"+this.model.get("type")).attr("id","ad-below-"+this.model.get("article").get("id")),this.model.trigger("divider:render")}}),Time.views.DividerArticles=Backbone.View.extend({render:function(){return this.$el=a("<div/>").addClass("divider-"+this.model.get("type")),this.$el.html(this.model.get("articles_html")),this.model.trigger("divider:render")}}),Time.views.DividerTaboola=Backbone.View.extend({render:function(){return this.$el=a("<div/>").addClass("divider-"+this.model.get("type")).html(a("<div/>").attr("id","taboola-mid-page-"+Time.taboola_counter).addClass("taboola")),this.model.trigger("divider:render")}}),Time.views.GalleryModule=Backbone.View.extend({initialize:function(){var a=this;this.items=[],this.$items=[],this.$itemContainer={},this.$viewport={},this.$el=this.model.get("$el")||this.model.collection.article_view.$('[data-gallery="'+this.model.id+'"]'),this.is_fullscreen=!1,this.set_template(),this.set_skin(),this.last_index=0,this.listenTo(this,"gallery:recalc",function(){return a.on_recalc()}),this.$el.hasClass("fullscreen")&&(this.is_fullscreen=!0),this.listenTo(this,"gallery:rendered",function(){var b;a.bind_ui(),b=a.model.collection.article_view.model,b&&Time.Ad.call_gallery_trigger(b)})},set_template:function(){return this.template=null!=this.model.get("template_string_ref")?Time.templates[this.model.get("template_string_ref")]:"small"===this.model.get("size")?Time.templates["gallery-module-small"]:""===this.model.get("title")||null!=this.model.collection.article_view&&this.model.get("title")===this.model.collection.article_view.model.get("title")?Time.templates["gallery-module-headless"]:Time.templates["gallery-module"],this.template},set_skin:function(){return"light"===this.model.get("skin")?(this.$el.removeClass("dark"),this.$el.addClass("light")):(this.$el.removeClass("light"),this.$el.addClass("dark"))},bind_events:function(){var b=this;return a(window).on("resize.gallery-"+this.cid,function(){return b.handle_scaling()}),a(window).on("keyup",function(a){return 27===a.which&&b.is_fullscreen?b.exit_fullscreen():void 0})},bind_ui:function(){var a=this;return this.$(".gallery-toggle-fullscreen").off("click").click(function(b){return a.toggle_fullscreen(b)}),this.$(".next").off("click").click(function(b){return a.advance(b)}),this.$(".prev").off("click").click(function(b){return a.recede(b)}),this.$(".gallery-restart").off("click").click(function(b){return a.handle_beginning(b)})},render:function(){var b=this;return this.$el.html(a(Mustache.to_html(this.template,this.model.attributes,Time.partials))),this.$itemContainer=this.$(".gallery-slides"),_.defer(function(){return b.create_slides()}),this.trigger("gallery:rendered")},create_slides:function(){var a,b,c,d,e;null!=this.items&&this.items.length&&(this.items.length=0),this.items=new Time.collections.GallerySlides,this.items.master_view=this,d={},e=this.model.get("photos");for(a in e)b=e[a],d=new Time.models.GallerySlide(b),this.items.add(d),d=d.view.$el,this.$items[a]=d,d.appendTo(this.$itemContainer);return null!=this.model.get("galleries")&&this.model.get("galleries").length&&(c=new Time.models.GallerySlide({view:"related",gallery_view:this}),this.items.add(c),this.$items.push(c.view.$el),c.view.$el.appendTo(this.$itemContainer)),this.init_gallery()},init_gallery:function(){var b,c,d;if(this.model.get("fullscreen")||this.exit_fullscreen(),this.$viewport=this.$(".gallery-viewport"),this.$counter_current=this.$(".current-slide"),this.$counter_total=this.$(".total-slides"),this.$buttons=this.$('> [class*="gallery"] > .gallery-buttons, .gallery-header .gallery-buttons'),this.$header=this.$(".gallery-header").length?this.$(".gallery-header"):this.$(".gallery-portrait-title"),this.$footer=this.$(".gallery-footer").length?this.$(".gallery-footer"):this.$(".gallery-portrait-panel"),this.is_portrait=this.$('article[class*="gallery-"]').is(".gallery-portrait"),this.bind_events(),Time.initial_gallery_slug){d=this.model.get("photos");for(b in d)if(c=d[b],c.slug===Time.initial_gallery_slug){this.init(parseInt(b,10));break}}else this.init();this.setCounterTotal(this.total_slides),a("body").trigger("newImages")},toggle_fullscreen:function(){var a=this;return this.is_fullscreen?this.exit_fullscreen():this.enter_fullscreen(),_.defer(function(){return a.handle_scaling(a.getCurrentIndex())})},enter_fullscreen:function(){return this.$el.addClass("fullscreen"),a("html").css("overflow","hidden"),a("html").addClass("fullscreenmode"),this.is_fullscreen=!0,this.handle_scaling()},exit_fullscreen:function(){this.$el.removeClass("fullscreen"),a("html").removeProp("style"),a("html").removeClass("fullscreenmode"),this.is_fullscreen=!1,this.$el.trigger("gallery:exit_fullscreen"),this.handle_scaling()},handle_scaling:function(a){var b;return b=this.$items[a]||this.getCurrentItem(),null==b?!1:void 0},scale_image:function(a){return!1},position_viewport:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(d=Time.application.breakpoints.medium.is_beneath,this.is_fullscreen&&!this.is_portrait||this.is_fullscreen&&this.is_portrait&&d){for(n=Time.util.getHeight(),m=.02*n,i=2*m+(this.$header.height()||0),h=n-this.$footer.position().top+m,c=.96*Time.util.getWidth()/(.96*n),e=n-i-h,g=.96*Time.util.getWidth(),f=g/e,q=this.$items,r=[],j=o=0,p=q.length;p>o;j=++o)l=q[j],b=l.hasClass("gallery-viewport")?l:l.find(".gallery-viewport"),k=b.hasClass("related-galleries"),b.css({top:i,bottom:h}),k?(a=b.hasClass(".gallery-related-wrap")?b:b.find(".gallery-related-wrap"),1.5>f?r.push(a.removeProp("style")):r.push(a.css({width:3*e/2}))):r.push(void 0);return r}return this.$itemContainer.find("[style]").removeProp("style")},on_recalc:function(){var a,b,c,d,e=this;_.defer(function(){return e.handle_scaling()}),d=this.getCurrentIndex(),c=this.items.models&&this.items.models[d]?this.items.models[d].attributes:{},this.setCounterCurrent(),0!==d||this.model.attributes.previous_gallery_id?this.$el.removeClass("disable-prev"):this.$el.addClass("disable-prev"),d!==this.items.length-1||this.model.attributes.next_gallery_id?this.$el.removeClass("disable-next"):this.$el.addClass("disable-next"),a=""!==c.caption?c.caption:"",b=null!=c.credit&&""!==c.credit?" ("+c.credit+")":"",this.$(".gallery-meta-caption").html(a||""),this.$(".gallery-meta-author").html(b||""),this.$(".current").hasClass("related-galleries")?this.$el.addClass("show-restart"):this.$el.removeClass("show-restart"),c.fullscreen=this.is_fullscreen,c.primary=this.$el.hasClass("primary-gallery"),c.gallery_title=this.model.get("title"),c.twitter_text=this.model.get("twitter_text"),c.twitter_via=this.model.get("twitter_via"),null!=this.model.get("hero")&&(c.hero=this.model.get("hero")),this.$el.hasClass("show-restart")||this.last_index===d||(Time.Tracking.gallery_view(c),this.is_fullscreen||Time.Ad.reload_left_rail_ads(),this.previous_index=d),this.$el.hasClass("show-restart")?(this.last_index=0,c.encoded_shortlink=this.model.get("encoded_shortlink")):this.last_index=d,this.update_share_tools(c)},update_share_tools:function(a){var b,c,d;return c=encodeURIComponent(a.url),b=encodeURIComponent(a.title),d="http://facebook.com/sharer.php?s=100&p[title]="+b+"&p[url]="+c,null!=a.hero&&(d+="&p[images][0]="+encodeURIComponent(a.hero.thumbnail)),this.$(".time-icons-mail").attr("href","mailto:?subject="+b+"&body="+c),this.$(".time-icons-tw").data("href","https://twitter.com/intent/tweet?url="+a.encoded_shortlink+"&text="+a.twitter_text+"&via="+a.twitter_via),this.$(".time-icons-gplus").attr("href","https://plus.google.com/share?url="+c),this.$(".time-icons-reddit").attr("href","http://reddit.com/submit?url="+c+"&title="+b),this.$(".time-icons-fb").attr("href",d)},destroy:function(){return this.items.length=0,this.$items.length=0,this.undelegateEvents(),this.$el.removeData().unbind(),a(window).off(".gallery-"+this.cid)}}),_.extend(Time.views.GalleryModule.prototype,Time.component.Gallery.prototype,Backbone.Events),Time.views.GalleryRelated=Backbone.View.extend({template:Time.templates["gallery-related"],events:{"click .gallery-related-link":"load_related"},initialize:function(){return this.render()},render:function(){var b;return b=this.model.gallery_view.model.get("galleries"),this.$el=a(Mustache.to_html(this.template,{galleries:b})),this.$el},destroy:function(){return Time.log("Slide destroyed"),this.undelegateEvents(),this.$el.removeData().unbind(),this.remove(),Backbone.View.prototype.remove.call(this)},load_related:function(b){var c,d,e;return Time.initial_gallery_slug=!1,b.preventDefault(),c=a(b.currentTarget),e=this.model.gallery_view.model.get("id"),d=c.data("gallery-ref"),this.model.gallery_view.model.collection.article_view.$('[data-gallery="'+d+'"]').length||this.model.gallery_view.model.collection.replace_gallery(e,d,!1,this.model.gallery_view.is_fullscreen),!1}}),Time.views.GallerySlide=Backbone.View.extend({template:Time.templates["gallery-slide"],events:{click:"trigger_advance"},initialize:function(){return this.render()},render:function(){return this.$el=a(Mustache.to_html(this.template,this.model.attributes))},trigger_advance:function(){return this.model.collection.master_view.advance()},destroy:function(){return Time.log("Slide destroyed"),this.undelegateEvents(),this.$el.removeData().unbind(),this.remove(),Backbone.View.prototype.remove.call(this)}}),Time.views.error404=Backbone.View.extend({initialize:function(){return this.rail_view=new Time.views.Rail,Time.Ad.set_initial_app_load(!1),Time.application.load_tabs(Time.tab_data["default"]),Time.application.tabs_view.set_active(0),this.listenToOnce(Time.application,"application:ready",function(){return a(".site-footer").remove(),a("body").removeClass("error404")}),Time.application.router.is_initial_route=!1}}),Time.views.Homepage=Backbone.View.extend({el:".home",events:{"click a[data-video]":"render_homepage_video","click a[data-gallery]":"render_homepage_gallery","click .rail-article-title a":"mobile_click_event","click .format-video a":"set_BC_video_autoplay","click .read-more-divider-hero img":"trigger_promo_click"},homepage_galleries:[],initialize:function(){return Time.application.rail_is_opened=a(".left-rail").offset().left>=0,Time.application.is_homepage=!0,this.rail_view=new Time.views.Rail,this.render_ads(),Time.application.set_left_rail_bounds(),this.render_slideshow(),Time.Ad.set_initial_app_load(!1),Time.application.load_tabs(Time.tab_data["default"]),Time.application.tabs_view.set_active(0),Time.application.active_route="home",this.listenToOnce(Time.application,"application:ready",function(){a("body").removeClass("home"),Time.application.is_homepage=!1,a(".site-footer").remove()}),this.render_market_data(),Time.homepage_refresh=setInterval(function(){return Time.application.is_homepage?window.location=Time.home_url:void 0},48e4)},img_html_to_gallery_slide:function(b){var c,d;return null==b&&(b=this.$(".home-brief-hero")),c=b.find("img").clone(),d=a(document.createElement("div").className="gallery-viewport").append(c),a(document.createElement("div").className="gallery-slide").append(d)},render_homepage_video:function(b){var c,d,e;return d=a(b.target).closest("[data-video]"),e=d.data("video"),c=d.addClass("home-video-wrapper").html(e),c.siblings(".image-caption").css("visibility","hidden"),c.find(".BrightcoveExperience").length&&brightcove.createExperiences(),!1},render_homepage_gallery:function(b){var c,d,e;return b.stopImmediatePropagation(),b.preventDefault(),c=a(b.target).closest("[data-gallery]"),d=c.attr("data-gallery"),this.inline_galleries=new Time.collections.ArticleGalleries,e=this.inline_galleries.push(new Time.models.GalleryModule({id:parseInt(d),$el:c,template_string_ref:"gallery-module-home"})),this.listenToOnce(e,"sync:success",function(){return e.create_view(!0)}),e.fetch(),!1},render_market_data:function(){return null==Time.bootstrap.market_data||_.isEmpty(Time.bootstrap.market_data)?!1:null!=Time.bootstrap.market_data.error&&Time.bootstrap.market_data.error.length?!1:(_.each(Time.bootstrap.market_data.markets,function(a){return a.last=a.last.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),a.change=a.change.toFixed(2),a.percent=a.percent.toFixed(2),a.change_class=a.change<0?"market-decrease":"market-increase",a.percent_class=a.percent<0?"market-decrease":"market-increase"}),a(".market-wrap").html(Mustache.to_html(Time.templates["market-data"],{markets:Time.bootstrap.market_data.markets,msg:Time.bootstrap.market_data.msg})))},render_ads:function(){var b,c,d,e,f,g,h,i,j;for(g=this.rail_view.$scroll_container.find(".rail-article"),j=g.length,c=1,f={},h=0,e=[];j>h;)i=h+1,0===i%5&&(b=a(g[h]),0===i%10&&Time.application.sponsor_length?(a(Mustache.to_html(Time.templates["article-tile-sponsored"],Time.application.sponsor_arr[Time.application.sponsor_index])).insertAfter(b),Time.application.sponsor_index++,Time.application.sponsor_index=Time.application.sponsor_index+1>Time.application.sponsor_length?0:Time.application.sponsor_index):5===i&&(d="ad-unit-"+c,a("<div/>",{"class":"ad-unit",id:d}).insertBefore(b),f=function(a,b){return{active_rail:b,pos:c}}(d,this.rail_view),Time.Ad.render_homepage_left_rail_ad(d,f),e.push(d),c+=1)),h+=1;Time.Ad.activate_homepage_ads()},render_slideshow:function(){var a,b,c,d,e,f;if(f=Time.bootstrap.homepage?Time.bootstrap.homepage.slideshows:!1,this.slideshows=[],c={},a=0,f){for(b in f)e=f[b],d="slideshow-"+b,c={cycle:"1"===e.loop?!0:!1,isAutoPlay:"1"===e.autoplay?!0:!1,experience:Time.device},this.slideshows[a]=new Time.Slideshow(e.slides,d,c),this.slideshows[a].init();a+=1}},mobile_click_event:function(){"mobile"===Time.device&&(Time.application.$left_rail.removeClass("show-articles-beneath-medium"),Time.application.rail_is_opened=!1)},set_BC_video_autoplay:function(b){window.BCL=window.BCL||{},window.BCL.playArticleVideoId=a(b.target).parents(".rail-article").data("article")},trigger_promo_click:function(b){return a(b.target).closest(".read-more-divider-hero").find(".related-article").trigger("click")}}),Time.views.Special=Time.views.ArticleSingle.extend({el:".page-template-pagespage-special-story-php",$win:a(window),$viewport:a(".article-viewport"),$before_viewport:a(".before-viewport"),$special_story:a(".special-story"),$nav:a(".article-navigation"),$sticky:a(".sticky"),$chapters:a(".chapters"),$open_chapters:a(".open-chapters"),$full_browser:a(".full-browser"),$time_video:a("#time_video"),header_height:a(".main-header").height(),banner_height:a(".top-banner").height(),sticky_height:a(".sticky").height(),events:{"click .chapters ul a":"scroll_to_chapter"},initialize:function(){var b,c,d,e=this;if(Time.application.rail_is_opened=!1,Time.Ad.set_initial_left_rail_load(!1),Time.application.arr_article_views.length=0,this.$viewport.on("scroll",function(){e.handle_scroll()}),this.$open_chapters.on("click",function(){e.$chapters.toggleClass("active")}),a(".chapters ul a").on("click",function(){return e.$chapters.removeClass("active")}),Modernizr.touch&&(this.$el.addClass("wipe-enabled"),this.$el.touchwipe({wipeUp:function(){return e.hide_chapter_selector()},wipeDown:function(){return e.show_chapter_selector()},min_move_x:6,min_move_y:6,preventDefaultEvents:!1}),this.$nav.appendTo(this.$before_viewport)),""!==window.location.hash&&this.$sticky.addClass("fixed"),this.render_galleries(),this.$win.on("resize",function(){e.resize_interactives()}),this.resize_interactives(),this.$full_browser.length>0)if(this.$win.on("resize",function(){e.resize_video()}),this.resize_video(),d=document.getElementById("time_video"),a(".cue").on("click",function(){return e.$viewport.scrollTo(e.$viewport.height(),400)}),null!=d){if(!document.createElement("video").canPlayType)return;this.$time_video.on("play",function(){return a(".full-browser").animate({opacity:1},2e3)})}else b=a(".bg-cover"),c=b.find("img"),b.css({"background-image":"url("+c.attr("src")+")"}),c.remove(),a(".full-browser").animate({opacity:1},2e3);Time.Ad.activate_special_article_ads(this.$special_story.data("article")),yepnope([{test:window.LF,nope:"http://zor.livefyre.com/wjs/v1.0/javascripts/CommentCount.js",complete:function(){return window.LF?LF.CommentCount({replacer:function(b,c){return a(b).removeClass("livefyre-commentcount"),b.innerHTML=c}}):void 0}}])},resize_video:function(){return this.$full_browser.css({height:this.$viewport.height()})},handle_scroll:function(){var a,b;return a=this.$nav.offset().top,b=this.banner_height,Time.application.admin_bar&&(b+=Time.application.$admin_bar.height()),0>a-b?this.$sticky.addClass("fixed"):this.$sticky.removeClass("fixed")},show_chapter_selector:function(){return this.$sticky.addClass("open"),this.$chapters.removeClass("active")},hide_chapter_selector:function(){return this.$sticky.removeClass("open"),this.$chapters.removeClass("active")},render_galleries:function(){var b,c=this;return this.inline_galleries=new Time.collections.ArticleGalleries,this.inline_galleries.article_view=this,b=a("div[data-gallery]"),null!=b?_.each(b,function(b){var d,e,f;return d=a(b),e=d.attr("data-gallery"),f=c.inline_galleries.push(new Time.models.GalleryModule({id:parseInt(e),$el:d,template_string_ref:"gallery-module"})),c.listenToOnce(f,"sync:success",function(){return f.create_view(!0)}),f.fetch(),!1}):void 0},resize_interactives:function(){var b,c=this;return b=a(".wpcom-protected-iframe"),null!=b?_.each(b,function(b){var d;return d=a(b),d.hasClass("time-relative-iframe")?d.height(c.$viewport.height()/2):void 0}):void 0},scroll_to_chapter:function(b){var c;return b.preventDefault(),c=this.$sticky.hasClass("fixed")?0:-this.sticky_height,this.$viewport.scrollTo('a[name="'+a(b.target).attr("href").replace("#","")+'"]',400,{offset:c})}}),Time.views.Poll=Backbone.View.extend({template:Time.templates["poll-module"],events:{"click .user-poll-button-primary":"fetch_results","click .user-poll-button-secondary":"fetch_results"},initialize:function(){return this.render()},render:function(){return this.$el=a(Mustache.to_html(this.template,this.model.attributes))},fetch_results:function(){return this.model.fetch_results(),!1},display_results:function(){return this.results||(this.results=new Time.models.PollResult({model:this.model.attributes.results})),this.$el.append(this.results.view.$el).addClass("show-results")}}),Time.views.PollResult=Backbone.View.extend({template:Time.templates["poll-results"],events:{"click .return-to-poll":"show_options"},initialize:function(){return this.render(),this.animate_graphs()},render:function(){return this.$el=a(Mustache.to_html(this.template,this.model.attributes.model))},animate_graphs:function(){var b=this;return setTimeout(function(){var c;return c=b.$(".user-poll-graph-filled"),c.each(function(c,d){return a(d).css({width:b.model.attributes.model.options[c].percentage+"%"})})},500)},show_options:function(){return this.$el.closest(a(".show-results")).removeClass("show-results"),!1}}),Time.views.Rail=Backbone.View.extend({className:"article-list",events:{mouseenter:"freeze_scroll",mouseleave:"release_scroll",mouseleave:"set_ads_in_view_port","click .rail-article-title a":"article_tile_click_event","click .format-video a":"set_BC_video_autoplay"},jump_to_active_tiles:!0,initialize:function(){var b,c=this;return this.$scroll_container=a(".rail-articles-scroll"),this.$magazine_nav=a(".magazine-region-header"),this.ads_in_viewport=[],null!=this.collection&&(null!=this.collection.active_env&&(b=this.$scroll_container.data("env"),null!=b&&this.$scroll_container.removeClass(b),this.$scroll_container.data("env",this.collection.active_env),this.$scroll_container.addClass(this.collection.active_env)),this.empty(),this.listenTo(Time.application,"application:ready",function(){return c.fill_viewport(),Time.application.hide_loader(Time.application.$viewportWrapper)}),this.listenTo(this.collection,"sync:syncing",function(){return c.show_loader(),c.collection.models.length?void 0:Time.application.show_loader(Time.application.$viewportWrapper)}),this.listenTo(this.collection,"sync",function(){return c.hide_loader()}),this.listenTo(this.collection,"sync:error",function(){return c.hide_loader(),c.show_loader_error(),Time.application.hide_loader(Time.application.$viewportWrapper)}),this.listenToOnce(this.collection,"add reset",function(){return c.infinite_scroll=new Time.component.InfiniteScroll(c.$scroll_container,c.$el,20,c.collection.fetch_next_page,null,c.collection),Time.application.$viewport.addClass("loading"),c.set_ads_in_view_port()}),this.render()),this.jump_to_active_tiles&&(a(".left-rail-header .main-nav").on("shown",function(){return c.jump_to_active_tiles=!1}),a(".left-rail-header .main-nav").on("hidden",function(){return c.jump_to_active_tiles=!0})),this},render:function(){a(".article-list").length&&a(".article-list").remove(),this.$el.prependTo(".rail-articles-scroll"),Time.application.$articleList=this.$el,Time.application.load_tabs(Time.tab_data["default"]),Time.application.tabs_view.set_active(0),Time.application.set_left_rail_bounds(),null!=this.collection.active_env&&("magazine"===this.collection.active_env?this.$el.parents("#rail-articles").addClass("magazine_rail"):this.$el.parents("#rail-articles").removeClass("magazine_rail")),Time.application.checkScroll(!0)},fill_viewport:function(){Time.application.$articleListScroll.get(0).scrollHeight<=Time.application.$window.height()-Time.application.$main_header.height()&&this.collection.fetch_next_page()},destroy_perfect_scroll:function(){return this.$scroll_container.perfectScrollbar("destroy")},empty:function(){return this.$el.html(""),this.trigger("empty")},scroll_limit_message:function(){return Time.application.$viewport.removeClass("loading"),"magazine"===Time.curRoute.env?a("<a></a>").addClass("meta response-eot").attr("href","http://content.time.com/time/magazine/").html("Read more articles in the "+Time.curRoute.env+" archive").appendTo(this.$el):a("<a></a>").addClass("meta response-eot").attr("href","/").html("Get the latest news on TIME's home page").appendTo(this.$el)},show_loader:function(){return this.$scroll_container.addClass("fetching")},hide_loader:function(){return this.$scroll_container.removeClass("fetching")},show_loader_error:function(){var b,c,d=this;return b=a("<p></p>").addClass("meta response-error").html("The requested content could not be loaded.").appendTo(this.$el),c=a("<a></a>").addClass("manual-fetch").html("Try now").attr("href","javascript:void(0)").one("click",function(){return d.collection.fetch()}).appendTo(b),this.listenToOnce(this.collection,"sync:syncing",this.remove_loader_error)},remove_loader_error:function(){return a(".response-error").remove()},set_ads_in_view_port:function(){var b,c;c=Time.Ad.can_left_rail_ad_expand()?Time.Ad.$ad_left_rail_placeholders:Time.Ad.$left_rail_ad_el_divs,b=a.isEmptyObject(c)?a(".ad-unit"):c,this.ads_in_viewport=this.els_in_viewport(b,!0)},freeze_scroll:function(){return this.scroll_freeze=!0},release_scroll:function(){return this.scroll_freeze=!1},article_tile_click_event:function(){Time.application.arr_article_views.length=0,"mobile"===Time.device&&(Time.application.$left_rail.removeClass("show-articles-beneath-medium"),Time.application.rail_is_opened=!1)},in_viewport:function(a,b){var c,d,e,f,g,h;return Time.application.rail_is_opened?a.length<=0?!1:(e=a.get(0)?a.get(0).getBoundingClientRect():!1,f=e?e.top:0,c=e?e.bottom:0,d=e?e.height:0,h=Time.application.left_rail_top,g=Time.application.left_rail_bottom,b?h>f&&c>h||f>=h&&g>=f:f>=h&&g>=c):!1},els_in_viewport:function(b,c){var d,e;return d=[],a.isEmptyObject(b)?d:(e=this,a.each(b,function(){var b;b=this instanceof a?this:a(this),e.in_viewport(b,c)&&d.push(b)}),d)},render_author_header:function(b){var c,d;return null==b&&(b={}),d=Time.templates["rail-header-author"],c=a(Mustache.to_html(d,b)),c.prependTo(this.$el)},render_topic_header:function(b){var c,d;return null==b&&(b={}),d=Time.templates["rail-header-topic"],c=a(Mustache.to_html(d,b)),c.prependTo(this.$el)},render_header:function(b,c){var d;return null==b&&(b="Most Read"),null==c&&(c=0),d=a("<h3/>",{"class":"rail-list-heading"}).text(b),null!=this.models&&this.models[c]?d.insertBefore(this.collection.models[c].views.tile_view.$el):d.appendTo(this.$el)},set_BC_video_autoplay:function(b){window.BCL=window.BCL||{},window.BCL.playArticleVideoId=a(b.target).parents(".rail-article").data("article")},annihilate:function(){this.infinite_scroll.unbind(),this.destroy()}}),Time.views.Tabs=Backbone.View.extend({el:".rail-tabs",template:Time.templates["rail-tabs"],events:{click:"load_rail"},initialize:function(b,c){return null!=c&&c&&!Time.application.breakpoints.medium.is_beneath&&(this.el=c,this.$el=a(this.el)),this.render(b),this},render:function(b){return a(Mustache.to_html(this.template,b)).appendTo(this.$el)},load_rail:function(b){var c,d,e,f;return c=a(b.target),c.is(".rail-tab")?c.hasClass("active")?!1:(e=this.$el.index(c),d=c.attr("id"),f=c.attr("data-sub"),this.set_active(d||0),"videos"===d&&(Time.autoplay_video=!0),"popular"!==d&&"videos"!==d&&(Time.application.load_rail_env({only_visible:!0,env:d,sub:f,sync_first_article:!0}),null!=c.data("event"))?omniTrackEv(c.data("event")):void 0):b},set_active:function(a){return this.$(".rail-tab").removeClass("active"),"number"==typeof a?this.$(".rail-tab").eq(0).addClass("active"):this.$(".rail-tab#"+a).addClass("active")},destroy:function(){return Time.log("Tabs destroyed"),this.undelegateEvents(),this.$el.removeData().unbind().empty()}}),Time.views.TickerHeadline=Backbone.View.extend({template:Time.templates["ticker-headline"],events:{"click .ticker-tweet":"Time.application.open_popup"},initialize:function(){return this.render()},render:function(){return this.$el=a(Mustache.to_html(this.template,this.model.attributes)),this.bind_events(),this.$el},bind_events:function(){return this.$el.on("isCurrent",a.proxy(this.updateTweeterButton,this))},updateTweeterButton:function(){var b;return b=Time.application.twitter_share_url(this.model.get("encoded_shortlink"),this.model.get("twitter_text"),this.model.get("twitter_via")),a(".ticker-tweet").attr("href",b)}}),Time.views.TickerModule=Backbone.View.extend({template:Time.templates["ticker-module"],el:".top-banner",$el:a(this.el),items:[],$items:[],$itemContainer:{},circular:!0,height:66,events:{"click .next":"advance","click .prev":"recede"},initialize:function(){var a=this;
return this.listenTo(this,"gallery:recalc",function(){return a.on_recalc()}),this.$tweet_btn=this.$(".ticker-tweet"),this.items=new Time.collections.Ticker,this.listenTo(this.items,"reset",function(){return a.render()}),this.items.load_headlines(),this},render:function(){return this.html=Mustache.to_html(this.template,{}),this.$el.html(a(this.html)),this.$itemContainer=this.$(".headlines"),this.$items=this.items.get_$items(),this.$itemContainer.html(this.$items),this.$items.length>0?(this.init_gallery(),this.handle_scaling()):void 0},enter_large:function(){return this.handle_scaling()},exit_large:function(){return this.handle_scaling()},init_gallery:function(a){return this.$items=this.items.get_$items(),this.init(a?a:0),this.auto_play(5e3)},handle_scaling:function(){},on_recalc:function(){var a;return a=this.items.models[this.getCurrentIndex()].attributes,this.$tweet_btn.data("href","https://twitter.com/intent/tweet?url="+encodeURIComponent(a.twitter_shortlink)+"&text="+a.twitter_text+"&via="+a.twitter_via),this.auto_play(5e3)}}),_.extend(Time.views.TickerModule.prototype,Time.component.Gallery.prototype,Backbone.Events),Time.Router=Backbone.Router.extend({is_initial_route:!0,routes:{"(/)":"home","right-now/":"right_now","author/:author/":"author","magazine/(:region/)(:magazine_id/)(:magazine_slug/)":"magazine","tag/:tag/":"tag","topic/:topic/":"topic","popular/":"popular","videos/":"videos","content-from/:sponsor/(:article_id/)(:article_slug/)":"sponsored","time_homepage/:homepage/":"home",":special/":"special"},initialize:function(){var a=this;return this.popped=!1,Time.author=!1,Time.curRoute={env:"",sub:""},this.listenToOnce(this,"route",function(){return a.is_initial_route=!1}),this.route(/^([0-9]+)\/([a-z0-9-]+)?(\/(item|photo)\/([a-z0-9-_]+))?(\/)?/,"article"),this.route(/^(privacy-policy)\/?$/,""),this.route(/^(business|culture|living|entertainment|health|newsfeed|opinion|politics|science|sports|style|tech|us|world)\/?$/,"section")},home:function(){var a,b,c,d,e,f;return b=/post_type=time_magazine&p=([0-9]+)&preview=true/,a=b.exec(window.location.href),null!=a&&null!=a[1]?(this.magazine(null,a[1],null),void 0):(f=/p=([0-9]+)&preview=true/,e=f.exec(window.location.href),null!=e&&null!=e[1]?(this.article(e[1]),void 0):(d=/page_id=([0-9]+)&preview=true/,c=d.exec(window.location.href),null!=c&&null!=c[1]?(this.special(),void 0):this.is_initial_route?Time.application.page_view=new Time.views.Homepage:window.location.reload()))},right_now:function(){return Time.application.load_rail_env()},article:function(a,b,c,d,e){return Time.application.load_article(a,e)},section:function(a){return Time.application.load_rail_env({env:"section",sub:a,open_rail:!0})},author:function(a){return Time.author=!0,Time.application.load_rail_env({env:"author",sub:a,open_rail:!0})},topic:function(a){return Time.application.load_rail_env({env:"topic",sub:a,open_rail:!0})},tag:function(a){return Time.application.load_rail_env({env:"tag",sub:a,open_rail:!0})},magazine:function(a,b){return null!=b?Time.application.load_rail_env({env:"magazine",sub:a,magazine_id:b}):Time.application.load_rail_env({env:"magazine",sub:a})},popular:function(){return Time.application.load_rail_env({env:"popular"})},videos:function(){return Time.application.load_rail_env({env:"videos"})},sponsored:function(a,b){return null!=b?Time.application.load_article(b):Time.application.load_rail_env({env:"sponsor",sub:a})},special:function(){return Time.application.page_view=new Time.views.Special}})}(jQuery);;
